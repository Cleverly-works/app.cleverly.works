"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5175],{92264:function(e,t,n){n.d(t,{H:function(){return c}});var r=n(59499),o=n(55377),i=n(16551),a=n(77439),s=n(85893);function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var c=function(e){var t=e.children,n=e.content,c=e.context,l=e.data,d=e.disabled,p=e.handleClick,m=e.size,y=e.type;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o.Z,{size:"sm"}),(0,s.jsxs)(i.Z,{align:"flex-end",children:[t,(0,s.jsx)(a.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({content:n,context:c,disabled:d,onClick:p,size:m,type:y},l))]})]})};c.defaultProps={content:"Add",context:"secondary",disabled:!1,size:"sm",type:"button"}},75420:function(e,t,n){n.d(t,{r:function(){return i}});var r=n(95103),o=n(85893),i=function(e){var t=e.errors,n=e.name,i=e.onChange,a=e.options,s=e.register;return(0,o.jsx)(r.Z,{errors:t,name:n,onChange:i,options:a,register:s})};i.defaultProps={name:"status"}},67872:function(e,t,n){n.d(t,{t:function(){return u}});var r=n(67294),o=n(11163),i=n(87043),a=n(16540),s=n(85893),u=(0,r.forwardRef)(function(e,t){var n=e.columns,u=e.history,c=e.initialSort,l=e.loading,d=e.meta,p=e.paginationSize,m=e.refetch,y=e.rowClick,f=e.rows,b=e.xeroPageSize,v=(0,o.useRouter)(),g=v.query,h=void 0===g?{}:g,j=(0,r.useState)(parseInt(null==h?void 0:h.page,10)||1),O=j[0],x=j[1],S=(0,r.useState)(b||i.C1.paginationSize),P=S[0],w=S[1];c||(c={item:"createdAt",order:"desc"});var Z=(0,r.useState)({item:c.item,order:c.order}),_=Z[0],I=Z[1],q=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=v.query,n=void 0===t?{}:t;if(e>1?n.page=e:delete n.page,!(Object.keys(n).length>0))return{};var r=Object.keys(n).map(function(t){return"page"===t?"".concat(t,"=").concat(e):"".concat(t,"=").concat(n[t])}).join("&");return"?".concat(r)},T=function(){I({item:c.item,order:c.order}),x(1);var e=q();v.push(e),w(b||i.C1.paginationSize)};(0,r.useImperativeHandle)(t,function(){return{currentPage:O,pageSize:P,sort:_,resetPagination:function(){T()}}});var $=function(e){var t=q(e);u&&v.push(t),x(e),!u&&m&&m()},k=function(e){e!==i.C1.paginationSize&&(w(e),m&&m())},C=function(e){var t;I({item:e.item,order:e.order}),m&&m()};return(0,s.jsx)(a.Z,{columns:n,loading:l,paginationSize:p,pagination:d&&!0,paginationProps:d&&{currentPage:O,onPageChange:$,onPageSizeChange:k,pageCount:Math.ceil(d.aggregate.totalCount/P),perPage:P},rowClick:y,rows:f,sort:_,setSort:C})});u.defaultProps={history:!0,loading:!0,paginationSize:!1}},42846:function(e,t,n){n.d(t,{x:function(){return l}});var r=n(59499),o=n(67294),i=n(96486),a=n(87043),s=function(e){try{return JSON.parse(e)}catch(t){return!1}};function u(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function c(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?u(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):u(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var l=function(e){var t,n,u,l,d,p,m,y,f,b,v,g=e.filters,h=e.newFilters,j=e.initialSort,O=(0,o.useRef)(),x=(0,o.useState)({}),S=x[0],P=x[1],w=(0,o.useState)({}),Z=w[0],_=w[1],I=j||{item:"createdAt",order:"desc"},q=(0,r.Z)({},(null===(t=O.current)||void 0===t?void 0:t.sort.item)||I.item,I.inneritem?(0,r.Z)({},I.inneritem,(null===(n=O.current)||void 0===n?void 0:n.sort.order)||I.order):(null===(u=O.current)||void 0===u?void 0:u.sort.order)||I.order);return(0,o.useEffect)(function(){var e=!(0,i.isEqual)(S,g),t=!(0,i.isEqual)(Z,h);if(e&&(P(g),null==O||null===(r=O.current)||void 0===r||r.resetPagination()),t&&(_(h),null==O||null===(o=O.current)||void 0===o||o.resetPagination()),null!=O&&null!==(n=O.current)&&void 0!==n&&n.setSort&&!(e||t)){var n,r,o,a,s,u,c,l,d,p,m,y=null!==(a=O.current)&&void 0!==a&&null!==(s=a.sort)&&void 0!==s&&s.item&&null!==(u=O.current)&&void 0!==u&&null!==(c=u.sort)&&void 0!==c&&c.order?{item:null===(l=O.current)||void 0===l?void 0:null===(d=l.sort)||void 0===d?void 0:d.item,order:null===(p=O.current)||void 0===p?void 0:null===(m=p.sort)||void 0===m?void 0:m.order}:q;O.current.setSort(y)}},[g,h]),{initialData:c(c({},g),{},{newFilters:(null==h?void 0:h.length)>0?h:void 0,limit:(null===(l=O.current)||void 0===l?void 0:l.pageSize)==="Infinity"?null:parseInt(null===(d=O.current)||void 0===d?void 0:d.pageSize,10)||a.C1.paginationSize,offset:((null===(p=O.current)||void 0===p?void 0:p.currentPage)-1||0)*((null===(m=O.current)||void 0===m?void 0:m.pageSize)||a.C1.paginationSize),orderBy:s(null===(y=O.current)||void 0===y?void 0:null===(f=y.sort)||void 0===f?void 0:null===(b=f.item)||void 0===b?void 0:b.replace(/ORDER/i,null===(v=O.current)||void 0===v?void 0:v.sort.order))||q}),initialSort:j,ref:O}}},2034:function(e,t,n){n.d(t,{R:function(){return v}});var r=n(59499),o=n(6812),i=n(88854),a=n(68956),s=n(74297),u=n(92264),c=n(47914),l=n(67872),d=n(42846),p=n(58095),m=n(85893);function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var b={item:"name",order:"asc"},v=function(e){var t=e.entity,n=e.entityId,r=e.refetchCompliance,y=e.parentId,v=e.type,g=(0,p.a)(),h=(0,d.x)({filters:{},initialSort:b}),j=h.initialData,O=h.ref,x=f(f({},j),{},{parentId:y}),S=(0,o.a)(i.Im,{variables:x}),P=S.data,w=(P=void 0===P?{taxonomy:[],meta:{aggregate:{totalCount:0}}}:P).taxonomy,Z=P.meta,_=S.loading,I=S.refetch,q=function(){I(),r&&r(),g.close()},T=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=f(f({},r),{},{type:v});"assetQuestion"!==v||o.id||(o.name="assetQuestionField-".concat(w.length)),g.show({title:r.id?"Edit":"Add",content:(0,m.jsx)(c.j,{entity:t,entityId:n,defaultValues:o,onSuccess:q,groups:{},parentId:y})})},$=function(e){var t;return[{context:"secondary",disabled:null===(t=e.data.meta)||void 0===t?void 0:t.isSystem,icon:["fas","edit"],onClick:function(e,t){return T("edit",t.data)},tooltip:"Edit"}]},k=[{hidden:!0},{hidden:!0},{text:"Name",formatter:function(e){var t,n,r=e.row;return"assetQuestion"===v?null==r?void 0:null===(t=r.data)||void 0===t?void 0:null===(n=t.meta)||void 0===n?void 0:n.label:r.name}},{hidden:!0},{text:"Status"},{formatter:a.Z,formatterData:$,text:"Actions"}];return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(l.t,{columns:k,loading:_,meta:Z,ref:O,refetch:I,rows:w.map(function(e){return{data:e,id:e.id,name:e.name,status:e.status,statusText:(0,s.Z)(e.status),actions:""}})}),(0,m.jsx)(u.H,{content:"Add New",handleClick:T})]})}},47914:function(e,t,n){n.d(t,{j:function(){return V}});var r=n(50029),o=n(16835),i=n(59499),a=n(64687),s=n.n(a),u=n(67294),c=n(50319),l=n(88854),d=n(42283),p=n(79665),m=n(76600),y=n(49501),f=n(55563),b=n(95103),v=n(62047),g=n(58594),h=n(15214),j=n(9270),O=n(62140),x=n(29005),S=n(55843),P=[{disabled:!0,text:"Please choose...",value:""},{text:"Checkbox",value:"checkbox",hasOptions:!0},{text:"CurrencyInput",value:"currencyInput",hasOptions:!1},{text:"Datepicker",value:"datepicker",hasOptions:!1},{text:"Input",value:"input",hasOptions:!1},{text:"Radio",value:"radio",hasOptions:!0},{text:"Select",value:"select",hasOptions:!0},{text:"Range(1 - 10)",value:"selectRange",hasOptions:!1},{text:"TextArea",value:"textArea",hasOptions:!1},{text:"Upload File",value:"media",hasOptions:!1}],w=[{text:"Email",value:"email"},{text:"Number",value:"number"},{text:"Text",value:"text"}],Z=n(85893);function _(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_(Object(n),!0).forEach(function(t){(0,i.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var q=function(e){var t=e.defaultOptions,n=(0,d.qo)({control:t.control,name:"input"}),r=n&&P.find(function(e){return e.value===n}).hasOptions,o=(0,d.Dq)({control:t.control,name:"options"}),i=o.fields,a=o.append,s=o.remove;return(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsx)(y.Z,{label:"Label",children:(0,Z.jsx)(f.Z,I(I({},t),{},{name:"label"}))}),(0,Z.jsx)(y.Z,{label:"Input",children:(0,Z.jsx)(b.Z,I(I({},t),{},{name:"input",options:P}))}),"input"===n&&(0,Z.jsx)(y.Z,{label:"Type",children:(0,Z.jsx)(b.Z,I(I({},t),{},{name:"inputType",options:w}))}),r&&(0,Z.jsxs)(Z.Fragment,{children:[(0,Z.jsxs)(j.Z,{children:[(0,Z.jsx)(O.Z,{xs:4,md:4,children:(0,Z.jsx)(y.Z,{label:"Options"})}),(0,Z.jsx)(O.Z,{children:(0,Z.jsx)(x.Z,{iconName:"plus",onClick:a})})]}),i.map(function(e,n){return(0,Z.jsxs)(u.Fragment,{children:[(0,Z.jsxs)(j.Z,{align:"center",children:[(0,Z.jsx)(O.Z,{xs:5,md:5,children:(0,Z.jsx)(f.Z,I(I({},t),{},{defaultValue:e.label,name:"options[".concat(n,"].label"),placeholder:"Label"}))}),(0,Z.jsx)(O.Z,{xs:5,md:5,children:(0,Z.jsx)(f.Z,I(I({},t),{},{defaultValue:e.value,name:"options[".concat(n,"].value"),placeholder:"Value"}))}),(0,Z.jsx)(O.Z,{xs:2,md:2,children:(0,Z.jsx)(x.Z,{iconName:"delete",onClick:function(){return s(n)}})})]}),(0,Z.jsx)(S.Z,{marginBottom:"md"})]},e.id)})]}),(0,Z.jsx)(g.Z,I(I({},t),{},{name:"required",data:[{label:"Required",value:!0}],stacked:!0}))]})},T=n(26380),$=n(18187),k=n(27812),C=[{name:"acquisitionCost",meta:{input:"currencyInput",inputType:"number",label:"Acquisition cost",isSystem:!0,questionType:"tco",required:!0}},{name:"datePutInService",meta:{input:"datepicker",inputType:"text",label:"Date put in service",isSystem:!0,questionType:"tco",required:!0}},{name:"usefulLife",meta:{input:"input",inputType:"number",label:"Useful life (months)",isSystem:!0,questionType:"tco",required:!0}},{name:"maintenanceSpend",meta:{input:"currencyInput",inputType:"number",label:"Maintenance spend (\xa3 p/m)",isSystem:!0,questionType:"tco",required:!0}},{name:"residualValue",meta:{input:"currencyInput",inputType:"number",label:"Residual Value",isSystem:!0,questionType:"tco",required:!0}}],D=[{name:"type",meta:{input:"select",inputType:"text",label:"Type",options:[{label:"Thermo",value:"thermo"},{label:"Occupancy",value:"occupancy"}],questionType:"sensor",isSystem:!0,required:!0}},{name:"brand",meta:{input:"select",inputType:"text",label:"Brand",options:[{label:"AirThings",value:"airthings"},{label:"Other",value:"other"}],questionType:"sensor",isSystem:!0,required:!0}}];function E(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?E(Object(n),!0).forEach(function(t){(0,i.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):E(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var z,Q=(z=(0,r.Z)(s().mark(function e(t){var n,r,o,i,a,u,c;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.addTaxonomy,r=t.adminId,o=t.hasSensorQuestions,i=t.hasTCOQuestions,u={status:"active",adminId:r,parentId:t.parentId,type:"assetQuestion"},c=[],i&&c.push.apply(c,(0,k.Z)(A(C,u))),o&&c.push.apply(c,(0,k.Z)(A(D,u))),e.next=7,n({variables:{objects:[].concat(c)}});case 7:case"end":return e.stop()}},e)})),function(e){return z.apply(this,arguments)}),A=function(e,t){return e.map(function(e){return e=F(F({},e),t)})},G=n(72936),N=n(26447);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function R(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach(function(t){(0,i.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var V=function(e){var t,n,i,a,j,O,x,S,P=e.defaultValues,w=e.entity,_=e.entityId,I=e.groups,k=e.hasSublocation,C=e.isAssetCategoryParent,D=e.onSuccess,E=e.parentId,F=void 0===E?null:E,z=e.systemQuestions,A=(0,G.x)().user,U=(0,u.useState)(!1),V=U[0],B=U[1],L=P.type,X=(0,u.useState)(!1),J=X[0],H=X[1],M=(0,u.useState)(!1),W=M[0],Y=M[1],K=(0,d.cI)({defaultValues:R(R({},P),{},{input:null==P?void 0:null===(t=P.meta)||void 0===t?void 0:t.input,inputType:null==P?void 0:null===(n=P.meta)||void 0===n?void 0:n.inputType,sensor:(null==P?void 0:P.hasSensor)||!1,label:null==P?void 0:null===(i=P.meta)||void 0===i?void 0:i.label,options:null==P?void 0:null===(a=P.meta)||void 0===a?void 0:a.options,required:null==P?void 0:null===(j=P.meta)||void 0===j?void 0:j.required,customerSignature:null==P?void 0:null===(O=P.meta)||void 0===O?void 0:O.customerSignature,supplierSignature:null==P?void 0:null===(x=P.meta)||void 0===x?void 0:x.supplierSignature,sublocation:(null==P?void 0:null===(S=P.meta)||void 0===S?void 0:S.sublocation)||!1}),resolver:(0,p.S)((0,$.S)(L))}),ee=K.control,et=K.errors,en=K.handleSubmit,er=K.register,eo=K.setValue,ei=K.watch,ea=ei("sublocation");ea="false"!==ea&&Boolean(ea);var es=ei("sensor");es="false"!==es&&Boolean(es);var eu,ec=function(e,t){eo(e,t),el()},el=function(){Y(!1),H(!1)},ed=(0,c.D)(l.mW,{onCompleted:function(e){var t=e.insert_Taxonomy.returning[0],n=t.id,r=t.type;(V||es)&&"assetQuestion"!==r?Q({hasTCOQuestions:V,hasSensorQuestions:es,addTaxonomy:ep,adminId:A.accountId,parentId:n}):D&&D(n)}}),ep=(0,o.Z)(ed,1)[0],em=(0,c.D)(l.ze,{onCompleted:function(e){var t=e.update_Taxonomy_by_pk,n=t.id,r=t.type;!z.sensor&&es&&"assetQuestion"!==r?Q({hasTCOQuestions:V,hasSensorQuestions:es,addTaxonomy:ep,adminId:A.accountId,parentId:n}):D&&D(n)}}),ey=(0,o.Z)(em,1)[0],ef=(eu=(0,r.Z)(s().mark(function e(t){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(F&&(t.parentId=F),!(ea&&es)){e.next=3;break}return e.abrupt("return",Y(!0));case 3:if(!(k&&ea&&!P.id)){e.next=5;break}return e.abrupt("return",H(!0));case 5:if(C&&(t.isGroup=!0),t.entity=w,t.entityId=_,t.meta=R(R({},(null==P?void 0:P.meta)||{}),{},{input:t.input,options:t.options,inputType:t.inputType,label:t.label,required:t.required,customerSignature:t.customerSignature,supplierSignature:t.supplierSignature,sublocation:t.sublocation}),delete t.input,delete t.inputType,delete t.sensor,delete t.label,delete t.options,delete t.required,delete t.sublocation,delete t.customerSignature,delete t.supplierSignature,t.adminId=A.accountId,!(null!=P&&P.id)){e.next=24;break}return e.next=22,ey({variables:{id:P.id,changes:t}});case 22:e.next=26;break;case 24:return e.next=26,ep({variables:{objects:[t]}});case 26:case"end":return e.stop()}},e)})),function(e){return eu.apply(this,arguments)}),eb={control:ee,errors:et,register:er},ev=R(R({},eb),{},{context:"secondary",size:"sm"});return(0,Z.jsxs)(m.Z,{id:"offCanvasForm",handleSubmit:en(ef),children:["assetQuestion"!==L&&(0,Z.jsx)(y.Z,{label:"Name",children:(0,Z.jsx)(f.Z,R(R({},eb),{},{name:"name"}))}),("assetQuestion"===L||"complianceQuestions"===L||"supplierQuestion"===L)&&(0,Z.jsx)(q,{defaultOptions:eb}),(null==I?void 0:I.length)>0&&(0,Z.jsx)(y.Z,{label:"Group",children:(0,Z.jsx)(b.Z,R(R({},eb),{},{name:"parentId",options:I}))}),(0,Z.jsx)(y.Z,{label:"Status",children:(0,Z.jsx)(b.Z,R(R({},eb),{},{name:"status",options:T.bg}))}),"assetCategory"===L&&!C&&!P.id&&(0,Z.jsx)(y.Z,{label:"Total cost of ownership",children:(0,Z.jsx)(v.Z,{context:"secondary",onToggle:function(e){return B(e)},size:"sm",toggled:V})}),"assetCategory"===L&&!C&&(0,Z.jsx)(y.Z,{label:"Sensor",children:(0,Z.jsx)(v.Z,{context:"secondary",disabled:z.sensor,onToggle:function(e){return ec("sensor",e)},size:"sm",toggled:es})}),"assetCategory"===L&&!C&&(0,Z.jsx)(y.Z,{label:"Sublocation",children:(0,Z.jsx)(v.Z,R(R({},ev),{},{onToggle:function(e){return ec("sublocation",e)},toggled:ea}))}),"signatures"===L&&(0,Z.jsxs)(N.Z,{spacing:10,direction:"row",children:[(0,Z.jsx)(g.Z,R(R({},eb),{},{name:"customerSignature",data:[{label:"Customer",value:!0}],stacked:!0})),(0,Z.jsx)(g.Z,R(R({},eb),{},{name:"supplierSignature",data:[{label:"Supplier",value:!0}],stacked:!0}))]}),J&&(0,Z.jsx)(h.Z,{content:"You can only create one sublocation",context:"warning"}),W&&(0,Z.jsx)(h.Z,{content:"You can only select a sub-location or a sensor",context:"warning"}),"assetQuestion"===L&&(0,Z.jsx)(f.Z,R(R({},eb),{},{name:"name",type:"hidden"})),(0,Z.jsx)(f.Z,R(R({},eb),{},{name:"sensor",type:"hidden"})),"assetCategory"===L&&(0,Z.jsx)(f.Z,R(R({},eb),{},{name:"sublocation",type:"hidden"})),(0,Z.jsx)(f.Z,R(R({},eb),{},{name:"type",type:"hidden"}))]})};V.defaultProps={hasSublocation:!1,isAssetCategoryParent:!1,systemQuestions:{sensor:!1}}},18187:function(e,t,n){n.d(t,{S:function(){return o},b:function(){return i}});var r=n(74231),o=function(e){var t="assetQuestion"===e||"complianceQuestions"===e||"supplierQuestion"===e;return(0,r.Ry)().shape({group:(0,r.Rx)(),input:t&&(0,r.Z_)().required(),label:t&&(0,r.Z_)().required(),name:(0,r.Z_)().required(),questions:(0,r.Xg)(),status:(0,r.Z_)().oneOf(["active","inactive"]).required(),sublocation:(0,r.Xg)(),required:(0,r.Xg)(),customerSignature:(0,r.Xg)(),supplierSignature:(0,r.Xg)()})},i=(0,r.Ry)().shape({reportPassFail:(0,r.Xg)(),reportPassFailTitle:(0,r.Z_)().when(["reportPassFail"],function(e,t){return e?t.max(50).required():t.nullable()})})},88854:function(e,t,n){n.d(t,{Im:function(){return p},RQ:function(){return f},fC:function(){return b},mW:function(){return m},uY:function(){return v},ze:function(){return y}});var r,o,i,a,s,u,c,l=n(71383),d=n(75063),p=(0,d.Ps)(r||(r=(0,l.Z)(['\n  query GetTaxonomys(\n    $limit: Int\n    $offset: Int\n    $q: String\n    $orderBy: Taxonomy_order_by!\n    $status: String = "active"\n    $type: String\n    $typeGroup: String\n    $parentId: Int\n    $fetchGroup: Boolean! = true\n    $id: Int\n    $isGroup: Boolean = false\n  ) {\n    taxonomy: Taxonomy(\n      limit: $limit\n      offset: $offset\n      where: {\n        name: { _ilike: $q }\n        status: { _eq: $status }\n        type: { _eq: $type }\n        parentId: { _eq: $parentId }\n        id: { _eq: $id }\n        isGroup: { _eq: $isGroup }\n      }\n      order_by: [$orderBy]\n    ) {\n      options: Taxonomies(\n        where: {\n          type: { _eq: $type }\n          name: { _ilike: $q }\n          id: { _eq: $id }\n          status: { _eq: "active" }\n        }\n        order_by: { name: asc }\n      ) {\n        value: id\n        label: name\n\n        childs: Taxonomies(order_by: { id: asc }, where: { status: { _eq: "active" } }) {\n          taxonomyId: id\n          name\n          type\n          meta\n          status\n        }\n      }\n      id\n      name\n      type\n      status\n      parentId\n      createdAt\n      meta\n      parent: Parent {\n        id\n        name\n        type\n      }\n      childs: Taxonomies(order_by: { id: asc }, where: { status: { _eq: "active" } }) {\n        taxonomyId: id\n        name\n        type\n        meta\n        status\n      }\n      jobs: Taxonomy_Entities_aggregate(\n        where: { Taxonomy: { type: { _eq: "jobTags" } }, entity: { _eq: "Job" } }\n      ) {\n        aggregate {\n          count\n        }\n      }\n    }\n    meta: Taxonomy_aggregate(\n      where: {\n        name: { _ilike: $q }\n        status: { _eq: $status }\n        type: { _eq: $type }\n        parentId: { _eq: $parentId }\n        id: { _eq: $id }\n        isGroup: { _eq: $isGroup }\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n    taxonomyGroup: Taxonomy(where: { isGroup: { _eq: true }, type: { _eq: $typeGroup } })\n      @include(if: $fetchGroup) {\n      value: id\n      text: name\n    }\n  }\n'])));(0,d.Ps)(o||(o=(0,l.Z)(["\n  query GetTaxonomy($id: Int!) {\n    taxonomy: Taxonomy_by_pk(id: $id) {\n      id\n      name\n      type\n      status\n      parentId\n      createdAt\n      meta\n    }\n  }\n"])));var m=(0,d.Ps)(i||(i=(0,l.Z)(["\n  mutation AddTaxonomy($objects: [Taxonomy_insert_input!]!) {\n    insert_Taxonomy(objects: $objects) {\n      returning {\n        id\n        type\n      }\n    }\n  }\n"]))),y=(0,d.Ps)(a||(a=(0,l.Z)(["\n  mutation UpdateTaxonomy($id: Int!, $changes: Taxonomy_set_input) {\n    update_Taxonomy_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n      type\n    }\n  }\n"]))),f=(0,d.Ps)(s||(s=(0,l.Z)(["\n  query GeTaxonomyWithEntities($type: String!, $entity: String!, $entityId: Int!) {\n    questions: Taxonomy(where: { type: { _eq: $type } }) {\n      id\n      meta\n      name\n      status\n      taxonomy_entity: Taxonomy_Entities(\n        where: { entityId: { _eq: $entityId }, entity: { _eq: $entity } }\n      ) {\n        comments\n      }\n    }\n  }\n"]))),b=(0,d.Ps)(u||(u=(0,l.Z)(["\n  mutation InsertTaxonomyEntity(\n    $entity: String!\n    $entityId: Int!\n    $questions: [Taxonomy_Entity_insert_input!]!\n    $objectStatusLog: [StatusLog_insert_input!]!\n    $hasStatusLog: Boolean!\n  ) {\n    delete_Taxonomy_Entity(where: { entityId: { _eq: $entityId }, entity: { _eq: $entity } }) {\n      returning {\n        id\n      }\n    }\n    insert_Taxonomy_Entity(objects: $questions) {\n      returning {\n        id\n      }\n    }\n\n    insert_StatusLog(objects: $objectStatusLog) @include(if: $hasStatusLog) {\n      returning {\n        id\n      }\n    }\n  }\n"]))),v=(0,d.Ps)(c||(c=(0,l.Z)(["\n  query GetSLAsForJobManage {\n    slas: SLA(order_by: { name: asc }) {\n      id\n      label: name\n      notes\n    }\n  }\n"])))},27940:function(e,t,n){n.d(t,{l:function(){return f}});var r=n(59499),o=n(4730),i=n(67294),a=n(6812),s=n(88854),u=n(49501),c=n(84043),l=n(85893),d=["control","errors","label","name","register","type","filters"];function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function m(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var y=function(e,t){var n,r,o,i=!0;return(null===(n=e.errors[e.name])||void 0===n?void 0:n.message)!==(null===(r=t.errors[t.name])||void 0===r?void 0:r.message)&&(i=!1),["name","type"].forEach(function(n){e[n]!==t[n]&&(i=!1)}),i},f=(0,i.memo)(function(e){var t,n,r,i=e.control,p=e.errors,y=e.label,f=e.name,b=e.register,v=e.type,g=e.filters,h=(0,o.Z)(e,d),j=(r=(n=void 0===(n=(0,a.a)(s.Im,{variables:m(m({isGroup:"assetCategory"===v},g),{},{orderBy:{name:"asc"},type:v})}).data)?{taxonomy:[]}:n).taxonomy,"assetCategory"===v?r.map(function(e){return{label:e.name,options:e.options,childs:e.childs,meta:e.meta}}):r.map(function(e){return{label:e.name,value:e.id,childs:e.childs,meta:e.meta}}));return(0,l.jsx)(u.Z,{id:f,label:y,children:(0,l.jsx)(c.Z,m(m({},{control:i,errors:p,register:b}),{},{cacheOptions:!0,isClearable:!0,options:j,name:f},h))})},y);f.defaultProps={filters:{}}},3896:function(e,t,n){n.d(t,{X:function(){return m}});var r,o,i=n(71383),a=n(16835),s=n(59499),u=n(67294),c=n(6812),l=n(50319),d=n(75063),p=n(55863);function m(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage",r=(0,p.q)().user,o=(0,u.useState)(function(){try{switch(n){case"network":return t;case"sessionStorage":return JSON.parse(window.sessionStorage.getItem(e))||t}}catch(r){return t}}),i=o[0],d=o[1],m=function(t){try{var o=t instanceof Function?t(i):t;switch(d(o),n){case"network":v({variables:{accountUserId:null==r?void 0:r.accountUserId,filters:(0,s.Z)({},e,o)}});break;case"sessionStorage":window.sessionStorage.setItem(e,JSON.stringify(o))}}catch(a){}};(0,c.a)(y,{variables:{accountUserId:null==r?void 0:r.accountUserId},skip:"network"!==n,onCompleted:function(n){var r=n.accountUser;r&&d(r.filters[e]||t)}});var b=(0,l.D)(f),v=(0,a.Z)(b,1)[0];return[i,m]}var y=(0,d.Ps)(r||(r=(0,i.Z)(["\n  query GetAccountUserFilters($accountUserId: Int!) {\n    accountUser: Account_User_by_pk(id: $accountUserId) {\n      filters\n    }\n  }\n"]))),f=(0,d.Ps)(o||(o=(0,i.Z)(["\n  mutation SetAccountUserFilters($accountUserId: Int!, $filters: jsonb) {\n    update_Account_User_by_pk(pk_columns: { id: $accountUserId }, _append: { filters: $filters }) {\n      id\n    }\n  }\n"])))},26380:function(e,t,n){n.d(t,{bg:function(){return r}});var r=[{text:"Status",value:""},{text:"Active",value:"active"},{text:"Inactive",value:"inactive"}]},12964:function(e,t,n){n.d(t,{J:function(){return w}});var r=n(59499),o=n(16835),i=n(4730),a=n(11163),s=n(67294),u=n(9270),c=n(62140),l=n(42283),d=n(76600),p=n(58965),m=n(49501),y=n(75903),f=n(77439),b=n(92264),v=n(3896),g=n(85893);function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function j(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var O=function(e){var t=e.initialValues,n=e.renderFilters,r=e.setFilters,i=e.lastQuery,a=e.filters,h=(0,v.X)("form_data_".concat(t.filterType),t),O=(0,o.Z)(h,2),x=O[0],S=O[1],P=(0,l.cI)({defaultValues:x||t}),w=P.control,Z=P.errors,_=P.handleSubmit,I=P.register,q=P.reset,T=P.watch,$=P.setValue,k=T(),C=j(j({},k),{},{filterType:t.filterType});(0,s.useEffect)(function(){q(C)},[q]),(0,s.useEffect)(function(){S(C)},[a]);var D=function(e){var n=e.query;if(n!==i){var o={q:"%".concat(n,"%")||0},a=/^\d+$/.test(n);"id"in t&&(o.id=a?Number(n):null),"meta"in t&&(o.meta=a?{invoiceNumbers:[n]}:null),"jobNumber"in t&&(o.jobNumber=a?String(n):null,o.invoiceNumber=a?Number(n):null),r(function(e){return j(j({},e),o)})}},E=function(e){Object.keys(t).map(function(e){return $(e,null)}),r(t),q(t),D("")};return(0,g.jsx)(d.Z,{handleSubmit:_(D),children:(0,g.jsxs)(p.Z,{title:"Filters",children:[(0,g.jsxs)(u.Z,{children:[(0,g.jsx)(c.Z,{sm:12,lg:12,children:(0,g.jsx)(m.Z,{label:"",children:(0,g.jsx)(y.Z,{errors:Z,label:"Search",name:"email",placeholder:"Search...",prependSearchIcon:!0,register:I,type:"search"})})}),(0,g.jsx)(c.Z,{sm:12,lg:12,children:n({control:w,errors:Z,initialValues:t,register:I,setFilters:r,watch:T,setValue:$,reset:q})})]}),(0,g.jsx)(b.H,{content:"Search",context:"secondary",handleClick:D,type:"submit",children:(0,g.jsx)(f.Z,{content:"Clear",context:"danger",onClick:E,size:"sm"})})]})})},x=["FiltersComp","initialFilters","TableComp"];function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var w=function(e){var t=e.FiltersComp,n=e.initialFilters,r=e.TableComp,l=(0,i.Z)(e,x),d=(0,v.X)("form_data_".concat(n.filterType),n),p=(0,o.Z)(d,2),m=p[0],y=p[1],f=(0,s.useState)(m||n),b=f[0],h=f[1],j=(0,a.useRouter)().query.show;return(0,s.useEffect)(function(){y(b)},[b,y]),(0,g.jsx)(u.Z,{children:(0,g.jsxs)(c.Z,{sm:12,lg:12,children:[(0,g.jsx)(O,{initialValues:n,renderFilters:function(e){return(0,g.jsx)(t,P(P(P({},e),l),{},{show:j}))},setFilters:h,filters:b}),(0,g.jsx)(r,P({filters:b,initialFilters:n},l))]})})}}}]);