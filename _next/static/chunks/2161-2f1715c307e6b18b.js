"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2161],{1950:function(e,t,n){n.d(t,{V:function(){return C}});var r=n(59499),i=n(27812),o=n(26447),a=n(15861),s=n(21023),c=n(93946),l=n(72428),u=n(67294),d=n(9164),p=n(42283),f=n(79665),m=n(50135),h=n(11057),g=n(51797),x=n(46761),v=n(74231),b=v.Ry({name:v.Z_().required(),url:v.Z_().url().required()}),y=n(85893);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Z=function(e){var t=e.noEdit,n=e.noDelete,r=e.onDelete,i=e.id,a=e.isAdded,l=e.url,v=e.name,j=e.onSave,Z=(0,u.useState)(a),k=Z[0],O=Z[1],C=(0,p.cI)({resolver:(0,f.S)(b)}),S=C.control,P=C.handleSubmit,_=C.errors,D=function(e){e.stopPropagation(),O(!0)},I=function(e){e.stopPropagation(),O(!1),v&&l||r()},E=function(e){j(e),O(!1)};return(0,y.jsx)("form",{children:k?(0,y.jsxs)(o.Z,{children:[(0,y.jsxs)(o.Z,{spacing:1,children:[(0,y.jsx)(p.Qr,{control:S,name:"name",defaultValue:v,render:function(e){var t;return(0,y.jsx)(m.Z,w(w({fullWidth:!0,label:"Name",variant:"standard",color:"secondary"},e),{},{error:_.name,helperText:null===(t=_.name)||void 0===t?void 0:t.message}))}}),(0,y.jsx)(p.Qr,{control:S,name:"url",defaultValue:l,render:function(e){var t;return(0,y.jsx)(m.Z,w(w({fullWidth:!0,label:"Link",variant:"standard",color:"secondary"},e),{},{error:_.url,helperText:null===(t=_.url)||void 0===t?void 0:t.message}))}})]}),(0,y.jsxs)(o.Z,{direction:"row",justifyContent:"flex-end",spacing:1,mt:2,children:[(0,y.jsx)(h.Z,{variant:"contained",color:"danger",size:"small",onClick:I,children:"Cancel"}),(0,y.jsx)(h.Z,{variant:"contained",size:"small",onClick:P(E),children:"Save"})]})]}):(0,y.jsxs)(o.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,y.jsx)(d.r,{target:"_blank",variant:"body1",color:"secondary",href:l,sx:{textDecoration:"auto",fontWeight:700},children:v}),!t&&(0,y.jsx)(s.Z,{title:"Edit",placement:"top-start",children:(0,y.jsx)(c.Z,{size:"small",sx:{":hover":{backgroundColor:"#DDDDDD"}},onClick:D,children:(0,y.jsx)(g.Z,{sx:{fontSize:"16px"}})})}),!n&&(0,y.jsx)(s.Z,{title:"Delete",placement:"top-start",children:(0,y.jsx)(c.Z,{size:"small",sx:{":hover":{backgroundColor:"#DDDDDD"}},onClick:function(){return r(i)},children:(0,y.jsx)(x.Z,{sx:{fontSize:"16px"}})})})]})})};function k(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?k(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}Z.defaultProps={isAdded:!1,noEdit:!1,noDelete:!1,url:"",name:"",onSave:function(){},onCancel:function(){},onDelete:function(){}};var C=function(e){var t=e.values,n=e.setValue,r=e.name,d=e.title,p=e.displayMode,f=e.noDeleteEdit,m=e.titleSx,h=(0,u.useState)([]),g=h[0],x=h[1];(0,u.useEffect)(function(){Array.isArray(t)&&x(t)},[t]);var v=function(e){e.stopPropagation(),x(function(e){return[].concat((0,i.Z)(e),[{name:"",link:"",isAdded:!0}])})},b=function(e,t){var o=(0,i.Z)(g);o.splice(e,1,t),n(r,o)};return(0,y.jsxs)(o.Z,{children:[(0,y.jsxs)(o.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,y.jsxs)(a.Z,{sx:m,children:[d,":"]}),!p&&(0,y.jsx)(s.Z,{title:"Add new link",placement:"top-start",children:(0,y.jsx)(c.Z,{size:"small",sx:{":hover":{backgroundColor:"#DDDDDD"}},onClick:v,children:(0,y.jsx)(l.Z,{})})})]}),(0,y.jsx)(o.Z,{pl:2,spacing:.8,children:null!=g&&g.length?g.map(function(e,i){var o;return(0,y.jsx)(Z,O(O({index:i},e),{},{noEdit:f||p,noDelete:f||p,onDelete:function(){var e=t.filter(function(e,t){return t!==i});n(r,e),x(e)},onSave:function(e){return b(i,e)}}))}):(0,y.jsx)(a.Z,{typography:"subtitle2",children:"No data"})})]})};C.defaultProps={values:[],setValue:function(){},title:"Related links",displayMode:!1,noDeleteEdit:!1,titleSx:{}}},2362:function(e,t,n){n.d(t,{H:function(){return s},Z:function(){return a}});var r=n(67294),i=n(85893),o=(0,r.createContext)();function a(e){var t=e.audience,n=e.setAudience,r=e.audienceOptions,a=e.children;return(0,i.jsx)(o.Provider,{value:{audience:t,setAudience:n,audienceOptions:r},children:a})}a.defaultProps={audience:"",setAudience:function(){},audienceOptions:[]};var s=function(){return(0,r.useContext)(o)}},67011:function(e,t,n){n.d(t,{V:function(){return c},Z:function(){return s}});var r=n(67026),i=n(67294),o=n(85893),a=(0,i.createContext)({});function s(e){var t=e.children,n=(0,i.useMemo)(function(){return{historyState:(0,r.l)()}},[]);return(0,o.jsx)(a.Provider,{value:n,children:t})}var c=function(){return(0,i.useContext)(a)}},17896:function(e,t,n){n.d(t,{Z:function(){return a},i:function(){return s}});var r=n(67294),i=n(85893),o=(0,r.createContext)({setMentionSearch:function(){},mentions:[]});function a(e){var t=e.setMentionSearch,n=e.mentions,r=e.children;return(0,i.jsx)(o.Provider,{value:{setMentionSearch:t,mentions:n},children:r})}a.defaultProps={setMentionSearch:function(){},mentions:[]};var s=function(){return(0,r.useContext)(o)}},66076:function(e,t,n){n.d(t,{HB:function(){return m},HJ:function(){return f},dP:function(){return h}});var r=n(92777),i=n(82262),o=n(45959),a=n(72179),s=n(37247),c=n(61084),l=n(67294),u=n(85893),d=l.lazy(function(){return n.e(5308).then(n.bind(n,35308))});function p(e){if(e.src.startsWith("file:///"))return null;var t=e.alt,n=e.src,r=e.width;return{node:m({altText:t,height:e.height,src:"".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(n),width:r})}}var f=function(e){(0,o.Z)(h,e);var t,n,f=(n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=(0,s.Z)(h);if(n){var r=(0,s.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,a.Z)(this,e)});function h(e,t,n,i,o,a,s,l,u,d,p){var m;return(0,r.Z)(this,h),(m=f.call(this,p)).__src=e,m.__altText=t,m.__maxWidth=n,m.__width=i,m.__height=o,m.__showCaption=a||!1,m.__caption=s||(0,c.Jh)(),m.__captionsEnabled=l||void 0===l,m.__className=u,m.__isLink=d,m}return(0,i.Z)(h,[{key:"exportDOM",value:function(){var e=document.createElement("img");return e.setAttribute("src",this.__src),e.setAttribute("alt",this.__altText),e.setAttribute("width",this.__width),e.setAttribute("height",this.__height),{element:e}}},{key:"exportJSON",value:function(){return{altText:this.getAltText(),caption:this.__caption.toJSON(),height:this.__height,maxWidth:this.__maxWidth,showCaption:this.__showCaption,src:this.getSrc(),type:"image",version:1,width:this.__width,className:this.__className,isLink:this.__isLink}}},{key:"setWidthAndHeight",value:function(e,t){var n=this.getWritable();n.__width=e,n.__height=t}},{key:"setShowCaption",value:function(e){this.getWritable().__showCaption=e}},{key:"createDOM",value:function(e){var t=document.createElement("span"),n=e.theme.image;return void 0!==n&&(t.className=n),t}},{key:"updateDOM",value:function(){return!1}},{key:"getSrc",value:function(){return this.__src}},{key:"setSrc",value:function(e){this.__src=e}},{key:"getAltText",value:function(){return this.__altText}},{key:"decorate",value:function(){return(0,u.jsx)(l.Suspense,{fallback:null,children:(0,u.jsx)(d,{className:this.__className,src:this.__src,altText:this.__altText,width:this.__width,height:this.__height,maxWidth:this.__maxWidth,nodeKey:this.getKey(),showCaption:this.__showCaption,caption:this.__caption,captionsEnabled:this.__captionsEnabled,resizable:!0})})}}],[{key:"getType",value:function(){return"image"}},{key:"clone",value:function(e){return new h(e.__src,e.__altText,e.__maxWidth,e.__width,e.__height,e.__showCaption,e.__caption,e.__captionsEnabled,e.__className,e.__isLink,e.__key)}},{key:"importJSON",value:function(e){var t=e.altText,n=e.height,r=e.width,i=e.maxWidth,o=e.caption,a=e.src,s=e.showCaption,c=e.isLink,l=e.className,u=c?a:"".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(a),d=m({altText:t,height:n,maxWidth:i,showCaption:s,src:u,width:r,className:l}),p=d.__caption,f=p.parseEditorState(o.editorState);return f.isEmpty()||p.setEditorState(f),d}},{key:"importDOM",value:function(){return{img:function(e){return{conversion:p,priority:0}}}}}]),h}(c.Ij);function m(e){var t=e.altText,n=e.height,r=e.maxWidth,i=e.captionsEnabled,o=e.src,a=e.width,s=e.showCaption,l=e.caption,u=e.className,d=e.isLink,p=e.key;return(0,c.U2)(new f(o,t,r,a,n,s,l,i,u,d,p))}function h(e){return e instanceof f}},30852:function(e,t,n){n.d(t,{AV:function(){return m},IY:function(){return h}});var r=n(59499),i=n(92777),o=n(82262),a=n(74450),s=n(45959),c=n(72179),l=n(37247),u=n(61084);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function f(e){var t=e.trigger,n=e.label,r=e.value;return null!==n&&null!==t?{node:h({trigger:t,label:n,value:r})}:null}var m=function(e){(0,s.Z)(u,e);var t,n,r=(n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=(0,l.Z)(u);if(n){var r=(0,l.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,c.Z)(this,e)});function u(e,t,n,o,a){var s;return(0,i.Z)(this,u),(s=r.call(this,e+t,a)).__trigger=e,s.__label=t,s.__value=n,s}return(0,o.Z)(u,[{key:"exportJSON",value:function(){return p(p({},(0,a.Z)((0,l.Z)(u.prototype),"exportJSON",this).call(this)),{},{trigger:this.__trigger,label:this.__label,value:this.__value,type:"mention",version:1})}},{key:"createDOM",value:function(e){var t=(0,a.Z)((0,l.Z)(u.prototype),"createDOM",this).call(this,e);return t.className="editor-text-mention",t}},{key:"exportDOM",value:function(){var e=document.createElement("span");return e.setAttribute("data-lexical-mention","true"),e.textContent=this.__text,e.trigger=this.__trigger,e.label=this.__label,e.value=this.__value,{element:e}}},{key:"isTextEntity",value:function(){return!0}},{key:"canInsertTextBefore",value:function(){return!1}},{key:"canInsertTextAfter",value:function(){return!1}}],[{key:"getType",value:function(){return"mention"}},{key:"clone",value:function(e){return new u(e.__trigger,e.__label,e.__value,e.__text,e.__key)}},{key:"importJSON",value:function(e){var t=h({trigger:e.trigger,label:e.label,value:e.value});return t.setTextContent(e.text),t.setFormat(e.format),t.setDetail(e.detail),t.setMode(e.mode),t.setStyle(e.style),t}},{key:"importDOM",value:function(){return{span:function(e){return e.hasAttribute("data-lexical-mention")?{conversion:f,priority:1}:null}}}}]),u}(u.R2);function h(e){var t=e.trigger,n=e.label,r=e.value,i=new m(t,n,r);return i.setMode("segmented").toggleDirectionless(),(0,u.U2)(i)}},69094:function(e,t,n){n.d(t,{WL:function(){return tl},Ps:function(){return th},yi:function(){return tt},tC:function(){return eY},Xe:function(){return ec},Hi:function(){return eh},Nz:function(){return ez},DE:function(){return e4},Mq:function(){return ef},xt:function(){return tp}});var r,i,o,a=n(16835),s=n(46895),c=n(61084),l=n(42693),u=n(23605),d=n(10261),p=n(18824),f=n(79380),m=n(87012),h=n(88560),g=n(67294),x=n(19861),v=n(55578),b=n(21605),y=n(82443),j=n(79230),w=n(58309),Z=n(44743),k=n(21798),O=n(54612),C=n(90086),S=n(82553),P=n(40580),_=n(37345);function D(e){var t=e.anchor,n=e.focus,r=e.anchor.getNode(),i=e.focus.getNode();return r===i?r:e.isBackward()?(0,d.P4)(n)?r:i:(0,d.P4)(t)?r:i}var I=new Set(["http:","https:","mailto:","sms:","tel:"]);function E(e){try{var t=new URL(e);if(!I.has(t.protocol))return"about:blank"}catch(n){}return e}var A=RegExp(/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[-;:&=+$,\w]+@)?[A-Za-z0-9.-]+|(?:www.|[-;:&=+$,\w]+@)[A-Za-z0-9.-]+)((?:\/[+~%/.\w-_]*)?\??(?:[-+=&;%@.\w_]*)#?(?:[\w]*))?)/);function M(e){return"https://"===e||A.test(e)}var L=n(92178),T=n(11057),z=n(18972),R=n(32715),N=n(53267),U=n(59499),$=n(50029),W=n(27812),q=n(64687),B=n.n(q),F=n(66076),H=n(26447),V=n(50135),Q=n(90629),G=n(35520),Y=n(10166),K=n(85893);function J(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function X(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?J(Object(n),!0).forEach(function(t){(0,U.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ee(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return et(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return et(e,t)}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function et(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var en=["image/","image/heic","image/heif","image/gif","image/webp"],er=(0,c.fA)("INSERT_IMAGE_COMMAND"),ei=(0,Y.Z)("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1});function eo(e){var t=e.onClick,n=(0,g.useState)(""),r=n[0],i=n[1],o=(0,g.useState)(""),a=o[0],s=o[1];return(0,K.jsxs)(H.Z,{p:2,spacing:1,children:[(0,K.jsx)(V.Z,{label:"Image URL",placeholder:"i.e. https://source.unsplash.com/random",onChange:function(e){return i(e.target.value)},value:r,"data-test-id":"image-modal-url-input",variant:"outlined",color:"secondary"}),(0,K.jsx)(V.Z,{label:"Alt Text",placeholder:"Random unsplash image",onChange:function(e){return s(e.target.value)},value:a,"data-test-id":"image-modal-alt-text-input",variant:"outlined",color:"secondary"}),(0,K.jsx)(T.Z,{color:"secondary",variant:"contained",disabled:""===r,onClick:function(){return t({altText:a,src:r,isLink:!0})},children:"Confirm"})]})}function ea(e){var t=e.onClick,n=(0,g.useState)([]),r=n[0],i=n[1],o=0===r.length,a=function(e){var t=e.target.files;i((0,W.Z)(t))};return(0,K.jsxs)(H.Z,{p:2,spacing:1,children:[(0,K.jsx)(H.Z,{spacing:2,children:r.map(function(e){return(0,K.jsx)(L.G5,{file:e})})}),(0,K.jsxs)(T.Z,{component:"label",variant:"contained",color:"secondary",startIcon:(0,K.jsx)(G.Z,{}),children:["Upload files",(0,K.jsx)(ei,{type:"file",accept:"image/*",multiple:!0,onChange:a})]}),(0,K.jsx)(T.Z,{color:"secondary",variant:"contained",disabled:o,onClick:function(){return t(r)},children:"Confirm"})]})}function es(e){var t,n=e.activeEditor,r=e.onClose,i=(0,g.useState)(null),o=i[0],a=i[1],s=(0,g.useRef)(!1);(0,g.useEffect)(function(){s.current=!1;var e=function(e){s.current=e.altKey};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}},[n]);var c=(t=(0,$.Z)(B().mark(function e(t){var i,o,a,s,c,l;return B().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,p.j5)(t,[en].flatMap(function(e){return e}));case 2:o=ee(e.sent);try{for(o.s();!(a=o.n()).done;)c=(s=a.value).file,l=s.result,(0,p.tV)(c,en)&&n.dispatchCommand(er,{altText:c.name,src:l})}catch(i){o.e(i)}finally{o.f()}r();case 6:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),l=function(e){n.dispatchCommand(er,e),r()};return(0,K.jsxs)(Q.Z,{sx:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:"400px"},children:[!o&&(0,K.jsxs)(H.Z,{p:2,spacing:1,children:[(0,K.jsx)(T.Z,{color:"secondary",variant:"contained",onClick:function(){return a("url")},children:"URL"}),(0,K.jsx)(T.Z,{color:"secondary",variant:"contained",onClick:function(){return a("file")},children:"File"})]}),"url"===o&&(0,K.jsx)(eo,{onClick:l}),"file"===o&&(0,K.jsx)(ea,{onClick:c})]})}function ec(e){var t=e.captionsEnabled,n=(0,s.g)(),r=(0,a.Z)(n,1)[0];return(0,g.useEffect)(function(){if(!r.hasNodes([F.HJ]))throw Error("ImagesPlugin: ImageNode not registered on editor");return(0,p.qV)(r.registerCommand(er,function(e){var n=(0,F.HB)(X(X({},e),{},{captionsEnabled:t}));return(0,c.od)([n]),(0,c._v)(n.getParentOrThrow())&&(0,p.JB)(n,c.BE).selectEnd(),!0},c.VN),r.registerCommand(c.XI,function(e){return function(e){var t=el();if(!t)return!1;var n=e.dataTransfer;if(!n)return!1;var r=document.createElement("img");return r.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",n.setData("text/plain","_"),n.setDragImage(r,0,0),n.setData("application/x-lexical-drag",JSON.stringify({data:{altText:t.__altText,caption:t.__caption,height:t.__height,key:t.getKey(),maxWidth:t.__maxWidth,showCaption:t.__showCaption,src:t.__src,width:t.__width},type:"image"})),!0}(e)},c.Eo),r.registerCommand(c.kE,function(e){var t;return t=e,!!el()&&(eu(t)||t.preventDefault(),!0)},c.KB),r.registerCommand(c.zD,function(e){return function(e,t){var n=el();if(!n)return!1;var r=function(e){var t,n=null===(t=e.dataTransfer)||void 0===t?void 0:t.getData("application/x-lexical-drag");if(!n)return null;var r=JSON.parse(n),i=r.type,o=r.data;return"image"!==i?null:o}(e);if(!r)return!1;if(e.preventDefault(),eu(e)){var i=function(e){var t,n,r=e.target,i=((n=null==r?null:9===r.nodeType?r.defaultView:r.ownerDocument.defaultView)||window).getSelection();if(document.caretRangeFromPoint)t=document.caretRangeFromPoint(e.clientX,e.clientY);else if(e.rangeParent&&null!==i)i.collapse(e.rangeParent,e.rangeOffset||0),t=i.getRangeAt(0);else throw Error("Cannot get the selection when dragging");return t}(e);n.remove();var o=(0,c.vN)();null!=i&&o.applyDOMRange(i),(0,c.oq)(o),t.dispatchCommand(er,r)}return!0}(e,r)},c.Eo))},[t,r]),null}function el(){var e=(0,c.dL)();if(!(0,c.iO)(e))return null;var t=e.getNodes()[0];return(0,F.dP)(t)?t:null}function eu(e){var t=e.target;return!!(t&&t instanceof HTMLElement&&!t.closest("code, span.editor-image")&&t.parentElement&&t.parentElement.closest("div.ContentEditable__root"))}var ed={bullet:"Bulleted List",check:"Check List",code:"Code Block",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",h6:"Heading 6",number:"Numbered List",paragraph:"Normal",quote:"Quote"};function ep(){return(0,K.jsx)("div",{className:"divider"})}function ef(e){var t=e.setIsLinkEditMode,n=(0,s.g)(),r=(0,a.Z)(n,1)[0],i=(0,g.useState)(r),o=i[0],I=i[1],A=(0,g.useState)("paragraph")[1],M=(0,g.useState)("root")[1],U=(0,g.useState)(null)[1],$=(0,g.useRef)(null),W=(0,g.useState)("15px")[1],q=(0,g.useState)("#000"),B=q[0],F=q[1],H=(0,g.useState)("#fff"),V=H[0],Q=H[1],G=(0,g.useState)("Arial")[1],Y=(0,g.useState)("left")[1],J=(0,g.useState)(!1),X=J[0],ee=J[1],et=(0,g.useState)(!1),en=et[0],er=et[1],ei=(0,g.useState)(!1),eo=ei[0],ea=ei[1],ec=(0,g.useState)(!1),el=ec[0],eu=ec[1],ef=(0,g.useState)(!1),em=ef[0],eh=ef[1],eg=(0,g.useState)(!1),ex=eg[0],ev=eg[1],eb=(0,g.useState)(!1),ey=eb[0],ej=eb[1],ew=(0,g.useState)(!1),eZ=ew[0],ek=ew[1],eO=(0,g.useState)(!1)[1],eC=(0,g.useState)(!1)[1],eS=(0,g.useState)(!1)[1],eP=(0,g.useState)("")[1],e_=(0,R.d)(),eD=(0,a.Z)(e_,2),eI=eD[0],eE=eD[1],eA=(0,g.useState)(function(){return r.isEditable()}),eM=eA[0],eL=eA[1],eT=(0,g.useCallback)(function(){var e=(0,c.dL)();if((0,c.OP)(e)){var t,n=e.anchor.getNode(),r="root"===n.getKey()?n:(0,p.$s)(n,function(e){var t=e.getParent();return null!==t&&(0,c._v)(t)});null===r&&(r=n.getTopLevelElementOrThrow());var i=r.getKey(),a=o.getElementByKey(i);eh(e.hasFormat("bold")),ev(e.hasFormat("italic")),ej(e.hasFormat("underline")),ek(e.hasFormat("strikethrough")),eO(e.hasFormat("subscript")),eC(e.hasFormat("superscript")),ea(e.hasFormat("code")),eS((0,d.Vx)(e));var s=D(e),g=s.getParent();(0,l.Pq)(g)||(0,l.Pq)(s)?eu(!0):eu(!1);var x=(0,p.$s)(s,f.di);if((0,f.di)(x)?M("table"):M("root"),null!==a){if(U(i),(0,h.I3)(r)){var v=(0,p.yD)(n,h.EG);A(v?v.getListType():r.getListType())}else{var b=(0,u.rc)(r)?r.getTag():r.getType();if(b in ed&&A(b),(0,m.Pe)(r)){var y=r.getLanguage();eP(y?m.md[y]||y:"");return}}}W((0,d.ui)(e,"font-size","15px")),F((0,d.ui)(e,"color","#000")),Q((0,d.ui)(e,"background-color","#fff")),G((0,d.ui)(e,"font-family","Arial")),(0,l.Pq)(g)&&(t=(0,p.$s)(s,function(e){return(0,c.F7)(e)&&!e.isInline()})),Y((0,c.F7)(t)?t.getFormatType():(0,c.F7)(s)?s.getFormatType():(null==g?void 0:g.getFormatType())||"left")}},[o]);(0,g.useEffect)(function(){return r.registerCommand(c.oj,function(e,t){return eT(),I(t),!1},c.jw)},[r,eT]),(0,g.useEffect)(function(){return(0,p.qV)(r.registerEditableListener(function(e){eL(e)}),o.registerUpdateListener(function(e){e.editorState.read(function(){eT()})}),o.registerCommand(c.yn,function(e){return ee(e),!1},c.jw),o.registerCommand(c.r0,function(e){return er(e),!1},c.jw))},[eT,o,r]),(0,g.useEffect)(function(){return o.registerCommand(c.yb,function(e){var n,r=e.code,i=e.ctrlKey,a=e.metaKey;return"KeyK"===r&&(!!i||!!a)&&(e.preventDefault(),el?(t(!1),n=null):(t(!0),n=E("https://")),o.dispatchCommand(l.k0,n))},c.u6)},[o,el,t]);var ez=(0,g.useCallback)(function(e){e.preventDefault(),el?(t(!1),r.dispatchCommand(l.k0,null)):(t(!0),r.dispatchCommand(l.k0,E("https://")))},[r,el,t]),eR=(0,g.useCallback)(function(e,t){o.update(function(){var t=(0,c.dL)();null!==t&&(0,d.yD)(t,e)},t?{tag:"historic"}:{})},[o]),eN=(0,g.useCallback)(function(e,t){eR({color:e},t)},[eR]),eU=(0,g.useCallback)(function(e,t){eR({"background-color":e},t)},[eR]);return(0,K.jsxs)("div",{className:"toolbar",ref:$,children:[(0,K.jsx)(T.Z,{disabled:!X||!eM,disableMinWidth:!0,classes:{root:"toolbar-item"},color:"black",variant:"text","aria-label":"Undo",onClick:function(e){e.preventDefault(),o.dispatchCommand(c.$l,void 0)},children:(0,K.jsx)(x.Z,{classes:{root:"format undo"}})}),(0,K.jsx)(T.Z,{disabled:!en||!eM,disableMinWidth:!0,classes:{root:"toolbar-item"},color:"black",variant:"text","aria-label":"Redo",onClick:function(e){e.preventDefault(),o.dispatchCommand(c.zq,void 0)},children:(0,K.jsx)(v.Z,{classes:{root:"format redo"}})}),(0,K.jsx)(ep,{}),(0,K.jsx)(T.Z,{disableMinWidth:!0,classes:{root:"toolbar-item spaced "+(em?"active":"")},color:"black",variant:"text","aria-label":"Format Bold",onClick:function(e){e.preventDefault(),o.dispatchCommand(c.Ew,"bold")},children:(0,K.jsx)(b.Z,{classes:{root:"format bold"}})}),(0,K.jsx)(T.Z,{disableMinWidth:!0,classes:{root:"toolbar-item spaced "+(ex?"active":"")},color:"black",variant:"text","aria-label":"Format Italics",onClick:function(e){e.preventDefault(),o.dispatchCommand(c.Ew,"italic")},children:(0,K.jsx)(y.Z,{classes:{root:"format italic"}})}),(0,K.jsx)(T.Z,{disableMinWidth:!0,classes:{root:"toolbar-item spaced "+(ey?"active":"")},color:"black",variant:"text","aria-label":"Format Underline",onClick:function(e){e.preventDefault(),o.dispatchCommand(c.Ew,"underline")},children:(0,K.jsx)(j.Z,{classes:{root:"format underline"}})}),(0,K.jsx)(T.Z,{disableMinWidth:!0,classes:{root:"toolbar-item spaced "+(eZ?"active":"")},color:"black",variant:"text","aria-label":"Format Strikethrough",onClick:function(e){e.preventDefault(),o.dispatchCommand(c.Ew,"strikethrough")},children:(0,K.jsx)(w.Z,{classes:{root:"format strikethrough"}})}),(0,K.jsx)(ep,{}),(0,K.jsx)(T.Z,{disableMinWidth:!0,classes:{root:"toolbar-item spaced"},color:"black",variant:"text","aria-label":"Left Align",onClick:function(e){e.preventDefault(),o.dispatchCommand(c.RO,"left")},children:(0,K.jsx)(Z.Z,{classes:{root:"format left-align"}})}),(0,K.jsx)(T.Z,{disableMinWidth:!0,classes:{root:"toolbar-item spaced"},color:"black",variant:"text","aria-label":"Center Align",onClick:function(e){e.preventDefault(),o.dispatchCommand(c.RO,"center")},children:(0,K.jsx)(k.Z,{classes:{root:"format center-align"}})}),(0,K.jsx)(T.Z,{disableMinWidth:!0,classes:{root:"toolbar-item spaced"},color:"black",variant:"text","aria-label":"Right Align",onClick:function(e){e.preventDefault(),o.dispatchCommand(c.RO,"right")},children:(0,K.jsx)(O.Z,{classes:{root:"format right-align"}})}),(0,K.jsx)(T.Z,{disableMinWidth:!0,classes:{root:"toolbar-item spaced"},color:"black",variant:"text","aria-label":"Justify Align",onClick:function(e){e.preventDefault(),o.dispatchCommand(c.RO,"justify")},children:(0,K.jsx)(C.Z,{classes:{root:"format justify-align"}})}),(0,K.jsx)(T.Z,{disableMinWidth:!0,classes:{root:"toolbar-item spaced "+(eo?"active":"")},color:"black",variant:"text","aria-label":"Insert code block",onClick:function(e){e.preventDefault(),o.dispatchCommand(c.Ew,"code")},children:(0,K.jsx)(S.Z,{classes:{root:"format code"}})}),(0,K.jsx)(T.Z,{disableMinWidth:!0,classes:{root:"toolbar-item spaced "+(el?"active":"")},color:"black",variant:"text","aria-label":"Insert link",onClick:ez,children:(0,K.jsx)(P.Z,{classes:{root:"format link"}})}),(0,K.jsx)(L.q3,{type:"font",buttonClassName:"toolbar-item color-picker",buttonIconClassName:"icon font-color",disabled:!eM,color:B,onChange:eN}),(0,K.jsx)(L.q3,{type:"background",buttonClassName:"toolbar-item color-picker",buttonIconClassName:"icon bg-color",disabled:!eM,color:V,onChange:eU}),(0,K.jsx)(N.Z,{label:"Insert",buttonClassName:"toolbar-item insert-action",children:(0,K.jsxs)(z.Z,{disableRipple:!0,onClick:function(){eE({content:function(e){var t=e.onClose;return(0,K.jsx)(es,{activeEditor:o,onClose:t})}})},children:[(0,K.jsx)(_.Z,{}),"Image"]})}),eI]})}ef.defaultProps={setIsLinkEditMode:function(){}};var em=n(58385);function eh(){return(0,K.jsx)(em.H,{validateUrl:M})}var eg=n(82262),ex=n(92777),ev=n(45959),eb=n(72179),ey=n(37247),ej=n(26984),ew=n(30852),eZ=n(97212),ek=n(98619),eO=n(18987),eC=n(69661),eS=n(59334),eP=n(16143),e_=n(78462),eD=n(17896),eI="\\.,\\+\\*\\?\\$\\@\\|#{}\\(\\)\\^\\-\\[\\]\\\\/!%'\"~=<>_:;",eE="[^@"+eI+"\\s]",eA=RegExp("(^|\\s|\\()([@]((?:"+eE+"(?:\\.[ |$]| |["+eI+"]|)){0,75}))$"),eM=RegExp("(^|\\s|\\()([@]((?:"+eE+"){0,50}))$"),eL=function(e){(0,ev.Z)(i,e);var t,n,r=(n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=(0,ey.Z)(i);if(n){var r=(0,ey.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,eb.Z)(this,e)});function i(e,t){var n;return(0,ex.Z)(this,i),(n=r.call(this,e)).label=e,n.value=t,n}return(0,eg.Z)(i)}(ej.n);function eT(e){var t=e.index,n=e.isSelected,r=e.onClick,i=e.onMouseEnter,o=e.option,a="item";return n&&(a+=" selected"),(0,K.jsx)(eZ.ZP,{classes:{root:a},id:"typeahead-item-"+t,disablePadding:!0,onMouseEnter:i,onClick:r,children:(0,K.jsxs)(ek.Z,{children:[(0,K.jsx)(eO.Z,{children:(0,K.jsx)(eC.Z,{alt:o.label})}),(0,K.jsx)(eS.Z,{primary:"".concat(o.label)})]})},o.key)}function ez(){var e=(0,s.g)(),t=(0,a.Z)(e,1)[0],n=(0,eD.i)(),r=n.setMentionSearch,i=n.mentions,o=(0,g.useState)(""),c=o[0],l=o[1];(0,g.useEffect)(function(){var e=setTimeout(function(){r(c)},500);return function(){return clearTimeout(e)}},[c]);var u=(0,ej.wd)("/",{minLength:0}),d=(0,g.useMemo)(function(){return i.map(function(e){return new eL(e.label,e.value)})},[i]),p=(0,g.useCallback)(function(e,n,r){t.update(function(){var t=(0,ew.IY)({trigger:"@",label:e.label,value:e.value});n&&n.replace(t),t.select(),r()})},[t]),f=(0,g.useCallback)(function(e){var n;return null!==u(e,t)?null:function(e,t){var n=eA.exec(e);if(null===n&&(n=eM.exec(e)),null!==n){var r=n[1],i=n[3];if(i.length>=0)return{leadOffset:n.index+r.length,matchingString:i,replaceableString:n[2]}}return null}(e,0)},[u,t]);return(0,K.jsx)(ej.HQ,{anchorClassName:"MuiPopover-root MuiModal-root",onQueryChange:l,onSelectOption:p,triggerFn:f,options:d,menuRenderFn:function(e,t){var n=t.selectedIndex,r=t.selectOptionAndCleanUp,o=t.setHighlightedIndex,a=t.options;return e.current&&i.length?(0,K.jsx)(eP.Z,{open:!0,anchorEl:e.current,placement:"right-start",children:(0,K.jsx)(Q.Z,{sx:{width:"auto",maxHeight:"40vh"},children:(0,K.jsx)(e_.Z,{dense:!0,sx:{width:"100%",maxHeight:"40vh",overflow:"auto",maxWidth:360,bgcolor:"background.paper"},children:a.map(function(e,t){return(0,K.jsx)(eT,{index:t,isSelected:n===t,onClick:function(){o(t),r(e)},onMouseEnter:function(){o(t)},option:e},e.value)})})})}):null}})}ez.defaultProps={};var eR=n(71383),eN=n(70917),eU=function(e){return(0,eN.iv)(i||(i=(0,eR.Z)(["\n  .link-editor {\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 1200;\n    max-width: 400px;\n    width: 100%;\n  }\n"])))},e$=Y.Z.div(o||(o=(0,eR.Z)(["\n  ","\n"])),eU),eW=n(73935);function eq(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5,o=n.parentElement;if(null===e||!o){t.style.opacity="0",t.style.transform="translate(-10000px, -10000px)";return}var a=t.getBoundingClientRect(),s=n.getBoundingClientRect(),c=o.getBoundingClientRect(),l=e.top-r,u=e.left-i;l<c.top&&(l+=a.height+e.height+2*r),u+a.width>c.right&&(u=c.right-a.width-i),l-=s.top,u-=s.left,t.style.opacity="1",t.style.transform="translate(".concat(u,"px, ").concat(l,"px)")}var eB=n(93946),eF=n(21386),eH=n(85412),eV=n(12282),eQ=n(9164);function eG(e){var t=e.editor,n=e.isLink,r=e.setIsLink,i=e.anchorElem,o=e.isLinkEditMode,a=e.setIsLinkEditMode,s=(0,g.useRef)(null),u=(0,g.useRef)(null),d=(0,g.useState)(""),f=d[0],m=d[1],h=(0,g.useState)("https://"),x=h[0],v=h[1],b=(0,g.useState)(null),y=b[0],j=b[1],w=(0,g.useCallback)(function(){var e=(0,c.dL)();if((0,c.OP)(e)){var n=D(e),r=(0,p.$s)(n,l.Pq);r?m(r.getURL()):(0,l.Pq)(n)?m(n.getURL()):m(""),o&&v(f)}var u=s.current,d=window.getSelection(),h=document.activeElement;if(null!==u){var g=t.getRootElement();if(null!==e&&null!==d&&null!==g&&g.contains(d.anchorNode)&&t.isEditable()){var x,b,y=null===(x=d.focusNode)||void 0===x?void 0:null===(b=x.parentElement)||void 0===b?void 0:b.getBoundingClientRect();y&&(y.y+=40,eq(y,u,i)),j(e)}else h&&"link-input"===h.className||(null!==g&&eq(null,u,i),j(null),a(!1),m(""));return!0}},[i,t,a,o,f]);(0,g.useEffect)(function(){var e=i.parentElement,n=function(){t.getEditorState().read(function(){w()})};return window.addEventListener("resize",n),e&&e.addEventListener("scroll",n),function(){window.removeEventListener("resize",n),e&&e.removeEventListener("scroll",n)}},[i.parentElement,t,w]),(0,g.useEffect)(function(){return(0,p.qV)(t.registerUpdateListener(function(e){e.editorState.read(function(){w()})}),t.registerCommand(c.oj,function(){return w(),!0},c.KB),t.registerCommand(c.Zq,function(){return!!n&&(r(!1),!0)},c.Eo))},[t,w,r,n]),(0,g.useEffect)(function(){t.getEditorState().read(function(){w()})},[t,w]),(0,g.useEffect)(function(){o&&u.current&&u.current.focus()},[o,n]);var Z=function(e){"Enter"===e.key?(e.preventDefault(),k()):"Escape"===e.key&&(e.preventDefault(),a(!1))},k=function(){null!==y&&(""!==f&&(t.dispatchCommand(l.k0,E(x)),t.update(function(){var e=(0,c.dL)();if((0,c.OP)(e)){var t=D(e).getParent();if((0,l.Xp)(t)){var n=(0,l.zV)(t.getURL(),{rel:t.__rel,target:t.__target,title:t.__title});t.replace(n,!0)}}})),v("https://"),a(!1))};return(0,K.jsx)(e$,{children:(0,K.jsx)("div",{ref:s,className:"link-editor",children:n?o?(0,K.jsx)(Q.Z,{elevation:3,sx:{p:2},children:(0,K.jsxs)(H.Z,{width:"100%",direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,K.jsx)(V.Z,{fullWidth:!0,color:"secondary",inputRef:u,value:x,onChange:function(e){v(e.target.value)},onKeyDown:function(e){Z(e)}}),(0,K.jsxs)(H.Z,{direction:"row",spacing:1,children:[(0,K.jsx)(eB.Z,{onClick:function(){a(!1)},children:(0,K.jsx)(eH.Z,{})}),(0,K.jsx)(eB.Z,{onClick:k,children:(0,K.jsx)(eF.Z,{})})]})]})}):(0,K.jsx)(Q.Z,{elevation:3,sx:{p:2},children:(0,K.jsxs)(H.Z,{width:"100%",direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,K.jsx)(eQ.r,{color:"secondary",href:E(f),children:f}),(0,K.jsxs)(H.Z,{direction:"row",spacing:1,children:[(0,K.jsx)(eB.Z,{onMouseDown:function(e){return e.preventDefault()},onClick:function(){v(f),a(!0)},children:(0,K.jsx)(eV.Z,{})}),(0,K.jsx)(eB.Z,{onMouseDown:function(e){return e.preventDefault()},onClick:function(){t.dispatchCommand(l.k0,null)},children:(0,K.jsx)(eH.Z,{})})]})]})}):null})})}function eY(e){var t,n,r,i,o,u,d,f,m,h,x=e.anchorElem,v=void 0===x?document.body:x,b=e.isLinkEditMode,y=e.setIsLinkEditMode,j=(0,s.g)();return t=(0,a.Z)(j,1)[0],u=(o=(0,g.useState)(t))[0],d=o[1],m=(f=(0,g.useState)(!1))[0],h=f[1],(0,g.useEffect)(function(){function e(){var e=(0,c.dL)();if((0,c.OP)(e)){var t=D(e),n=(0,p.$s)(t,l.Pq),r=(0,p.$s)(t,l.Xp);if(!(n||r)){h(!1);return}e.getNodes().find(function(e){var t=(0,p.$s)(e,l.Pq),i=(0,p.$s)(e,l.Xp);if(!(null!=t&&t.is(n))&&!(null!=i&&i.is(r))&&!t&&!i&&!(0,c.A3)(e))return e})?h(!1):h(!0)}}return(0,p.qV)(t.registerUpdateListener(function(t){t.editorState.read(function(){e()})}),t.registerCommand(c.oj,function(t,n){return e(),d(n),!1},c.jw),t.registerCommand(c.Kr,function(e){var t=(0,c.dL)();if((0,c.OP)(t)){var n=D(t),r=(0,p.$s)(n,l.Pq);if((0,l.Pq)(r)&&(e.metaKey||e.ctrlKey))return window.open(r.getURL(),"_blank"),!0}return!1},c.KB))},[t]),(0,eW.createPortal)((0,K.jsx)(eG,{editor:u,isLink:m,anchorElem:v,setIsLink:h,isLinkEditMode:b,setIsLinkEditMode:y}),v)}var eK=n(21023),eJ=n(98456),eX=n(24339),e0=n(70573),e1=n(49088);function e2(e,t){for(var n=e.split(","),r=n[0].match(/:(.*?);/)[1],i=atob(n[n.length-1]),o=i.length,a=new Uint8Array(o);o--;)a[o]=i.charCodeAt(o);return new File([a],t,{type:r})}function e5(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var e6=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=[];return!function e(i){if(i.type===t&&(Object.keys(n).find(function(e){return n[e]===i[e]})||r.push(i)),Array.isArray(i.children)){var o,a=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return e5(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e5(e,t)}}(e))){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(i.children);try{for(a.s();!(o=a.n()).done;){var s=o.value;e(s)}}catch(c){a.e(c)}finally{a.f()}}}(e),r};function e8(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function e3(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var e7=function(e){var t=e.json,n=e.type,r=e.to,i=e.keys,o=e.avoidKeyValues,a=void 0===o?{}:o,s=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?e3(Object(n),!0).forEach(function(t){(0,U.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):e3(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t);return!function e(t){if(t.type===n){var o=Object.keys(i);Object.keys(a).find(function(e){return a[e]===t[e]})||o.forEach(function(e){var n=r.shift();t[e]=n[i[e]]})}if(Array.isArray(t.children)){var s,c=function(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return e8(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e8(e,t)}}(e))){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}(t.children);try{for(c.s();!(s=c.n()).done;){var l=s.value;e(l)}}catch(u){c.e(u)}finally{c.f()}}}(s.editorState.root),s};function e4(e){var t=e.saveContent,n=e.loading,r=e.setLoading,i=(0,s.g)(),o=(0,a.Z)(i,1)[0],l=(0,g.useCallback)(function(e){o.getEditorState().read((0,$.Z)(B().mark(function e(){var n,i,a,s,l,u,d,p,f,m;return B().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r(!0),n=(0,c.Gv)(),i=(0,c.K8)(ew.AV),a=n.getTextContent(),s=(0,e0.S)(o,null),l=o.toJSON(),u=i.map(function(e){return e.__value}),p=e6(l.editorState.root,"image",{isLink:!0}).map(function(e){return e2(e.src,e.altText)}),e.next=12,Promise.all(p.map(function(){var e=(0,$.Z)(B().mark(function e(t){return B().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,(0,e1.V)(t,"image");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 12:return m=e7({json:l,type:"image",to:e.sent,keys:{src:"key"},avoidKeyValues:{isLink:!0}}),e.next=16,t({json:m,plainText:a,htmlString:s,mentions:u});case 16:o.dispatchCommand(c.BM,void 0);case 17:return e.prev=17,r(!1),e.finish(17);case 20:case"end":return e.stop()}},e,null,[[0,,17,20]])})))},[o]),u=(0,g.useCallback)(function(e){var t=e.ctrlKey,n=e.metaKey;return(t||n)&&(e.preventDefault(),l(e)),!0},[o]);return(0,g.useEffect)(function(){return(0,p.qV)(o.registerCommand(c.XN,u,c.Eo))},[o,u]),(0,K.jsx)(eK.Z,{title:"Ctrl or CMD + Enter",children:(0,K.jsx)(T.Z,{disableMinWidth:!0,disabled:n,color:"success",variant:"contained",sx:{width:"50px"},onClick:l,children:n?(0,K.jsx)(eJ.Z,{color:"success",size:18}):(0,K.jsx)(eX.Z,{})})})}function e9(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return te(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return te(e,t)}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function te(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function tt(){var e=(0,s.g)(),t=(0,a.Z)(e,1)[0];return(0,g.useEffect)(function(){return t.registerCommand(u.BD,function(e){return(0,$.Z)(B().mark(function n(){var r,i,o,a,s,c;return B().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,(0,p.j5)(e,[en].flatMap(function(e){return e}));case 2:i=e9(n.sent);try{for(i.s();!(o=i.n()).done;)s=(a=o.value).file,c=a.result,(0,p.tV)(s,en)&&t.dispatchCommand(er,{altText:s.name,src:c})}catch(r){i.e(r)}finally{i.f()}case 5:case"end":return n.stop()}},n)}))(),!0},c.KB)},[t]),null}e4.defaultProps={loading:!1,setLoading:function(){},saveContent:(r=(0,$.Z)(B().mark(function e(){return B().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)})),function(){return r.apply(this,arguments)})};var tn=n(25464),tr=n(15861),ti=n(90948),to=n(56693),ta=n(8821),ts=n(62665),tc=function(e){var t=e.loading,n=e.attachments,r=e.description,i=e.setDescription,o=e.handleSubmit;return(0,K.jsx)(Q.Z,{sx:{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"80vw",maxHeight:"90vh",overflowY:"scroll"},children:(0,K.jsxs)(H.Z,{width:"100%",alignItems:"center",p:2,children:[n&&n.map(function(e){return(0,K.jsx)(L.G5,{file:e},e.lastModified)}),!!n.length&&(0,K.jsxs)(H.Z,{width:"100%",spacing:1,children:[(0,K.jsx)(V.Z,{value:r,onChange:function(e){return i(e.target.value)},label:"Add a caption",multiline:!0,minRows:4,variant:"filled",color:"secondary",sx:{width:"100%"}}),(0,K.jsx)(T.Z,{disabled:t,variant:"contained",color:"secondary",onClick:o,children:t?(0,K.jsx)(eJ.Z,{color:"secondary"}):"Send"})]})]})})};function tl(e){var t,n=e.loading,r=e.setLoading,i=e.saveContent,o=(0,R.d)(),s=(0,a.Z)(o,2),c=s[0],l=s[1],u=(0,g.useState)(null),d=u[0],p=u[1],f=(0,g.useState)(""),m=f[0],h=f[1],x=(0,g.useState)([]),v=x[0],b=x[1],y=(0,g.useCallback)((t=(0,$.Z)(B().mark(function e(t){return B().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r(!0),e.next=4,i({description:m,attachments:v});case 4:return e.prev=4,r(!1),e.finish(4);case 7:case"end":return e.stop()}},e,null,[[0,,4,7]])})),function(e){return t.apply(this,arguments)}),[r,i,v,m]);(0,g.useEffect)(function(){v.length&&(p(null),l({content:function(e){var t=e.onClose;return(0,K.jsx)(tc,{loading:n,attachments:v,description:m,setDescription:h,handleSubmit:(0,$.Z)(B().mark(function e(){return B().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:t();case 3:case"end":return e.stop()}},e)}))})}}))},[v,n,m,p,l,h,y]);var j=(0,g.useCallback)(function(e){var t=e.target.files;b((0,W.Z)(t))},[b]),w=Boolean(d);return(0,K.jsxs)(K.Fragment,{children:[(0,K.jsx)(eB.Z,{disabled:n,onClick:function(e){return p(e.currentTarget)},children:(0,K.jsx)(ta.Z,{})}),(0,K.jsxs)(tn.Z,{open:w,id:w?"AttachmentPopUp-popover":void 0,anchorEl:d,onClose:function(){return p(null)},children:[(0,K.jsxs)(z.Z,{component:"label",children:[(0,K.jsxs)(H.Z,{direction:"row",alignItems:"center",spacing:2,children:[(0,K.jsx)(to.Z,{}),(0,K.jsx)(tr.Z,{children:" Upload image"})]}),(0,K.jsx)(tu,{onChange:j,type:"file",accept:"image/*",multiple:!0})]}),(0,K.jsxs)(z.Z,{component:"label",children:[(0,K.jsxs)(H.Z,{direction:"row",alignItems:"center",spacing:2,children:[(0,K.jsx)(ts.Z,{}),(0,K.jsx)(tr.Z,{children:" Upload PDF"})]}),(0,K.jsx)(tu,{onChange:j,type:"file",accept:".pdf",multiple:!0})]})]}),c]})}tc.defaultProps={loading:!1,attachments:[],description:"",setDescription:function(){},handleSubmit:function(){}},tl.defaultProps={loading:!1,setLoading:function(){},saveContent:function(){}};var tu=(0,ti.ZP)("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1}),td=n(70686);function tp(){var e=(0,s.g)(),t=(0,a.Z)(e,1)[0];return(0,K.jsx)(td.L,{viewClassName:"tree-view-output",treeTypeButtonClassName:"debug-treetype-button",timeTravelPanelClassName:"debug-timetravel-panel",timeTravelButtonClassName:"debug-timetravel-button",timeTravelPanelSliderClassName:"debug-timetravel-panel-slider",timeTravelPanelButtonClassName:"debug-timetravel-panel-button",editor:t})}var tf=n(18360),tm=n(2362);function th(){var e=(0,tm.H)();if(!e)return(0,K.jsx)("div",{});var t=e.audienceOptions,n=e.audience,r=e.setAudience;return(0,K.jsx)("div",{className:"audience-plugin",children:(0,K.jsx)(tf.Z,{classes:{select:"select",icon:"icon"},MenuProps:{classes:{root:"test"}},value:n,label:"To",variant:"filled",color:"secondary",onChange:function(e){return r(e.target.value)},children:t.map(function(e){var t=e.value,n=e.label;return(0,K.jsx)(z.Z,{value:t,children:n})})})})}th.defaultProps={}},53267:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(11057),i=n(25464),o=n(67294),a=n(6103),s=n(71496),c=n(85893);function l(e){var t=e.label,n=e.buttonClassName,l=e.children,u=(0,o.useState)(null),d=u[0],p=u[1],f=Boolean(d),m=function(e){p(e.currentTarget)},h=function(){p(null)};return(0,c.jsxs)("div",{children:[(0,c.jsx)(r.Z,{classes:{root:n},id:"drop-down-customized-button","aria-controls":f?"drop-down-customized-menu":void 0,"aria-haspopup":"true","aria-expanded":f?"true":void 0,variant:"text",color:"black",disableElevation:!0,onClick:m,startIcon:(0,c.jsx)(a.Z,{}),endIcon:(0,c.jsx)(s.Z,{}),children:t}),(0,c.jsx)(i.Z,{id:"drop-down-customized-menu",MenuListProps:{"aria-labelledby":"drop-down-customized-button"},anchorEl:d,open:f,onClose:h,children:(0,c.jsx)("div",{onClick:h,children:l})})]})}},81934:function(e,t,n){n.d(t,{Z:function(){return c}});var r=n(18824),i=n(67294),o=n(85893);function a(e,t,n){return Math.min(Math.max(e,t),n)}var s={east:1,north:8,south:2,west:4};function c(e){var t=e.onResizeStart,n=e.onResizeEnd,c=e.buttonRef,l=e.imageRef,u=e.maxWidth,d=e.editor,p=e.showCaption,f=e.setShowCaption,m=e.captionsEnabled,h=(0,i.useRef)(null),g=(0,i.useRef)({priority:"",value:"default"}),x=(0,i.useRef)({currentHeight:0,currentWidth:0,direction:0,isResizing:!1,ratio:0,startHeight:0,startWidth:0,startX:0,startY:0}),v=d.getRootElement(),b=u||(null!==v?v.getBoundingClientRect().width-20:100),y=null!==v?v.getBoundingClientRect().height-20:100,j=function(e){var t=e===s.east||e===s.west,n=e===s.north||e===s.south,r=e&s.north&&e&s.west||e&s.south&&e&s.east,i=t?"ew":n?"ns":r?"nwse":"nesw";null!==v&&v.style.setProperty("cursor","".concat(i,"-resize"),"important"),null!==document.body&&(document.body.style.setProperty("cursor","".concat(i,"-resize"),"important"),g.current.value=document.body.style.getPropertyValue("-webkit-user-select"),g.current.priority=document.body.style.getPropertyPriority("-webkit-user-select"),document.body.style.setProperty("-webkit-user-select","none","important"))},w=function(){null!==v&&v.style.setProperty("cursor","text"),null!==document.body&&(document.body.style.setProperty("cursor","default"),document.body.style.setProperty("-webkit-user-select",g.current.value,g.current.priority))},Z=function(e,n){if(d.isEditable()){var i=l.current,o=h.current;if(null!==i&&null!==o){e.preventDefault();var a=i.getBoundingClientRect(),s=a.width,c=a.height,u=(0,r.MZ)(i),p=x.current;p.startWidth=s,p.startHeight=c,p.ratio=s/c,p.currentWidth=s,p.currentHeight=c,p.startX=e.clientX/u,p.startY=e.clientY/u,p.isResizing=!0,p.direction=n,j(n),t(),o.classList.add("image-control-wrapper--resizing"),i.style.height="".concat(c,"px"),i.style.width="".concat(s,"px"),document.addEventListener("pointermove",k),document.addEventListener("pointerup",O)}}},k=function(e){var t=l.current,n=x.current,i=n.direction&(s.east|s.west),o=n.direction&(s.south|s.north);if(null!==t&&n.isResizing){var c=(0,r.MZ)(t);if(i&&o){var u=Math.floor(n.startX-e.clientX/c);u=n.direction&s.east?-u:u;var d=a(n.startWidth+u,100,b),p=d/n.ratio;t.style.width="".concat(d,"px"),t.style.height="".concat(p,"px"),n.currentHeight=p,n.currentWidth=d}else if(o){var f=Math.floor(n.startY-e.clientY/c);f=n.direction&s.south?-f:f;var m=a(n.startHeight+f,100,y);t.style.height="".concat(m,"px"),n.currentHeight=m}else{var h=Math.floor(n.startX-e.clientX/c);h=n.direction&s.east?-h:h;var g=a(n.startWidth+h,100,b);t.style.width="".concat(g,"px"),n.currentWidth=g}}},O=function e(){var t=l.current,r=x.current,i=h.current;if(null!==t&&null!==i&&r.isResizing){var o=r.currentWidth,a=r.currentHeight;r.startWidth=0,r.startHeight=0,r.ratio=0,r.startX=0,r.startY=0,r.currentWidth=0,r.currentHeight=0,r.isResizing=!1,i.classList.remove("image-control-wrapper--resizing"),w(),n(o,a),document.removeEventListener("pointermove",k),document.removeEventListener("pointerup",e)}};return(0,o.jsxs)("div",{ref:h,children:[!p&&m&&(0,o.jsx)("button",{className:"image-caption-button",ref:c,onClick:function(){f(!p)},children:"Add Caption"}),(0,o.jsx)("div",{className:"image-resizer image-resizer-n",onPointerDown:function(e){Z(e,s.north)}}),(0,o.jsx)("div",{className:"image-resizer image-resizer-ne",onPointerDown:function(e){Z(e,s.north|s.east)}}),(0,o.jsx)("div",{className:"image-resizer image-resizer-e",onPointerDown:function(e){Z(e,s.east)}}),(0,o.jsx)("div",{className:"image-resizer image-resizer-se",onPointerDown:function(e){Z(e,s.south|s.east)}}),(0,o.jsx)("div",{className:"image-resizer image-resizer-s",onPointerDown:function(e){Z(e,s.south)}}),(0,o.jsx)("div",{className:"image-resizer image-resizer-sw",onPointerDown:function(e){Z(e,s.south|s.west)}}),(0,o.jsx)("div",{className:"image-resizer image-resizer-w",onPointerDown:function(e){Z(e,s.west)}}),(0,o.jsx)("div",{className:"image-resizer image-resizer-nw",onPointerDown:function(e){Z(e,s.north|s.west)}})]})}},92178:function(e,t,n){n.d(t,{f$:function(){return y},q3:function(){return h},G5:function(){return A},Vm:function(){return Z}}),n(53267);var r,i,o,a,s=n(11057),c=n(14564),l=n(67294),u=n(82809),d=n(18560),p=n(40876),f=n(85893),m={font:(0,f.jsx)(u.Z,{}),background:(0,f.jsx)(d.Z,{})};function h(e){var t=e.type,n=e.buttonClassName,r=e.disabled,i=void 0!==r&&r,o=(e.color,e.onChange),a=(0,l.useState)(null),u=a[0],d=a[1],h=(0,l.useRef)(null),g=(0,l.useState)(""),x=g[0],v=g[1],b=Boolean(u),y=b?"simple-popover":void 0;(0,l.useEffect)(function(){b&&null!=h&&h.current&&h.current.click()},[b,null==h?void 0:h.current]),(0,l.useEffect)(function(){var e=setTimeout(function(){o(x)},300);return function(){return clearTimeout(e)}},[x]);var j=function(e){d(e.currentTarget)},w=function(){d(null)};return(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(s.Z,{disableMinWidth:!0,disabled:i,"aria-describedby":y,variant:"text",color:"black",classes:{root:void 0===n?"":n},onClick:j,startIcon:m[void 0===t?"font":t],endIcon:(0,f.jsx)(p.Z,{})}),(0,f.jsx)("input",{ref:h,disabled:i,value:x,onChange:function(e){return v(e.target.value)},type:"color",style:{width:0,height:0,opacity:0,padding:0,border:"none"}}),(0,f.jsx)(c.ZP,{keepMounted:!0,id:y,open:b,anchorEl:u,onClose:w,anchorOrigin:{vertical:"bottom",horizontal:"left"},PaperProps:{sx:{width:0,height:0,minWidth:0,minHeight:0,opacity:0}}})]})}n(81934);var g=n(71383),x=n(16177),v=n(70917),b=n(10166);function y(e){var t=e.className;return(0,f.jsx)(w,{children:(0,f.jsx)(x.f,{className:t||"ContentEditable__root"})})}var j=function(e){return(0,v.iv)(r||(r=(0,g.Z)(["\n  .ContentEditable__root {\n    border: 0;\n    font-size: 15px;\n    display: block;\n    position: relative;\n    outline: 0;\n    padding: 8px 28px 40px;\n    min-height: 150px;\n  }\n  @media (max-width: 1025px) {\n    .ContentEditable__root {\n      padding-left: 8px;\n      padding-right: 8px;\n    }\n  }\n"])))},w=b.Z.div(i||(i=(0,g.Z)(["\n  ","\n"])),j);function Z(e){var t=e.children,n=e.className;return(0,f.jsx)(O,{className:n||"Placeholder__root",children:t})}var k=function(e){return(0,v.iv)(o||(o=(0,g.Z)(["\n  &.Placeholder__root {\n    font-size: 15px;\n    color: #999;\n    overflow: hidden;\n    position: absolute;\n    text-overflow: ellipsis;\n    top: 8px;\n    left: 28px;\n    right: 28px;\n    user-select: none;\n    white-space: nowrap;\n    display: inline-block;\n    pointer-events: none;\n  }\n  @media (max-width: 1025px) {\n    &.Placeholder__root {\n      left: 8px;\n    }\n  }\n"])))},O=b.Z.div(a||(a=(0,g.Z)(["\n  ","\n"])),k),C=n(26447),S=n(15861),P=n(18824),_=n(75323),D=n(17730),I=["image/"],E=["application/pdf"];function A(e){var t=e.file,n=(0,P.tV)(t,I);return(0,P.tV)(t,E)?(0,f.jsxs)(C.Z,{mb:2,width:"100%",direction:"row",alignItems:"center",sx:{p:1,border:"1px solid rgba(0, 0, 0, 0.4)",borderRadius:"5px"},children:[(0,f.jsx)(_.Z,{sx:{color:"red",mr:1}}),(0,f.jsx)(S.Z,{children:t.name})]}):n?(0,f.jsx)(C.Z,{mb:2,flexDirection:"row",children:(0,f.jsx)("img",{style:{width:"100%",borderRadius:"8px",border:"1px solid grey",marginTop:"0.5rem",marginBottom:"0.5rem"},src:URL.createObjectURL(t),alt:t.name})}):(0,f.jsxs)(C.Z,{mb:2,width:"100%",direction:"row",alignItems:"center",sx:{p:1,border:"1px solid rgba(0, 0, 0, 0.4)",borderRadius:"5px"},children:[(0,f.jsx)(D.Z,{sx:{mr:1}}),(0,f.jsx)(S.Z,{children:t.name})]})}},73183:function(e,t,n){n.d(t,{f:function(){return P}});var r=n(59499),i=n(27812),o=n(67294),a=n(26447),s=n(15861),c=n(21023),l=n(93946),u=n(72428),d=n(79665),p=n(90948),f=n(50135),m=n(11057),h=n(42283),g=n(46761),x=n(60092),v=n(74231),b=v.Ry().shape({caption:v.Z_()}),y=n(85893);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Z=(0,p.ZP)(s.Z)({backgroundColor:x.Q.COLOUR.secondary,color:x.Q.COLOUR.white,textAlign:"center",minWidth:"64px",borderRadius:"4px",margin:"10px 0",padding:"4px 10px",boxShadow:"0px 3px 1px -2px rgba(0,0,0,0.2),\n    0px 2px 2px 0px rgba(0,0,0,0.14),\n    0px 1px 5px 0px rgba(0,0,0,0.12)"}),k=(0,p.ZP)("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1}),O=function(e){var t,n=e.noDelete,r=e.onDelete,i=e.isAdded,u=e.media,p=e.caption,v=e.onSave,j=(0,o.useState)(null),O=j[0],C=j[1],S=(0,o.useState)(""),P=S[0],_=S[1],D=(0,o.useState)(i),I=D[0],E=D[1],A=(0,h.cI)({resolver:(0,d.S)(b)}),M=A.register,L=A.errors,T=A.handleSubmit,z=A.reset,R=function(e){e.stopPropagation(),C(null),z()},N=function(e){e.stopPropagation(),E(!1),r()},U=function(e){O&&(v(w(w({},e),{},{media:O,type:P})),E(!1))},$=(0,o.useCallback)(function(e){return function(t){t.stopPropagation();var n=t.target.files[0];_(e),C(n)}},[C]);return(0,y.jsx)("form",{children:I?(0,y.jsx)(a.Z,{children:(0,y.jsxs)(a.Z,{rowGap:2,children:[(0,y.jsx)(f.Z,{fullWidth:!0,label:"Caption",variant:"standard",color:"secondary",name:"caption",inputRef:M,error:L.name,helperText:null===(t=L.name)||void 0===t?void 0:t.message}),O?(0,y.jsxs)(a.Z,{rowGap:3,children:[(0,y.jsxs)(a.Z,{direction:"row",justifyContent:"space-between",alignItems:"center",children:[(0,y.jsx)(s.Z,{sx:{color:x.Q.COLOUR.secondary,fontWeight:600,pointerEvents:"none"},children:O.name}),(0,y.jsx)(c.Z,{title:"Delete",placement:"top-start",children:(0,y.jsx)(l.Z,{size:"small",sx:{":hover":{backgroundColor:"#DDDDDD"}},onClick:R,children:(0,y.jsx)(g.Z,{})})})]}),(0,y.jsxs)(a.Z,{direction:"row",columnGap:3,justifyContent:"flex-end",children:[(0,y.jsx)(m.Z,{variant:"contained",color:"danger",size:"small",onClick:N,children:"Cancel"}),(0,y.jsx)(m.Z,{variant:"contained",size:"small",onClick:T(U),children:"Save"})]})]}):(0,y.jsxs)(a.Z,{direction:"row",columnGap:3,justifyContent:"flex-end",children:[(0,y.jsxs)(Z,{component:"label",children:["Add image\xa0",(0,y.jsx)(k,{onChange:$("image"),type:"file",accept:"image/*, .heic"})]}),(0,y.jsxs)(Z,{component:"label",children:["Add document\xa0",(0,y.jsx)(k,{onChange:$("document"),type:"file",accept:".pdf, .doc, .docx, .xlsx",multiple:!0})]})]})]})}):(0,y.jsxs)(a.Z,{direction:"row",justifyContent:"flex-start",alignItems:"center",spacing:1,children:[(0,y.jsx)(s.Z,{sx:{color:x.Q.COLOUR.secondary,fontWeight:600,pointerEvents:"none"},children:p||(null==u?void 0:u.name)||"No caption"}),!n&&(0,y.jsx)(c.Z,{title:"Delete",placement:"top-start",children:(0,y.jsx)(l.Z,{size:"small",sx:{":hover":{backgroundColor:"#DDDDDD"}},onClick:r,children:(0,y.jsx)(g.Z,{sx:{fontSize:"16px"}})})})]})})};function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function S(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var P=function(e){var t=e.values,n=e.setValue,r=e.name,d=e.title,p=e.onDeleteExistingMedia,f=(0,o.useState)([]),m=f[0],h=f[1];(0,o.useEffect)(function(){Array.isArray(t)&&h(t)},[t]);var g=function(e){e.stopPropagation(),h(function(e){return[].concat((0,i.Z)(e),[{mediaId:null,caption:"",media:null,type:"",isAdded:!0}])})},x=function(e,t){var o=(0,i.Z)(m);o.splice(e,1,t),n(r,o)};return(0,y.jsxs)(a.Z,{children:[(0,y.jsxs)(a.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,y.jsxs)(s.Z,{children:[d,":"]}),(0,y.jsx)(c.Z,{title:"Add new attachment",placement:"top-start",children:(0,y.jsx)(l.Z,{size:"small",sx:{":hover":{backgroundColor:"#DDDDDD"}},onClick:g,children:(0,y.jsx)(u.Z,{})})})]}),(0,y.jsx)(a.Z,{pl:2,spacing:.8,children:null!=m&&m.length?m.map(function(e,t){var i;return(0,y.jsx)(O,S(S({index:t},e),{},{onDelete:function(){p&&m[t].mediaId&&p(m[t].mediaId);var e=m.filter(function(e,n){return n!==t});n(r,e),h(e)},onSave:function(e){return x(t,e)}}),e.caption+t)}):(0,y.jsx)(s.Z,{typography:"subtitle2",children:"No data"})})]})};P.defaultProps={name:"attachments",title:"Attachments"}},78893:function(e,t,n){n.d(t,{b:function(){return ty}});var r,i,o,a,s,c,l,u,d,p,f,m,h,g,x,v,b,y=n(71383),j=n(16835),w=n(27812),Z=n(50029),k=n(59499),O=n(64687),C=n.n(O),S=n(67294),P=n(6812),_=n(50319),D=n(75063),I=(0,D.Ps)(r||(r=(0,y.Z)(['\n  fragment CommunicationFields on Communication {\n    editorState\n    text\n    from\n    icon\n    id\n    more\n    status\n    statusLog\n    to\n    createdAt\n    media: Media(where: { entity: { _eq: "Communication" } }) {\n      id\n      medium: Medium {\n        id\n        category\n        filename\n        meta\n        type\n      }\n    }\n    user: User {\n      id\n      nameFirst\n      email\n    }\n  }\n']))),E=(0,D.Ps)(i||(i=(0,y.Z)(["\n  query getCommunications(\n    $accountId: Int\n    $filter: String\n    $jobId: Int\n    $taskId: Int\n    $text: String_comparison_exp\n    $neqFilter: String\n    $limit: Int\n    $offset: Int\n  ) {\n    communications: Communication(\n      order_by: { id: desc }\n      where: {\n        accountId: { _eq: $accountId }\n        text: $text\n        icon: { _eq: $filter, _neq: $neqFilter }\n        jobId: { _eq: $jobId }\n        taskId: { _eq: $taskId }\n      }\n      limit: $limit\n      offset: $offset\n    ) {\n      ...CommunicationFields\n      __typename\n    }\n  }\n\n  ","\n"])),I),A=(0,D.Ps)(o||(o=(0,y.Z)(['\n  subscription getCommunications(\n    $accountId: Int\n    $filter: String\n    $jobId: Int\n    $taskId: Int\n    $userId: Int\n    $now: timestamptz!\n  ) {\n    communications: Communication(\n      order_by: { createdAt: desc }\n      where: {\n        accountId: { _eq: $accountId }\n        icon: { _eq: $filter }\n        jobId: { _eq: $jobId }\n        taskId: { _eq: $taskId }\n        _or: [{ from: { _eq: "System message" } }, { userId: { _neq: $userId } }]\n        createdAt: { _gte: $now }\n      }\n    ) {\n      ...CommunicationFields\n    }\n  }\n  ',"\n"])),I),M=(0,D.Ps)(a||(a=(0,y.Z)(["\n  mutation AddCommunication($objects: [Communication_insert_input!]!) {\n    insert_Communication(objects: $objects) {\n      returning {\n        ...CommunicationFields\n      }\n    }\n  }\n  ","\n"])),I),L=(0,D.Ps)(s||(s=(0,y.Z)(['\n  query GetAllMentionUser($id: [Int!]!, $q: String, $limit: Int, $offset: Int = 0) {\n    users: User(\n      where: {\n        fullName: { _ilike: $q }\n        Account_Users: {\n          status: { _eq: "active" }\n          isContact: { _eq: true }\n          Account: { id: { _in: $id } }\n        }\n      }\n      limit: $limit\n      offset: $offset\n    ) {\n      id\n      fullName\n      email\n      phone\n      Account_Users {\n        Account {\n          type\n        }\n      }\n    }\n  }\n']))),T=n(30381),z=n.n(T),R=function(e,t,n,r,i){if(e)return{entity:"Communication",status:"active",Medium:{data:{meta:"internal"===i?{adminOnly:!0}:{allUser:!0},adminId:r.adminId,filename:e,extension:t,type:n,userId:r.id}}}},N=n(49088),U=n(60036);function $(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?$(Object(n),!0).forEach(function(t){(0,k.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):$(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var q,B=(q=(0,Z.Z)(C().mark(function e(t){var n,r,i,o,a,s,c,l,u,d,p,f,m,h,g,x,v,b;return C().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=t.form,i=t.scope,o=t.user,a=t.id,s=t.AddCommunication,c=r.audience,l=r.editorState,u=r.text,d=r.mentions,p=null,e.t0=i,e.next="job"===e.t0?6:"task"===e.t0?8:"customer"===e.t0?10:"supplier"===e.t0?10:"admin"===e.t0?10:"property"===e.t0?12:14;break;case 6:return p="jobId",e.abrupt("break",14);case 8:return p="taskId",e.abrupt("break",14);case 10:return p="accountId",e.abrupt("break",14);case 12:return p="locationId",e.abrupt("break",14);case 14:if(p){e.next=16;break}return e.abrupt("return",null);case 16:if(n={},(0,k.Z)(n,p,a),(0,k.Z)(n,"editorState",l),(0,k.Z)(n,"text",u),(0,k.Z)(n,"mentions",d),(0,k.Z)(n,"from","".concat(o.nameFirst," <").concat(o.email,">")),(0,k.Z)(n,"icon","comment"),(0,k.Z)(n,"status","delivered"),(0,k.Z)(n,"to",c),(0,k.Z)(n,"userId",o.id),(0,k.Z)(n,"Media",{data:[]}),f=n,x=[],r.attachments&&r.attachments.length>0)for(v=0;v<r.attachments.length;v++)"application/pdf"===(b=r.attachments[v]).type?(h="document",g="pdf"):b.type.startsWith("image/")&&(h="image",g=b.type.split("/")[1]),x.push((0,N.V)(b,h).then(function(e){if("image"===h){var t=e.key,n=e.data.find(function(e){return"large"===e.name});m=n?n.relativePath:t}else m=e.key;f.Media.data.push(R(m,g,h,o,c))}).catch(function(e){(0,U.Tb)({message:e,section:"upload"})}));Promise.all(x).then(function(e){s({variables:{objects:f}})});case 20:case"end":return e.stop()}},e)})),function(e){return q.apply(this,arguments)}),F=function(e){var t=[],n=null;return e.sort(function(e,t){return new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()}).forEach(function(e){var r=z()(e.createdAt).format("D MMM YYYY");r!==n&&null!==n?(t.push(W(W({},e),{},{isDivider:!0,time:r})),n=r):null===n&&(n=r),t.push(W(W({},e),{},{time:r}))}),t},H=function(e,t){switch(e.accountType){case"customer":var n=null==t?void 0:t.filter(function(e){return"customer"===e.to}),r=null==t?void 0:t.filter(function(e){return"all"===e.to}),i=null==t?void 0:t.filter(function(e){return"admin-customer"===e.to});return[].concat((0,w.Z)(n),(0,w.Z)(r),(0,w.Z)(i));case"supplier":var o=null==t?void 0:t.filter(function(e){return"supplier"===e.to}),a=null==t?void 0:t.filter(function(e){return"all"===e.to}),s=null==t?void 0:t.filter(function(e){return"admin-supplier"===e.to});return[].concat((0,w.Z)(o),(0,w.Z)(a),(0,w.Z)(s));default:return t}},V=function(e){var t=e.accountType;switch(t){case"customer":return[{label:"Internal",value:"customer"},{label:"Include others",value:"admin-customer"}];case"supplier":return[{label:"Internal",value:"supplier"},{label:"Include others",value:"admin-supplier"}];case"admin":return[{label:"Internal",value:"admin"},{label:"All",value:"all"},{label:"Customer Only",value:"admin-customer"},{label:"Supplier Only",value:"admin-supplier"}];default:return[]}},Q=function(e){var t=e.accountType,n=e.adminId,r=e.customerId,i=e.supplierId,o=[];switch(t){case"admin":r&&o.push(r),i&&o.push(i),n&&o.push(n);break;case"customer":r&&o.push(r);break;case"supplier":i&&o.push(i)}return o},G=function(e){var t=e.users,n=e.audience,r=e.accountType,i=e.userId;return t.filter(function(e){var t,i=null===(t=e.Account_Users)||void 0===t?void 0:t.find(function(e){return!!e.Account});if(!i)return!1;switch(n){case"all":return!0;case"admin":return"admin"===i.Account.type;case"admin-customer":if("admin"===r)return"customer"===i.Account.type;return"admin"===i.Account.type||"customer"===i.Account.type;case"admin-supplier":if("admin"===r)return"supplier"===i.Account.type;return"admin"===i.Account.type||"supplier"===i.Account.type;case"customer":return"customer"===i.Account.type;case"supplier":return"supplier"===i.Account.type;default:return!1}}).filter(function(e){return e.id!==i}).map(function(e){return{id:e.id,name:e.fullName,email:e.email,phone:e.phone,value:e.id,label:e.fullName}})},Y=n(5616),K=n(86532),J=n(38895),X=n(15861),ee=n(22797),et=n(26447),en=n(50135),er=n(81458),ei=n(87918),eo=n(70917),ea=n(94054),es=n(47312),ec=n(18360),el=n(18972),eu=n(85893),ed=function(e){var t=e.filter,n=e.setFilter,r=function(e){n("all"===e?null:e)};return(0,eu.jsx)(Y.Z,{sx:{minWidth:120},children:(0,eu.jsxs)(ea.Z,{fullWidth:!0,variant:"standard",color:"secondary",children:[(0,eu.jsx)(es.Z,{children:"Filter"}),(0,eu.jsx)(ec.Z,{value:null===t?"all":t,label:"Filter",color:"secondary",onChange:function(e){return r(e.target.value)},children:["all","email","notification","comment"].map(function(e){var t=e.charAt(0).toUpperCase()+e.slice(1);return(0,eu.jsx)(el.Z,{value:e,color:"secondary",children:t},e)})})]})})},ep=n(89357),ef=n(63786),em=n(68218),eh=n(28635),eg=n(4505),ex=n(92044),ev=void 0!==window.document&&void 0!==window.document.createElement,eb=n(69094),ey=n(92178),ej={disableBeforeInput:!1,emptyEditor:!0,isAutocomplete:!1,isCharLimit:!1,isCharLimitUtf8:!1,isCollab:!1,isMaxLength:!1,isRichText:!0,measureTypingPerf:!1,shouldUseLexicalContextMenu:!1,showNestedEditorTreeView:!1,showTableOfContents:!1,showTreeView:!1,tableCellBackgroundColor:!0,tableCellMerge:!0};function ew(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function eZ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ew(Object(n),!0).forEach(function(t){(0,k.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ew(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ek=(0,S.createContext)({setOption:function(e,t){},settings:ej});function eO(e){var t=e.children,n=(0,S.useState)(ej),r=n[0],i=n[1],o=(0,S.useCallback)(function(e,t){i(function(n){return eZ(eZ({},n),{},(0,k.Z)({},e,t))}),ej[e]===t?eC(e,null):eC(e,t)},[]),a=(0,S.useMemo)(function(){return{setOption:o,settings:r}},[o,r]);return(0,eu.jsx)(ek.Provider,{value:a,children:t})}function eC(e,t){var n=new URL(window.location.href),r=new URLSearchParams(n.search);null!==t?r.has(e)?r.set(e,String(t)):r.append(e,String(t)):r.has(e)&&r.delete(e),n.search=r.toString(),window.history.pushState(null,"",n.toString())}var eS=n(67011),eP=function(e){var t=e.loading,n=e.setLoading,r=e.onSubmit,i=e.onSubmitAttachment,o=(0,eS.V)().historyState,a=(0,S.useContext)(ek).settings.showTreeView,s=(0,ex.Z)(),c=(0,S.useState)(document.body)[0],l=(0,S.useState)(!1),u=l[0],d=l[1],p=(0,S.useState)(!1),f=p[0],m=p[1];return(0,S.useEffect)(function(){var e=function(){var e=ev&&window.matchMedia("(max-width: 1025px)").matches;e!==f&&m(e)};return e(),window.addEventListener("resize",e),function(){window.removeEventListener("resize",e)}},[f]),(0,eu.jsxs)("div",{className:"editor-container",children:[s&&(0,eu.jsx)(eb.Mq,{setIsLinkEditMode:d}),(0,eu.jsxs)("div",{className:"editor-inner",children:[(0,eu.jsx)(em.B,{contentEditable:(0,eu.jsx)(ey.f$,{className:"editor-input"}),placeholder:(0,eu.jsx)(ey.Vm,{className:"editor-placeholder"}),ErrorBoundary:ep.Z}),(0,eu.jsx)(eh.$,{}),(0,eu.jsx)(eg.y,{}),(0,eu.jsx)(ef.e,{externalHistoryState:o}),(0,eu.jsx)(eb.Hi,{}),(0,eu.jsx)(eb.Nz,{}),(0,eu.jsx)(eb.yi,{}),(0,eu.jsx)(eb.Xe,{captionsEnabled:!1}),s&&c&&(0,eu.jsx)(eb.tC,{anchorElem:c,isLinkEditMode:u,setIsLinkEditMode:d})]}),s&&(0,eu.jsxs)("div",{className:"editor-footer",children:[(0,eu.jsx)(eb.Ps,{}),(0,eu.jsxs)("div",{children:[(0,eu.jsx)(eb.WL,{loading:t,setLoading:n,saveContent:i}),(0,eu.jsx)(eb.DE,{loading:t,setLoading:n,saveContent:r})]})]}),a&&(0,eu.jsx)(eb.xt,{})]})};eP.defaultProps={loading:!1,onSubmit:function(){},onSubmitAttachment:function(){}};var e_=n(4730),eD=n(10166),eI=["customStyles"];function eE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function eA(e){var t=e.customStyles,n=(0,e_.Z)(e,eI),r=eD.Z.div(c||(c=(0,y.Z)(["\n    ","\n    ","\n  "])),eL,t);return(0,eu.jsx)(r,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eE(Object(n),!0).forEach(function(t){(0,k.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eE(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},n))}eA.defaultProps={customStyles:""};var eM,eL=function(e){return(0,eo.iv)(l||(l=(0,y.Z)(["\n  .editor-container {\n    font-family: Nunito-Regular;\n    width: 100%;\n    border-radius: 10px;\n    color: #000;\n    background: rgba(0, 0, 0, 0.06);\n    position: relative;\n    line-height: 20px;\n    font-weight: 400;\n    text-align: left;\n  }\n\n  .ltr {\n    text-align: left;\n  }\n\n  .rtl {\n    text-align: right;\n  }\n\n  .editor-inner {\n    position: relative;\n  }\n\n  .editor-input {\n    min-height: 150px;\n    resize: none;\n    font-size: 15px;\n    caret-color: rgb(5, 5, 5);\n    position: relative;\n    tab-size: 1;\n    outline: 0;\n    padding: 15px 10px;\n    caret-color: #444;\n  }\n\n  .editor-placeholder {\n    color: #999;\n    overflow: hidden;\n    position: absolute;\n    text-overflow: ellipsis;\n    top: 15px;\n    left: 10px;\n    font-size: 15px;\n    user-select: none;\n    display: inline-block;\n    pointer-events: none;\n  }\n\n  .editor-text-bold {\n    font-weight: bold;\n  }\n\n  .editor-text-italic {\n    font-style: italic;\n  }\n\n  .editor-text-underline {\n    text-decoration: underline;\n  }\n\n  .editor-text-strikethrough {\n    text-decoration: line-through;\n  }\n\n  .editor-text-underlineStrikethrough {\n    text-decoration: underline line-through;\n  }\n\n  .editor-text-code {\n    background-color: rgba(0, 0, 0, 0.1);\n    padding: 1px 0.25rem;\n    font-family: Menlo, Consolas, Monaco, monospace;\n    font-size: 94%;\n  }\n\n  .editor-link {\n    color: rgb(33, 111, 219);\n    text-decoration: none;\n  }\n\n  .editor-text-mention {\n    border-radius: 5px;\n    padding: 0 5px;\n    background-color: #faae20;\n  }\n\n  .tree-view-output {\n    display: block;\n    background: #222;\n    color: #fff;\n    padding: 5px;\n    font-size: 12px;\n    white-space: pre-wrap;\n    margin: 1px auto 10px auto;\n    max-height: 250px;\n    position: relative;\n    border-bottom-left-radius: 10px;\n    border-bottom-right-radius: 10px;\n    overflow: auto;\n    line-height: 14px;\n  }\n\n  .editor-code {\n    background-color: rgb(240, 242, 245);\n    font-family: Menlo, Consolas, Monaco, monospace;\n    display: block;\n    padding: 8px 8px 8px 52px;\n    line-height: 1.53;\n    font-size: 13px;\n    margin: 0;\n    margin-top: 8px;\n    margin-bottom: 8px;\n    tab-size: 2;\n    /* white-space: pre; */\n    overflow-x: auto;\n    position: relative;\n  }\n\n  .editor-code:before {\n    content: attr(data-gutter);\n    position: absolute;\n    background-color: #eee;\n    left: 0;\n    top: 0;\n    border-right: 1px solid #ccc;\n    padding: 8px;\n    color: #777;\n    white-space: pre-wrap;\n    text-align: right;\n    min-width: 25px;\n  }\n  .editor-code:after {\n    content: attr(data-highlight-language);\n    top: 0;\n    right: 3px;\n    padding: 3px;\n    font-size: 10px;\n    text-transform: uppercase;\n    position: absolute;\n    color: rgba(0, 0, 0, 0.5);\n  }\n\n  .editor-tokenComment {\n    color: slategray;\n  }\n\n  .editor-tokenPunctuation {\n    color: #999;\n  }\n\n  .editor-tokenProperty {\n    color: #905;\n  }\n\n  .editor-tokenSelector {\n    color: #690;\n  }\n\n  .editor-tokenOperator {\n    color: #9a6e3a;\n  }\n\n  .editor-tokenAttr {\n    color: #07a;\n  }\n\n  .editor-tokenVariable {\n    color: #e90;\n  }\n\n  .editor-tokenFunction {\n    color: #dd4a68;\n  }\n\n  .editor-paragraph {\n    margin: 0;\n    margin-bottom: 8px;\n    position: relative;\n  }\n\n  .editor-paragraph:last-child {\n    margin-bottom: 0;\n  }\n\n  .editor-heading-h1 {\n    font-size: 24px;\n    color: rgb(5, 5, 5);\n    font-weight: 400;\n    margin: 0;\n    margin-bottom: 12px;\n    padding: 0;\n  }\n\n  .editor-heading-h2 {\n    font-size: 15px;\n    color: rgb(101, 103, 107);\n    font-weight: 700;\n    margin: 0;\n    margin-top: 10px;\n    padding: 0;\n    text-transform: uppercase;\n  }\n\n  .editor-quote {\n    margin: 0;\n    margin-left: 20px;\n    font-size: 15px;\n    color: rgb(101, 103, 107);\n    border-left-color: rgb(206, 208, 212);\n    border-left-width: 4px;\n    border-left-style: solid;\n    padding-left: 16px;\n  }\n\n  .editor-list-ol {\n    padding: 0;\n    margin: 0;\n    margin-left: 16px;\n  }\n\n  .editor-list-ul {\n    padding: 0;\n    margin: 0;\n    margin-left: 16px;\n  }\n\n  .editor-listitem {\n    margin: 8px 32px 8px 32px;\n  }\n\n  .editor-nested-listitem {\n    list-style-type: none;\n  }\n\n  .editor-text-bgcolor {\n    border-radius: 5px;\n    padding: 0 5px;\n  }\n\n  pre::-webkit-scrollbar {\n    background: transparent;\n    width: 10px;\n  }\n\n  pre::-webkit-scrollbar-thumb {\n    background: #999;\n  }\n\n  .debug-timetravel-panel {\n    overflow: hidden;\n    padding: 0 0 10px 0;\n    margin: auto;\n    display: flex;\n  }\n\n  .debug-timetravel-panel-slider {\n    padding: 0;\n    flex: 8;\n  }\n\n  .debug-timetravel-panel-button {\n    padding: 0;\n    border: 0;\n    background: none;\n    flex: 1;\n    color: #fff;\n    font-size: 12px;\n  }\n\n  .debug-timetravel-panel-button:hover {\n    text-decoration: underline;\n  }\n\n  .debug-timetravel-button {\n    border: 0;\n    padding: 0;\n    font-size: 12px;\n    top: 10px;\n    right: 15px;\n    position: absolute;\n    background: none;\n    color: #fff;\n  }\n\n  .debug-timetravel-button:hover {\n    text-decoration: underline;\n  }\n\n  .toolbar {\n    display: flex;\n    margin-bottom: 1px;\n    padding: 4px;\n    border-top-left-radius: 10px;\n    border-top-right-radius: 10px;\n    vertical-align: middle;\n    overflow-x: scroll;\n  }\n\n  .toolbar::-webkit-scrollbar {\n    width: 10px;\n    height: 5px;\n  }\n\n  .toolbar button.toolbar-item {\n    border: 0;\n    display: flex;\n    background: none;\n    border-radius: 10px;\n    padding: 8px;\n    cursor: pointer;\n    vertical-align: middle;\n  }\n\n  .toolbar button.toolbar-item:disabled {\n    cursor: not-allowed;\n  }\n\n  .toolbar button.toolbar-item.spaced {\n    margin-right: 2px;\n  }\n\n  .toolbar button.toolbar-item svg.MuiSvgIcon-root.format {\n    background-size: contain;\n    display: inline-block;\n    // height: 18px;\n    // width: 18px;\n    margin-top: 2px;\n    vertical-align: -0.25em;\n    display: flex;\n    opacity: 0.6;\n  }\n\n  .toolbar button.toolbar-item:disabled svg.MuiSvgIcon-root.format {\n    opacity: 0.2;\n  }\n\n  .toolbar button.toolbar-item.active {\n    background-color: rgba(0, 0, 0, 0.1);\n  }\n\n  .toolbar button.toolbar-item.active svg {\n    opacity: 1;\n  }\n\n  .toolbar .toolbar-item:hover:not([disabled]) {\n    background-color: rgba(0, 0, 0, 0.1);\n  }\n\n  .toolbar .divider {\n    width: 1px;\n    min-width: 1px;\n    background-color: rgba(0, 0, 0, 0.2);\n    margin: 0 10px;\n  }\n\n  .toolbar .toolbar-item .text {\n    display: flex;\n    line-height: 20px;\n    width: 200px;\n    vertical-align: middle;\n    font-size: 14px;\n    color: #777;\n    text-overflow: ellipsis;\n    width: 70px;\n    overflow: hidden;\n    height: 20px;\n    text-align: left;\n  }\n\n  .toolbar .toolbar-item .icon {\n    display: flex;\n    width: 20px;\n    height: 20px;\n    user-select: none;\n    margin-right: 8px;\n    line-height: 16px;\n    background-size: contain;\n  }\n\n  .toolbar .toolbar-item.color-picker .MuiButton-startIcon {\n    margin: 0;\n  }\n\n  .toolbar .toolbar-item.color-picker .MuiButton-endIcon {\n    margin: 0;\n    margin-left: 4px;\n  }\n\n  .editor-image {\n    cursor: default;\n    display: inline-block;\n    position: relative;\n    user-select: none;\n  }\n\n  .editor-image img {\n    max-width: 100%;\n    cursor: default;\n  }\n\n  .editor-image img.focused {\n    outline: 2px solid rgb(60, 132, 244);\n    user-select: none;\n  }\n\n  .editor-image img.focused.draggable {\n    cursor: grab;\n  }\n\n  .editor-image img.focused.draggable:active {\n    cursor: grabbing;\n  }\n\n  .editor-image .image-caption-container .tree-view-output {\n    margin: 0;\n    border-radius: 0;\n  }\n\n  .editor-image .image-caption-container {\n    display: block;\n    position: absolute;\n    bottom: 4px;\n    left: 0;\n    right: 0;\n    padding: 0;\n    margin: 0;\n    border-top: 1px solid #fff;\n    background-color: rgba(255, 255, 255, 0.9);\n    min-width: 100px;\n    color: #000;\n    overflow: hidden;\n  }\n\n  .editor-image .image-caption-button {\n    display: block;\n    position: absolute;\n    bottom: 20px;\n    left: 0;\n    right: 0;\n    width: 30%;\n    padding: 10px;\n    margin: 0 auto;\n    border: 1px solid rgba(255, 255, 255, 0.3);\n    border-radius: 5px;\n    background-color: rgba(0, 0, 0, 0.5);\n    min-width: 100px;\n    color: #fff;\n    cursor: pointer;\n    user-select: none;\n  }\n\n  .editor-image .image-caption-button:hover {\n    background-color: rgba(60, 132, 244, 0.5);\n  }\n\n  .editor-image .image-edit-button {\n    border: 1px solid rgba(0, 0, 0, 0.3);\n    border-radius: 5px;\n    background-image: url(/src/images/icons/pencil-fill.svg);\n    background-size: 16px;\n    background-position: center;\n    background-repeat: no-repeat;\n    width: 35px;\n    height: 35px;\n    vertical-align: -0.25em;\n    position: absolute;\n    right: 4px;\n    top: 4px;\n    cursor: pointer;\n    user-select: none;\n  }\n\n  .editor-image .image-edit-button:hover {\n    background-color: rgba(60, 132, 244, 0.1);\n  }\n\n  .editor-image .image-resizer {\n    display: block;\n    width: 7px;\n    height: 7px;\n    position: absolute;\n    background-color: rgb(60, 132, 244);\n    border: 1px solid #fff;\n  }\n\n  .editor-image .image-resizer.image-resizer-n {\n    top: -6px;\n    left: 48%;\n    cursor: n-resize;\n  }\n\n  .editor-image .image-resizer.image-resizer-ne {\n    top: -6px;\n    right: -6px;\n    cursor: ne-resize;\n  }\n\n  .editor-image .image-resizer.image-resizer-e {\n    bottom: 48%;\n    right: -6px;\n    cursor: e-resize;\n  }\n\n  .editor-image .image-resizer.image-resizer-se {\n    bottom: -2px;\n    right: -6px;\n    cursor: nwse-resize;\n  }\n\n  .editor-image .image-resizer.image-resizer-s {\n    bottom: -2px;\n    left: 48%;\n    cursor: s-resize;\n  }\n\n  .editor-image .image-resizer.image-resizer-sw {\n    bottom: -2px;\n    left: -6px;\n    cursor: sw-resize;\n  }\n\n  .editor-image .image-resizer.image-resizer-w {\n    bottom: 48%;\n    left: -6px;\n    cursor: w-resize;\n  }\n\n  .editor-image .image-resizer.image-resizer-nw {\n    top: -6px;\n    left: -6px;\n    cursor: nw-resize;\n  }\n\n  .editor-footer {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding-left: 10px;\n    padding-right: 10px;\n    padding-bottom: 10px;\n  }\n\n  .ImageNode__contentEditable {\n    min-height: 20px;\n    border: 0px;\n    resize: none;\n    cursor: text;\n    caret-color: rgb(5, 5, 5);\n    display: block;\n    position: relative;\n    outline: 0px;\n    padding: 10px;\n    user-select: text;\n    font-size: 12px;\n    width: calc(100% - 20px);\n    white-space: pre-wrap;\n    word-break: break-word;\n  }\n\n  .ImageNode__placeholder {\n    font-size: 12px;\n    color: #888;\n    overflow: hidden;\n    position: absolute;\n    text-overflow: ellipsis;\n    top: 10px;\n    left: 10px;\n    user-select: none;\n    white-space: nowrap;\n    display: inline-block;\n    pointer-events: none;\n  }\n\n  .ImageNode__taskPriority {\n    width: 20px;\n    height: 20px;\n    margin-bottom: -5px;\n  }\n\n  .image-control-wrapper--resizing {\n    touch-action: none;\n  }\n"])))},eT=n(42693),ez=n(30852),eR=n(66076),eN=n(92777),eU=n(82262),e$=n(74450),eW=n(45959),eq=n(72179),eB=n(37247),eF=function(e){(0,eW.Z)(i,e);var t,n,r=(n=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var e,t=(0,eB.Z)(i);if(n){var r=(0,eB.Z)(this).constructor;e=Reflect.construct(t,arguments,r)}else e=t.apply(this,arguments);return(0,eq.Z)(this,e)});function i(e,t,n){var o;return(0,eN.Z)(this,i),(o=r.call(this,e,n)).__text=z()(e).format(t),o.__momentFormat=t,o}return(0,eU.Z)(i,[{key:"createDOM",value:function(e){return(0,e$.Z)((0,eB.Z)(i.prototype),"createDOM",this).call(this,e)}},{key:"updateDOM",value:function(e,t,n){return(0,e$.Z)((0,eB.Z)(i.prototype),"updateDOM",this).call(this,e,t,n)}},{key:"exportJSON",value:function(){return{text:z()(this.__text,this.__momentFormat).toISOString(),momentFormat:this.__momentFormat,type:"TimestampNode",version:1}}}],[{key:"importJSON",value:function(e){var t,n,r=e.text,i=e.momentFormat,o=e.format,a=(t=r,n=i,new eF(t,n));return a.setFormat(o),a}},{key:"getType",value:function(){return"TimestampNode"}},{key:"clone",value:function(e){return new i(e.__text,e.__momentFormat,e.__key)}}]),i}(n(61084).R2),eH=[eT.qp,eT.GR,ez.AV,eR.HJ,eF],eV={editable:!0,namespace:"React.js Demo",nodes:(0,w.Z)(eH),onError:function(e){throw e},theme:{code:"editor-code",heading:{h1:"editor-heading-h1",h2:"editor-heading-h2",h3:"editor-heading-h3",h4:"editor-heading-h4",h5:"editor-heading-h5"},image:"editor-image",link:"editor-link",list:{listitem:"editor-listitem",nested:{listitem:"editor-nested-listitem"},ol:"editor-list-ol",ul:"editor-list-ul"},ltr:"ltr",paragraph:"editor-paragraph",placeholder:"editor-placeholder",quote:"editor-quote",rtl:"rtl",text:{bold:"editor-text-bold",code:"editor-text-code",hashtag:"editor-text-hashtag",italic:"editor-text-italic",overflowed:"editor-text-overflowed",strikethrough:"editor-text-strikethrough",underline:"editor-text-underline",underlineStrikethrough:"editor-text-underlineStrikethrough"}}},eQ=n(2362),eG=n(17896),eY=function(e){return(0,eo.iv)(u||(u=(0,y.Z)(["\n  .message-header {\n    display: flex;\n    justify-content: space-between;\n    border-radius: 10px 10px 0 0;\n    background: rgba(0, 0, 0, 0.06);\n    padding: 5px 15px 0 15px;\n  }\n\n  .message-footer {\n    position: relative;\n    border-radius: 0 0 10px 0;\n    background: rgba(0, 0, 0, 0.06);\n    padding: 5px 15px 0 15px;\n  }\n  .message-footer:after {\n    content: '';\n    position: absolute;\n    bottom: 0;\n    left: -14px;\n    width: 0;\n    height: 0;\n    border-top: 10px solid transparent;\n    border-right: 15px solid rgba(0, 0, 0, 0.06);\n    border-bottom: 0px solid transparent;\n  }\n\n  .message-images {\n    padding: 0 15px;\n    background: rgba(0, 0, 0, 0.06);\n  }\n"])))},eK=function(){return(0,eo.iv)(d||(d=(0,y.Z)(["\n  .editor-container {\n    border-radius: 0;\n  }\n\n  .editor-input {\n    min-height: auto;\n    padding: 0 15px;\n    border-radius: 0;\n  }\n"])))},eJ=eD.Z.div(p||(p=(0,y.Z)(["\n  ","\n"])),eY),eX=n(69661),e0=function(e){switch(e){case"supplier":return"supplier only";case"customer":return"customer only";case"all":return"all";case"admin":return"internal";case"admin-supplier":return"admin and supplier";case"admin-customer":return"admin and customer";default:return""}},e1=n(62665),e2=function(e){var t=e.documentAttachmentArray;return(0,eu.jsx)(eu.Fragment,{children:t.map(function(e){return(0,eu.jsxs)(Y.Z,{sx:{mb:"5px"},children:[(0,eu.jsx)("object",{style:{borderRadius:"5px"},data:e.src,width:"100%",height:"200px"}),(0,eu.jsxs)(et.Z,{direction:"row",alignItems:"center",children:[(0,eu.jsx)(e1.Z,{color:"muiGray.main",sx:{mr:"10px"}}),(0,eu.jsx)("a",{href:e.src,without:!0,rel:"noopener noreferrer",target:"_blank",style:{fontSize:"11px"},children:e.name})]})]})})})},e5=n(734),e6=function(e){var t=e.imageAttachmentArray,n=(0,S.useState)(0),r=n[0],i=n[1],o=(0,S.useState)(!1),a=o[0],s=o[1],c=t.map(function(e){return e.src}),l=(0,S.useCallback)(function(e){i(e),s(!0)},[]),u=function(){i(0),s(!1)};return(0,eu.jsxs)(Y.Z,{children:[c.map(function(e,t){return(0,eu.jsx)("img",{src:e,onClick:function(){return l(t)},style:{objectFit:"cover",width:"150px",height:"100px",margin:"2px"},alt:""},t)}),a&&(0,eu.jsx)(e5.Z,{src:c,currentIndex:r,disableScroll:!1,closeOnClickOutside:!0,onClose:u,backgroundStyle:{zIndex:9999}})]})},e8=function(e){var t=e.attachmentArray;return t[0].type.startsWith("application")?(0,eu.jsx)(e2,{documentAttachmentArray:t}):t[0].type.startsWith("image")?(0,eu.jsx)(e6,{imageAttachmentArray:t}):null},e3=n(37324),e7=n(40999);function e4(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function e9(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?e4(Object(n),!0).forEach(function(t){(0,k.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):e4(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var te=function(e){var t=e.data,n="at "+z()(t.createdAt).format("hh:mma"),r=e0(t.to);return(0,eu.jsx)(eJ,{children:(0,eu.jsxs)(et.Z,{direction:"row",justifyContent:"flex-start",alignItems:"flex-end",mb:2,children:[(0,eu.jsx)(eX.Z,{sx:{bgcolor:(0,e3.u)(t.from)},alt:t.from,src:t.from}),(0,eu.jsxs)(et.Z,{width:"80%",ml:2,children:[(0,eu.jsxs)("div",{className:"message-header",children:[(0,eu.jsx)(X.Z,{sx:{fontSize:11,fontWeight:600},children:t.from}),(0,eu.jsx)(X.Z,{sx:{fontSize:11,color:"rgba(0, 0, 0, 0.87)",marginLeft:"5px"},children:n})]}),(0,eu.jsx)("div",{className:"message-images",children:Boolean(t.attachments.length)&&(0,eu.jsx)(e8,{attachmentArray:t.attachments})}),(0,eu.jsx)(e7.R,{initialConfig:e9(e9({},eV),{},{editable:!1,editorState:JSON.stringify(t.editorState)}),children:(0,eu.jsx)(eS.Z,{children:(0,eu.jsx)(eA,{customStyles:eK,children:(0,eu.jsx)(eP,{editable:!1})})})}),(0,eu.jsx)("div",{className:"message-footer",children:(0,eu.jsx)(et.Z,{width:"100%",direction:"row",justifyContent:"flex-end",children:(0,eu.jsx)(X.Z,{sx:{fontSize:11},children:r})})})]})]})})},tt=function(e){return(0,eo.iv)(f||(f=(0,y.Z)(["\n  .message-header {\n    display: flex;\n    justify-content: space-between;\n    border-radius: 10px 10px 0 0;\n    background: rgba(0, 0, 0, 0.06);\n    padding: 5px 15px 0 15px;\n  }\n\n  .message-footer {\n    position: relative;\n    border-radius: 0 0 0 10px;\n    background: rgba(0, 0, 0, 0.06);\n    padding: 5px 15px 0 15px;\n  }\n  .message-footer:after {\n    content: '';\n    position: absolute;\n    bottom: 0;\n    right: -14px;\n    width: 0;\n    height: 0;\n    border-top: 10px solid transparent;\n    border-left: 15px solid rgba(0, 0, 0, 0.06);\n    border-bottom: 0px solid transparent;\n  }\n\n  .message-images {\n    padding: 0 15px;\n    background: rgba(0, 0, 0, 0.06);\n  }\n"])))},tn=function(){return(0,eo.iv)(m||(m=(0,y.Z)(["\n  .editor-container {\n    border-radius: 0;\n  }\n\n  .editor-input {\n    min-height: auto;\n    padding: 0 15px;\n    border-radius: 0;\n  }\n"])))},tr=eD.Z.div(h||(h=(0,y.Z)(["\n  ","\n"])),tt);function ti(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function to(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ti(Object(n),!0).forEach(function(t){(0,k.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ti(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ta=function(e){var t=e.data,n="at "+z()(t.createdAt).format("hh:mma"),r=e0(t.to);return(0,eu.jsx)(tr,{children:(0,eu.jsxs)(et.Z,{direction:"row",justifyContent:"flex-end",alignItems:"flex-end",mb:2,children:[(0,eu.jsxs)(et.Z,{width:"80%",mr:2,children:[(0,eu.jsxs)("div",{className:"message-header",children:[(0,eu.jsx)(X.Z,{sx:{fontSize:11,fontWeight:600},children:t.from}),(0,eu.jsx)(X.Z,{sx:{fontSize:11,color:"rgba(0, 0, 0, 0.87)",marginLeft:"5px"},children:n})]}),(0,eu.jsx)("div",{className:"message-images",children:Boolean(t.attachments.length)&&(0,eu.jsx)(e8,{attachmentArray:t.attachments})}),(0,eu.jsx)(e7.R,{initialConfig:to(to({},eV),{},{editable:!1,editorState:JSON.stringify(t.editorState)}),children:(0,eu.jsx)(eS.Z,{children:(0,eu.jsx)(eA,{customStyles:tn,children:(0,eu.jsx)(eP,{editable:!1})})})}),(0,eu.jsx)("div",{className:"message-footer",children:(0,eu.jsx)(et.Z,{width:"100%",direction:"row",justifyContent:"flex-end",children:(0,eu.jsx)(X.Z,{sx:{fontSize:11},children:r})})})]}),(0,eu.jsx)(eX.Z,{sx:{bgcolor:(0,e3.u)(t.from)},alt:t.from,src:t.from})]})})},ts=function(e){return(0,eo.iv)(g||(g=(0,y.Z)(["\n  .message-header {\n    display: flex;\n    justify-content: space-between;\n    border-radius: 10px 10px 0 0;\n    background: none;\n    padding: 5px 15px 0 15px;\n  }\n\n  .message-images {\n    background: none;\n  }\n\n  .editor-container {\n    border-radius: 0;\n  }\n\n  div.editor-input {\n    min-height: auto;\n    padding: 0 15px;\n  }\n"])))},tc=function(){return(0,eo.iv)(x||(x=(0,y.Z)(["\n  .editor-container {\n    border-radius: 0;\n    background: none;\n  }\n\n  .editor-input {\n    min-height: auto;\n    padding: 0 15px;\n    border-radius: 0;\n    color: rgba(117, 117, 117, 0.87);\n  }\n"])))},tl=eD.Z.div(v||(v=(0,y.Z)(["\n  ","\n"])),ts),tu=n(86886);function td(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function tp(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?td(Object(n),!0).forEach(function(t){(0,k.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):td(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var tf=function(e){var t=e.data,n="at "+z()(t.createdAt).format("hh:mma");return(0,eu.jsx)(tl,{children:(0,eu.jsx)(et.Z,{direction:"row",justifyContent:"flex-start",mb:2,children:(0,eu.jsx)(et.Z,{width:"100%",children:(0,eu.jsxs)(tu.ZP,{container:!0,children:[(0,eu.jsxs)(tu.ZP,{item:!0,xs:9,children:[(0,eu.jsx)("div",{className:"message-images",children:Boolean(t.attachments.length)&&(0,eu.jsx)(e8,{attachmentArray:t.attachments})}),(0,eu.jsx)(e7.R,{initialConfig:tp(tp({},eV),{},{editable:!1,editorState:JSON.stringify(t.editorState)}),children:(0,eu.jsx)(eS.Z,{children:(0,eu.jsx)(eA,{customStyles:tc,children:(0,eu.jsx)(eP,{editable:!1})})})})]}),(0,eu.jsx)(tu.ZP,{item:!0,xs:3,children:(0,eu.jsx)(X.Z,{sx:{fontSize:11,color:"rgba(0, 0, 0, 0.87)",textAlign:"right"},children:n})})]})})})})},tm=function(e){var t=e.data;return"System message"===t.from?(0,eu.jsx)(tf,{data:t}):"in"===t.type?(0,eu.jsx)(te,{data:t}):(0,eu.jsx)(ta,{data:t})},th=n(72936),tg=n(27434),tx=n(58533);function tv(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function tb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tv(Object(n),!0).forEach(function(t){(0,k.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tv(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ty=function(e){var t,n=e.title,r=e.elevation,i=e.maxHeight,o=e.id,a=e.adminId,s=e.customerId,c=e.supplierId,l=e.scope,u=e.expanded,d=e.onChangeExpanded,p=e.hideExpandIcon,f=(0,th.x)().user,m=(0,S.useMemo)(function(){return V({accountType:f.accountType})},[f.accountType]),h=(0,S.useState)(!1),g=h[0],x=h[1],v=(0,S.useState)(null),b=v[0],y=v[1],k=(0,S.useState)(""),O=k[0],D=k[1],I=(0,S.useState)(""),T=I[0],R=I[1],N=(0,S.useState)(""),U=N[0],$=N[1],q=(0,S.useState)(null===(t=m[0])||void 0===t?void 0:t.value),eo=q[0],ea=q[1],es=(0,S.useState)([]),ec=es[0],el=es[1],ep=(0,S.useState)(0),ef=ep[0],em=ep[1],eh=(0,S.useState)(!0),eg=eh[0],ex=eh[1],ev=(0,S.useMemo)(function(){return Q({accountType:f.accountType,adminId:a,customerId:s,supplierId:c})},[f.accountType,a,s,c]),eb=(0,P.a)(L,{variables:{id:ev,limit:50,offset:0,q:U?"%".concat(U,"%"):null}}).data,ey=(eb=void 0===eb?{users:[]}:eb).users,ej=(0,S.useMemo)(function(){return G({users:ey,audience:eo,accountType:f.accountType,userId:f.id})},[eo,f.accountType,f.id,ey]),ew=(0,S.useMemo)(function(){return tb(tb(tb({},"job"===l&&{jobId:o}),"task"===l&&{taskId:o}),{},{filter:b||null,text:{_ilike:T?"%".concat(T,"%"):null},limit:50,offset:0})},[l,o,b,T]),eZ=(0,S.useMemo)(function(){return tb(tb(tb({},"job"===l&&{jobId:o}),"task"===l&&{taskId:o}),{},{filter:b||null})},[l,o,b]),ek=(0,P.a)(E,{variables:ew,fetchPolicy:"cache-and-network",nextFetchPolicy:"cache-and-network"}),eC=ek.data,e_=(eC=void 0===eC?{communications:[]}:eC).communications,eD=ek.fetchMore,eI=ek.subscribeToMore,eE=ek.updateQuery,eM=(0,S.useCallback)((0,Z.Z)(C().mark(function e(){var t,n;return C().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,eD({variables:{offset:ef+50},updateQuery:function(e,t){var n=t.fetchMoreResult;if(!n)return e;var r=n.communications.filter(function(t){var n=t.id;return!e.communications.find(function(e){return e.id===n})});return Object.assign({},e,{communications:[].concat((0,w.Z)(e.communications),(0,w.Z)(r))})}});case 2:n=e.sent.data.communications,em(function(e){return e+50}),n.length||ex(!1);case 6:case"end":return e.stop()}},e)})),[eD,ef]);(0,S.useEffect)(function(){var e,t,n=(e=e_,t=f,(0,w.Z)(e).map(function(e){var n=W({},e);return n.time=z()(n.createdAt).format("D MMM YYYY HH:mm"),n.from="System message"===n.from?"System message":n.user?"".concat(n.user.nameFirst," <").concat(n.user.email,">"):n.from,n.type=n.user&&n.user.id===t.id?"out":"in",n.statusText=n.status,n.attachments=[],n.media.forEach(function(e){var t,r,i;(null==e?void 0:null===(t=e.medium)||void 0===t?void 0:t.type)==="audio"?n.voice="".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(e.medium.filename):(null==e?void 0:null===(r=e.medium)||void 0===r?void 0:r.type)==="image"?n.attachments.push({type:"image/png",src:"".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(e.medium.filename),name:""}):(null==e?void 0:null===(i=e.medium)||void 0===i?void 0:i.type)==="document"&&n.attachments.push({type:"application/pdf",src:"".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(e.medium.filename),name:"".concat(e.medium.filename)})}),n})),r=H(f,n),i=F(r);el(i)},[e_,f]);var eL=(0,S.useCallback)(function(){return eI({document:A,variables:tb(tb({},eZ),{},{userId:f.id,now:z()().toISOString()}),updateQuery:function(e,t){var n=t.subscriptionData;if(!n.data)return e;if(e.communications){var r=n.data.communications.filter(function(t){var n=t.id;return!e.communications.find(function(e){return e.id===n})});return Object.assign({},e,{communications:[].concat((0,w.Z)(e.communications),(0,w.Z)(r))})}}})},[eI,eZ,f.id]);(0,S.useEffect)(function(){eL()},[eL]);var eT=(0,_.D)(M,{onCompleted:function(e){eE(function(t){return tb(tb({},t),{},{communications:[].concat((0,w.Z)(t.communications),(0,w.Z)(e.insert_Communication.returning))})})}}),ez=(0,j.Z)(eT,2),eR=ez[0],eN=ez[1].loading,eU=function(e){var t=e.json,n=e.plainText,r=e.mentions,i={text:n,editorState:t.editorState,audience:eo,mentions:r};B({form:i,scope:l,user:f,id:o,AddCommunication:eR})},e$=function(e){var t,n=e.attachments,r=e.description;B({form:{attachments:n,text:r,editorState:{root:{type:"root",format:"",indent:0,version:1,children:[{type:"paragraph",format:"",indent:0,version:1,children:[{mode:"normal",text:r,type:"text",style:"color: ;",detail:0,format:0,version:1}],direction:"ltr"}],direction:"ltr"}},audience:eo,message:null},scope:l,user:f,id:o,AddCommunication:eR})};return(0,S.useEffect)(function(){var e=setTimeout(function(){R(O)},2e3);return function(){return clearTimeout(e)}},[O]),(0,eu.jsx)(Y.Z,{children:(0,eu.jsxs)(K.Z,{elevation:r,expanded:u,onChange:d,children:[(0,eu.jsx)(J.Z,tb(tb({},!p&&{expandIcon:(0,eu.jsx)(tg.Z,{})}),{},{sx:{"& .MuiAccordionSummary-content":{marginBottom:0}},children:(0,eu.jsx)(X.Z,{variant:"h6",children:n})})),(0,eu.jsx)(ee.Z,{sx:{pt:0},children:(0,eu.jsxs)(et.Z,{width:"100%",maxHeight:i,children:[(0,eu.jsx)(X.Z,{children:"Active Chat"}),(0,eu.jsxs)(et.Z,{direction:"row",justifyContent:"space-between",width:"100%",spacing:1,children:[(0,eu.jsx)(en.Z,{fullWidth:!0,label:"Search message",variant:"standard",color:"secondary",value:O,onChange:function(e){return D(e.target.value)}}),(0,eu.jsx)(ed,{filter:b,setFilter:y})]}),(0,eu.jsx)(Y.Z,{id:"scrollableDiv",sx:{display:"flex",flexDirection:"column-reverse",pt:1,overflowY:"auto"},children:(0,eu.jsxs)(tx.Z,{dataLength:ec.length,next:eM,style:{display:"flex",flexDirection:"column-reverse",padding:"5px 0 0 0"},inverse:!0,hasMore:eg,loader:(0,eu.jsx)(er.Z,{color:"secondary"}),scrollableTarget:"scrollableDiv",children:[!ec.length&&(0,eu.jsx)(et.Z,{width:"100%",height:"120px",alignItems:"center",justifyContent:"center",children:(0,eu.jsx)(X.Z,{children:"Here no messages"})}),ec.map(function(e,t){return(0,eu.jsxs)(Y.Z,{children:[e.isDivider&&(0,eu.jsx)(et.Z,{direction:"row",justifyContent:"center",children:(0,eu.jsx)(Y.Z,{mb:1,children:(0,eu.jsx)(ei.Z,{label:e.time,sx:{fontSize:"11px",color:"#202020"},size:"small"})})}),(0,eu.jsx)(tm,{data:e})]},e.id)})]})}),(0,eu.jsx)(eO,{children:(0,eu.jsx)(e7.R,{initialConfig:eV,children:(0,eu.jsx)(eQ.Z,{audienceOptions:m,audience:eo,setAudience:ea,children:(0,eu.jsx)(eG.Z,{setMentionSearch:$,mentions:ej,children:(0,eu.jsx)(eS.Z,{children:(0,eu.jsx)(eA,{customStyles:tj,children:(0,eu.jsx)(eP,{loading:g||eN,setLoading:x,onSubmit:eU,onSubmitAttachment:e$})})})})})})})]})})]})})};ty.defaultProps={title:"Context",elevation:1,maxHeight:"550px",onChangeExpanded:function(){}};var tj=function(){return(0,eo.iv)(b||(b=(0,y.Z)(["\n  .editor-inner {\n    overflow-y: scroll;\n    max-height: 300px;\n  }\n\n  .editor-input {\n    min-height: 100px;\n  }\n\n  .audience-plugin {\n    .MuiInputBase-root {\n      width: 110px;\n    }\n\n    .select {\n      justify-self: flex-start;\n      padding: 5px 32px 5px 5px;\n    }\n  }\n"])))}},55733:function(e,t,n){n.d(t,{G:function(){return D}});var r=n(59499),i=n(50029),o=n(16835),a=n(64687),s=n.n(a),c=n(30381),l=n.n(c),u=n(50319),d=n(73359),p=n(42283),f=n(79665),m=n(89077),h=n(26447),g=n(98456),x=n(50135),v=n(77010),b=n(33754),y=n(15221),j=n(72936),w=n(18574),Z=n(1950),k=n(79203),O=n(73183),C=n(45165),S=n(85893);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function _(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var D=function(e){var t,n=e.jobId,r=e.close,a=(0,j.x)().user,c=(0,C.z)("Task",a.adminId,a.id),P=c.createMediaInput,D=c.loadingAddMedia,I=c.loadingAddMediaEntity,E=(0,p.cI)({defaultValues:{priority:"urgent",relatedLinks:[]},resolver:(0,f.S)(k.E)}),A=E.handleSubmit,M=E.register,L=E.watch,T=E.setValue,z=E.control,R=E.errors,N=L("relatedLinks"),U=L("attachments"),$=(0,u.D)(y.ew,{refetchQueries:["GetTasksTable"]}),W=(0,o.Z)($,2),q=W[0],B=W[1].loading,F=(0,d.t)(y.Lu,{variables:{accountId:a.adminId}}),H=(0,o.Z)(F,2),V=H[0],Q=H[1],G=Q.loading,Y=Q.data,K=(Y=void 0===Y?{items:[]}:Y).items,J=(t=(0,i.Z)(s().mark(function e(t){var i,o;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P(t.attachments);case 2:return i=e.sent,o=_({status:m.cj.NEW,priority:t.priority,relatedLinks:t.relatedLinks,title:t.title,content:t.content,dueDate:t.dueDate,adminId:a.adminId,userId:a.id,assignedAccountId:a.adminId,assignedUserId:t.assignedUser.value,jobId:n},i||{}),e.next=6,q({variables:{objects:[o]}});case 6:r();case 7:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)});return B||D||I?(0,S.jsx)(h.Z,{width:"100%",direction:"column",justifyContent:"center",alignItems:"center",children:(0,S.jsx)(g.Z,{color:"secondary"})}):(0,S.jsx)("form",{id:"offCanvasForm",onSubmit:A(J),children:(0,S.jsxs)(h.Z,{direction:"column",spacing:3,children:[(0,S.jsx)(p.Qr,{control:z,name:"title",render:function(e){var t,n=e.value,r=e.onChange;return(0,S.jsx)(x.Z,{variant:"standard",color:"secondary",label:"Title",value:n,onChange:r,error:R.title,helperText:null===(t=R.title)||void 0===t?void 0:t.message})}}),(0,S.jsx)(p.Qr,{control:z,name:"content",render:function(e){var t,n=e.value,r=e.onChange;return(0,S.jsx)(x.Z,{multiline:!0,minRows:8,variant:"filled",color:"secondary",label:"Content",value:n,onChange:r,error:R.content,helperText:null===(t=R.content)||void 0===t?void 0:t.message})}}),(0,S.jsx)(p.Qr,{control:z,name:"priority",render:function(e){var t,n=e.value,r=e.onChange;return(0,S.jsx)(v.E,{label:"Priority:",labelLeft:!0,stackProps:{direction:"row",flexWrap:"wrap"},options:m.FX,value:n,onChange:r,error:R.priority,helperText:null===(t=R.priority)||void 0===t?void 0:t.message})}}),(0,S.jsx)(p.Qr,{control:z,name:"dueDate",defaultValue:null,render:function(e){return(0,S.jsx)(b.M,_(_({},e),{},{label:"Due date",inputFormat:"Do MMM YYYY",minDate:l()(),renderInput:function(e){var t;return(0,S.jsx)(x.Z,_(_({},e),{},{error:R.dueDate,helperText:null===(t=R.dueDate)||void 0===t?void 0:t.message,color:"secondary",variant:"standard"}))}}))}}),(0,S.jsx)(p.Qr,{name:"assignedUser",control:z,render:function(e){var t,n=e.value,r=e.onChange;return(0,S.jsx)(w.F,{value:n,onChange:function(e,t){return r(t)},label:"Assigned to",loading:G,onOpen:function(){return V()},options:K,error:R.assignedUser,helperText:null===(t=R.assignedUser)||void 0===t?void 0:t.message})}}),(0,S.jsx)(Z.V,{values:N,setValue:T,name:"relatedLinks"}),(0,S.jsx)(O.f,{values:U,setValue:T}),(0,S.jsx)("input",_(_({},M("relatedLinks")),{},{type:"hidden"})),(0,S.jsx)("input",_(_({},M("attachments")),{},{type:"hidden"}))]})})};D.defaultProps={}},15221:function(e,t,n){n.d(t,{Lu:function(){return l},ew:function(){return d},go:function(){return p},lm:function(){return u}});var r,i,o,a,s=n(71383),c=n(75063),l=(0,c.Ps)(r||(r=(0,s.Z)(['\n  query GetAssingedToForSelect($accountId: Int, $q: String) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        Account_Users: { accountId: { _eq: $accountId }, status: { _eq: "active" } }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n      }\n      order_by: { nameFirst: asc }\n    ) {\n      label: fullName\n      value: id\n    }\n  }\n']))),u=(0,c.Ps)(i||(i=(0,s.Z)(["\n  query GetTaskDetails($id: Int!) {\n    task: Task_by_pk(id: $id) {\n      id\n      status\n      priority\n      statusLog\n      meta\n      relatedLinks\n      title\n      content\n      dueDate\n      createdAt\n      updatedAt\n      adminId\n      archived\n      userId\n      assignedAccountId\n      assignedUser: AssignedUser {\n        id\n        fullName\n      }\n      jobId\n      workflowId\n      job: Job {\n        id\n        number\n        type\n        quoted\n\n        customer: Customer {\n          id\n          name\n        }\n\n        supplier: Supplier {\n          id\n          name\n        }\n\n        location: Location {\n          id\n          name\n        }\n      }\n    }\n  }\n"]))),d=(0,c.Ps)(o||(o=(0,s.Z)(["\n  mutation CreateTask($objects: [Task_insert_input!]!) {\n    insert_Task(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]))),p=(0,c.Ps)(a||(a=(0,s.Z)(["\n  mutation UpdateTask($id: Int!, $object: Task_set_input!) {\n    update_Task_by_pk(pk_columns: { id: $id }, _set: $object) {\n      id\n    }\n  }\n"])))},79203:function(e,t,n){n.d(t,{E:function(){return i}});var r=n(74231),i=r.Ry({title:r.Z_().required("Title is required field"),content:r.Z_().required("Content is required field"),priority:r.Z_().oneOf(["urgent","high","normal","low"]).required().required("Priority is required field").typeError("Priority is required field"),dueDate:r.hT().required("Due date is required field").typeError("Due date is required field"),assignedUser:r.Ry().required("Assigned to is required field").typeError("Assigned to is required field")})},24437:function(e,t,n){n.d(t,{J:function(){return W}});var r=n(27812),i=n(59499),o=n(16835),a=n(6812),s=n(50319),c=n(73359),l=n(42283),u=n(79665),d=n(89077),p=n(61730),f=n(41796),m=n(26447),h=n(98456),g=n(15861),x=n(11057),v=n(86886),b=n(50135),y=n(2869),j=n(5616),w=n(67720),Z=n(39300),k=n(15221),O=n(72936),C=n(18574),S=n(1950),P=n(79203),_=n(67432),D=n(30381),I=n.n(D),E=n(10166),A=n(6498),M=n(87043),L=n(64951),T=n(60092),z=n(73073),R=n(78893),N=n(85893);function U(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function $(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?U(Object(n),!0).forEach(function(t){(0,i.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):U(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var W=function(e){var t,n=e.id,i=e.close,D=(0,p.Z)("(max-width: 900px)"),E=(0,O.x)().user,T=(0,A.u)(),U=(0,l.cI)({defaultValues:{status:"new",priority:"urgent",relatedLinks:[]},resolver:(0,u.S)(P.E)}),W=U.handleSubmit,H=U.register,V=U.watch,Q=U.setValue,G=U.control,Y=U.errors,K=U.reset,J=V("relatedLinks"),X=(0,a.a)(k.lm,{variables:{id:n},onCompleted:function(){var e,t,n,i,o,a,s,c,l,u,d,p,f,m,h,g,x=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{task:{}},v=x.task,b=(0,r.Z)(v.relatedLinks||[]);(null!==(e=v.job)&&void 0!==e&&e.id&&!v.workflowId||null!==(t=v.job)&&void 0!==t&&t.id&&v.workflowId&&null!==(n=v.meta)&&void 0!==n&&null!==(i=n.relatedLinksType)&&void 0!==i&&i.job)&&b.unshift({noDelete:!0,name:"".concat((0,L.y)(v.job.type)," ").concat("quote"!==v.job.type&&v.job.quoted?"Q":""," ").concat(v.job.number),url:"".concat(M.C1.portalUrl,"/dashboard/issues/view?id=").concat(v.job.number),noEdit:!0}),null!==(o=v.job)&&void 0!==o&&null!==(a=o.customer)&&void 0!==a&&a.id&&v.workflowId&&null!==(s=v.meta)&&void 0!==s&&null!==(c=s.relatedLinksType)&&void 0!==c&&c.customer&&b.unshift({noDelete:!0,name:v.job.customer.name,url:"".concat(M.C1.portalUrl,"/dashboard/customers/view?id=").concat(v.job.customer.id),noEdit:!0}),null!==(l=v.job)&&void 0!==l&&null!==(u=l.supplier)&&void 0!==u&&u.id&&v.workflowId&&null!==(d=v.meta)&&void 0!==d&&null!==(p=d.relatedLinksType)&&void 0!==p&&p.supplier&&b.unshift({noDelete:!0,name:v.job.supplier.name,url:"".concat(M.C1.portalUrl,"/dashboard/suppliers/view?id=").concat(v.job.supplier.id),noEdit:!0}),null!==(f=v.job)&&void 0!==f&&null!==(m=f.location)&&void 0!==m&&m.id&&v.workflowId&&null!==(h=v.meta)&&void 0!==h&&null!==(g=h.relatedLinksType)&&void 0!==g&&g.location&&b.unshift({noDelete:!0,name:v.job.location.name,url:"".concat(M.C1.portalUrl,"/dashboard/properties/view?id=").concat(v.job.location.id),noEdit:!0}),K({status:v.status,priority:v.priority,relatedLinks:b,title:v.title,content:v.content,dueDate:v.dueDate,assignedUser:{label:v.assignedUser.fullName,value:v.assignedUser.id}})}}),ee=X.data,et=(ee=void 0===ee?{task:{}}:ee).task,en=X.loading,er=X.refetch,ei=(0,s.D)(k.go,{refetchQueries:["GetTasksTable","GetTaskDetails"]}),eo=(0,o.Z)(ei,2),ea=eo[0],es=eo[1].loading,ec=(0,c.t)(k.Lu,{variables:{accountId:E.adminId}}),el=(0,o.Z)(ec,2),eu=el[0],ed=el[1],ep=ed.loading,ef=ed.data,em=(ef=void 0===ef?{items:[]}:ef).items,eh=function(e){var t=e.relatedLinks.filter(function(e){return!e.noEdit});ea({variables:{id:n,object:{status:e.status,priority:e.priority,relatedLinks:t,title:e.title,content:e.content,dueDate:e.dueDate,adminId:E.adminId,userId:E.id,assignedAccountId:E.adminId,assignedUserId:e.assignedUser.value}}}),i()},eg={disableUnderline:!0,sx:{color:(0,f.$n)(T.palette.text.primary,.46),fontWeight:700}},ex=function(){ea({variables:{id:n,object:{archived:!1}}}),i()};return en||es?(0,N.jsx)(m.Z,{width:"100%",direction:"column",justifyContent:"center",alignItems:"center",children:(0,N.jsx)(h.Z,{color:"secondary"})}):(0,N.jsxs)(B,{sx:q.container(null==et?void 0:et.archived),children:[(null==et?void 0:et.archived)&&(0,N.jsx)(F,{children:(0,N.jsxs)(g.Z,{sx:q.unarchiveLabel,children:["This task has been archived.",(0,N.jsx)(x.Z,{onClick:ex,variant:"text",sx:q.unarchiveButton,children:"Unarchive"})]})}),(0,N.jsxs)(v.ZP,{container:!0,justifyContent:"space-between",rowGap:3,sx:{height:"100%",minHeight:"calc(100vh - 128px)"},children:[(0,N.jsxs)(v.ZP,{item:!0,xs:12,md:5,children:[(0,N.jsx)("form",{id:"offCanvasForm",onSubmit:W(eh),children:(0,N.jsxs)(m.Z,{direction:"column",spacing:3,children:[(0,N.jsxs)(m.Z,{direction:"row",spacing:1,children:[(0,N.jsx)(g.Z,{children:"Created date:"}),(0,N.jsx)(g.Z,{fontWeight:700,children:I()(et.createdAt).format("DD/MM/YYYY")})]}),(0,N.jsx)(b.Z,{InputProps:{sx:q.title},variant:"standard",color:"secondary",label:"Title",name:"title",inputRef:H,error:Y.title,helperText:null===(t=Y.title)||void 0===t?void 0:t.message}),(0,N.jsx)(l.Qr,{control:G,name:"content",render:function(e){var t,n=e.value,r=e.onChange;return(0,N.jsx)(b.Z,{multiline:!0,minRows:8,variant:"filled",color:"secondary",value:n,onChange:r,error:Y.content,helperText:null===(t=Y.content)||void 0===t?void 0:t.message})}}),(0,N.jsxs)(v.ZP,{container:!0,alignItems:"flex-end",rowGap:1,children:[(0,N.jsx)(v.ZP,{item:!0,xs:12,md:5,lg:5,children:(0,N.jsx)(l.Qr,{control:G,name:"status",render:function(e){var t,n=e.value,r=e.onChange;return(0,N.jsx)(_.P,{formControl:{error:Y.status,helperText:null===(t=Y.status)||void 0===t?void 0:t.message},selectProps:{input:(0,N.jsx)(y.ZP,{sx:q.hoverOpacity})},withoutSelectIcon:!0,inputComponent:"chip",selectComponent:"chip",leftSideLabel:!0,label:"Status:",value:n,onChange:r,options:d.jb})}})}),(0,N.jsxs)(v.ZP,{container:!0,item:!0,xs:12,md:7,lg:7,display:"flex",direction:"row",alignItems:"center",columnGap:1,children:[(0,N.jsx)(g.Z,{children:"Assigned to:"}),(0,N.jsx)(l.Qr,{name:"assignedUser",control:G,render:function(e){var t,n=e.value,r=e.onChange;return(0,N.jsx)(C.F,{sx:$($({},q.assignedToAutocomplete),q.hoverBackground),withoutSelectIcon:!0,inputProps:{InputProps:eg},value:n,onChange:function(e,t){return r(t)},loading:ep,onOpen:function(){return eu()},options:em,error:Y.assignedUser,helperText:null===(t=Y.assignedUser)||void 0===t?void 0:t.message})}})]}),(0,N.jsxs)(v.ZP,{container:!0,item:!0,xs:12,sm:4,md:5,lg:5,display:"flex",direction:"row",alignItems:"center",columnGap:1,children:[(0,N.jsx)(g.Z,{children:"Priority:"}),(0,N.jsx)(l.Qr,{control:G,name:"priority",render:function(e){var t=e.value,n=e.onChange;return(0,N.jsx)(_.P,{selectProps:{input:(0,N.jsx)(y.ZP,{sx:$($({width:"90px!important"},q.paddingHorizontal),q.hoverBackground)}),inputProps:eg},withoutSelectIcon:!0,inputComponent:"textWithIcon",selectComponent:"textWithIcon",options:d.FX,value:t,onChange:n})}})]}),(0,N.jsxs)(v.ZP,{container:!0,item:!0,xs:12,md:7,lg:7,display:"flex",direction:"row",alignItems:"center",columnGap:1,children:[(0,N.jsx)(g.Z,{whiteSpace:"nowrap",children:"Due date:"}),(0,N.jsx)(l.Qr,{control:G,name:"dueDate",render:function(e){return(0,N.jsx)(Z.O,$($({},e),{},{inputFormat:"Do MMM YYYY",minDate:I()(),renderInput:function(e){var t;return(0,N.jsx)(N.Fragment,{children:(0,N.jsx)(b.Z,$($({sx:$($({width:"120px"},q.paddingHorizontal),q.hoverBackground)},e),{},{onOpen:e.InputProps.endAdornment,error:Y.dueDate,helperText:null===(t=Y.dueDate)||void 0===t?void 0:t.message,color:"secondary",variant:"standard",InputProps:eg}))})}}))}})]})]}),(0,N.jsx)(S.V,{values:J,setValue:Q,name:"relatedLinks"}),(0,N.jsx)("input",$($({},H("relatedLinks")),{},{type:"hidden"}))]})}),(0,N.jsx)(j.Z,{sx:q.marginTop,children:(0,N.jsx)(z.G,{carousel:!1,entityId:et.id,entity:"Task",onMediaAdd:er,onMediaRemove:er,columnVisibilityModel:{name:!1},mediaFormProps:{showSubmitButton:!0},offCanvasProps:{submit:!1}})})]}),!D&&(0,N.jsx)(v.ZP,{item:!0,xs:12,md:.5,display:"flex",justifyContent:"center",children:(0,N.jsx)(w.Z,{orientation:"vertical"})}),(0,N.jsx)(v.ZP,{item:!0,xs:12,md:6,children:(0,N.jsx)(R.b,{elevation:0,maxHeight:"800px",title:"Activity",id:n,adminId:E.adminId,scope:"task",expanded:!0,hideExpandIcon:!0})})]})]})},q={assignedToAutocomplete:{".MuiFormControl-fullWidth":{width:"120px!important"},".MuiInputBase-input":{minWidth:"90px!important"}},hoverBackground:{":hover":{backgroundColor:"#DDDDDD",borderRadius:"10px"}},marginTop:{marginTop:"10px"},paddingHorizontal:{padding:"0px 3px"},hoverOpacity:{opacity:.6},unarchiveButton:{color:"".concat(T.Q.COLOUR.black,"!important"),fontWeight:600,transition:"all 0.5s easy-in-out",":hover":{textDecoration:"underline"}},unarchiveLabel:{color:"".concat(T.Q.COLOUR.black,"!important"),fontWeight:500},title:{fontSize:20,fontWeight:700},container:function(e){return{marginTop:e?"3.5rem":0}}};W.defaultProps={close:function(){}};var B=(0,E.Z)(j.Z)(function(e){var t=e.theme;return{"& .MuiTypography-root:not(.MuiLink-root)":{color:(0,f.$n)(t.palette.text.primary,.46)},"& .MuiInputBase-formControl:hover .mui-hover":{borderRadius:"10px",transition:".5s easy-in-out",backgroundColor:"red!important"}}}),F=(0,E.Z)(j.Z)({position:"absolute",left:0,marginTop:"-4.5rem",display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"60px",backgroundColor:T.Q.COLOUR.info})},45165:function(e,t,n){n.d(t,{z:function(){return g}});var r=n(27812),i=n(50029),o=n(16835),a=n(64687),s=n.n(a),c=n(6812),l=n(50319),u=n(30381),d=n.n(u),p=n(12603),f=n(75847);function m(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return h(e,t)}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}var g=function(e,t,n,a){var u,h,g,x=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"media",v=(0,c.a)(p.O,{variables:{entity:e,entityId:a,category:x,adminId:t},skip:!a}),b=v.data,y=(b=void 0===b?{items:[]}:b).items,j=v.loading,w=(0,l.D)(f.CI,{}),Z=(0,o.Z)(w,2),k=Z[0],O=Z[1].loading,C=(0,l.D)(f.xM,{refetchQueries:["MEDIAS"]}),S=(0,o.Z)(C,2),P=S[0],_=S[1].loading,D=(0,l.D)(f.tv,{refetchQueries:["MEDIAS"]}),I=(0,o.Z)(D,2),E=I[0],A=I[1].loading,M=function(e){k({variables:{id:e}})},L=function(){var e="cleverly-media";return JSON.stringify([{width:32,height:32,bucket:e,sizeName:"vSmall",fit:"inside"},{width:200,height:200,bucket:e,sizeName:"small",fit:"inside"},{width:600,height:600,bucket:e,sizeName:"medium",fit:"inside"},{width:1200,height:1200,bucket:e,sizeName:"large",fit:"inside"}])},T=(u=(0,i.Z)(s().mark(function r(i,o){var a,c,l,u,p;return s().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:if(!o){r.next=13;break}return r.next=3,R(o);case 3:return a=r.sent,c={adminId:t,caption:o.caption,expiryAt:d()().utc().format(),extension:o.media.name.split(".").pop(),userId:n,filename:a.key,type:o.media.type},r.next=7,P({variables:{objects:c}});case 7:if(u=r.sent.data.insert_Media.returning,!(e&&i)){r.next=13;break}return p=u.map(function(t){return{mediaId:t.id,entity:e,entityId:i}}),r.next=13,E({variables:{objects:p}});case 13:case"end":return r.stop()}},r)})),function(e,t){return u.apply(this,arguments)}),z=(h=(0,i.Z)(s().mark(function i(o){var a,c,l,u,p,f,h,g,x,v,b=arguments;return s().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:if(a=b.length>1&&void 0!==b[1]?b[1]:"media",c=null,!(null!=o&&o.length)){i.next=23;break}l=m(o),i.prev=4,l.s();case 6:if((u=l.n()).done){i.next=15;break}if((p=u.value).mediaId){i.next=13;break}return i.next=11,R(p);case 11:v=i.sent,c={Media_Entity:{data:[].concat((0,r.Z)(null!==(f=null===(h=c)||void 0===h?void 0:null===(g=h.Media_Entity)||void 0===g?void 0:g.data)&&void 0!==f?f:[]),[{entity:e,Medium:{data:{adminId:t,caption:null!==(x=null==p?void 0:p.caption)&&void 0!==x?x:null,expiryAt:d()().utc().format(),extension:p.media.name.split(".").pop(),userId:n,category:a,filename:v.key,type:p.media.type}}}])}};case 13:i.next=6;break;case 15:i.next=20;break;case 17:i.prev=17,i.t0=i.catch(4),l.e(i.t0);case 20:return i.prev=20,l.f(),i.finish(20);case 23:return i.abrupt("return",c);case 24:case"end":return i.stop()}},i,null,[[4,17,20,23]])})),function(e){return h.apply(this,arguments)}),R=(g=(0,i.Z)(s().mark(function e(t){var n,r,i,o,a;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n="cleverly-media",r="https://aws.cleverly.works/aws/s3/upload",(i=new window.FormData).append("file",t.media,t.media.name),e.t0=t.type,e.next="image"===e.t0?7:"document"===e.t0?10:"audio"===e.t0?14:18;break;case 7:return o="https://aws.cleverly.works/image/process",i.append("sizes",L()),e.abrupt("break",19);case 10:case 14:return i.append("bucket",n),i.append("folder","".concat(t.type,"s")),o=r,e.abrupt("break",19);case 18:return e.abrupt("break",19);case 19:return e.next=21,window.fetch(o,{method:"POST",body:i});case 21:return a=e.sent,e.abrupt("return",a.json());case 23:case"end":return e.stop()}},e)})),function(e){return g.apply(this,arguments)});return{uploadMedia:T,uploadMediaToS3:R,createMediaInput:z,deleteMediaByEntity:M,loadingAddMediaEntity:A,loadingAddMedia:_,loadingDeleteMedia:O,preloadedMediaLoading:j,preloadedMedia:null!=y&&y.length?y:[]}}},89077:function(e,t,n){n.d(t,{FX:function(){return m},cj:function(){return d},jb:function(){return f}});var r=n(60092),i=n(72428),o=n(39010),a=n(78878),s=n(51984),c=n(4625),l=n(13761),u=n(85893),d={DONE:"done",NEW:"new",IN_PROGRESS:"inprogress",TO_DO:"todo",BLOCKED:"blocked"},p={URGENT:"urgent",HIGH:"high",NORMAL:"normal",LOW:"low"},f=[{value:d.NEW,label:"New",icon:(0,u.jsx)(i.Z,{color:"white"}),color:r.Q.COLOUR.white,bgcolor:"#83BBDC"},{value:d.TO_DO,label:"To do",icon:(0,u.jsx)(o.Z,{color:"white"}),color:r.Q.COLOUR.white,bgcolor:r.Q.COLOUR.secondary},{value:d.IN_PROGRESS,label:"In progress",icon:(0,u.jsx)(a.Z,{color:"white"}),color:r.Q.COLOUR.white,bgcolor:r.Q.COLOUR.info},{value:d.DONE,label:"Done",icon:(0,u.jsx)(s.Z,{color:"white"}),color:r.Q.COLOUR.white,bgcolor:r.Q.COLOUR.success},{value:d.BLOCKED,label:"Blocked",icon:(0,u.jsx)(c.Z,{color:"white"}),color:r.Q.COLOUR.white,bgcolor:r.Q.COLOUR.danger}],m=[{value:p.URGENT,label:"Urgent",icon:(0,u.jsx)(l.Z,{color:"danger"})},{value:p.HIGH,label:"High",icon:(0,u.jsx)(l.Z,{color:"info"})},{value:p.NORMAL,label:"Normal",icon:(0,u.jsx)(l.Z,{color:"secondary"})},{value:p.LOW,label:"Low",icon:(0,u.jsx)(l.Z,{color:"muiGray"})}]}}]);