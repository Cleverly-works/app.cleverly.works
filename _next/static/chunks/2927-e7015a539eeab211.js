"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2927],{92927:function(e,t,n){n.d(t,{H:function(){return ex}});var i,o,r,s,a,u,l,c=n(59499),d=n(50029),m=n(16835),p=n(64687),h=n.n(p),x=n(67294),b=n(6812),f=n(50319),j=n(71383),R=n(75063),v=(0,R.Ps)(i||(i=(0,j.Z)(['\n  query GetSlas(\n    $subtype: sla_subtype\n    $entity: String\n    $entityId: Int\n    $isEntity: Boolean!\n    $isLocation: Boolean!\n    $customerId: Int\n    $limit: Int\n    $offset: Int\n    $q: String\n    $orderBy: SLA_order_by!\n  ) {\n    slas: SLA(\n      limit: $limit\n      offset: $offset\n      where: { subtype: { _eq: $subtype }, name: { _ilike: $q } }\n      order_by: [$orderBy]\n    ) {\n      id\n      subtype\n      name\n      notes\n      normalRate\n      oohRate\n      premiumRate\n      minimumInterval\n      minimumLength\n      quoteReturned\n      quoteReturnedUnit\n      onSite\n      onSiteUnit\n      jobReport\n      jobReportUnit\n      completion\n      completionUnit\n      status\n      isDefault\n      customerSla: SLA_Entities(\n        where: { entity: { _eq: "Account" }, entityId: { _eq: $customerId } }\n      ) @include(if: $isLocation) {\n        status\n        id\n        entity\n        entityId\n        quoteReturned\n        quoteReturnedUnit\n        onSite\n        onSiteUnit\n        jobReport\n        jobReportUnit\n        completion\n        completionUnit\n        notes\n        inUse\n        normalRate\n        oohRate\n        premiumRate\n        minimumInterval\n        minimumLength\n        slaId\n      }\n      entities: SLA_Entities(\n        where: { entity: { _eq: $entity }, entityId: { _eq: $entityId } }\n        order_by: { slaId: asc }\n      ) @include(if: $isEntity) {\n        status\n        id\n        entity\n        entityId\n        quoteReturned\n        quoteReturnedUnit\n        onSite\n        onSiteUnit\n        jobReport\n        jobReportUnit\n        completion\n        completionUnit\n        notes\n        inUse\n        normalRate\n        oohRate\n        premiumRate\n        minimumInterval\n        minimumLength\n        slaId\n      }\n    }\n    meta: SLA_aggregate(where: { subtype: { _eq: $subtype }, name: { _ilike: $q } }) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n']))),y=(0,R.Ps)(o||(o=(0,j.Z)(["\n  query GetSla($id: Int!) {\n    sla: SLA_by_pk(id: $id) {\n      id\n      subtype\n      name\n      notes\n      normalRate\n      oohRate\n      premiumRate\n      minimumInterval\n      minimumLength\n      quoteReturned\n      quoteReturnedUnit\n      onSite\n      onSiteUnit\n      jobReport\n      jobReportUnit\n      completion\n      completionUnit\n      status\n      isDefault\n    }\n  }\n"]))),Z=(0,R.Ps)(r||(r=(0,j.Z)(["\n  mutation AddSla($objects: [SLA_insert_input!]!) {\n    insert_SLA(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]))),S=(0,R.Ps)(s||(s=(0,j.Z)(["\n  mutation UpdateSla($id: Int!, $changes: SLA_set_input) {\n    update_SLA_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"]))),g=(0,R.Ps)(a||(a=(0,j.Z)(["\n  query GetSlaEntity($id: Int!, $slaEntityId: Int, $hasEntity: Boolean!) {\n    sla: SLA_by_pk(id: $id) {\n      id\n      subtype\n      name\n      notes\n      normalRate\n      oohRate\n      premiumRate\n      minimumInterval\n      minimumLength\n      quoteReturned\n      quoteReturnedUnit\n      onSite\n      onSiteUnit\n      jobReport\n      jobReportUnit\n      completion\n      completionUnit\n      status\n      slaEntity: SLA_Entities(where: { id: { _eq: $slaEntityId } }) @include(if: $hasEntity) {\n        id\n        notes\n        normalRate\n        oohRate\n        premiumRate\n        minimumInterval\n        minimumLength\n        quoteReturned\n        quoteReturnedUnit\n        onSite\n        onSiteUnit\n        jobReport\n        jobReportUnit\n        completion\n        completionUnit\n        status\n      }\n    }\n  }\n"]))),U=(0,R.Ps)(u||(u=(0,j.Z)(["\n  mutation addSla($objects: [SLA_Entity_insert_input!]!) {\n    insert_SLA_Entity(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]))),w=(0,R.Ps)(l||(l=(0,j.Z)(["\n  mutation UpdateSla($id: Int!, $changes: SLA_Entity_set_input) {\n    update_SLA_Entity_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"]))),q=n(42283),O=n(79665),_=n(76600),$=n(9270),I=n(62140),D=n(49501),E=n(55563),P=n(95103),C=n(6710),F=n(33006),k=n(58594),L=n(74231),N=(0,L.Ry)().shape({name:(0,L.Z_)().required(),status:(0,L.Z_)().oneOf(["active","inactive"]).required(),normalRate:(0,L.Rx)().when("$subtype",{is:function(e){return"reactive"===e},then:function(){return(0,L.Rx)().min(0).required()}}),oohRate:(0,L.Rx)().when("$subtype",{is:function(e){return"reactive"===e},then:function(){return(0,L.Rx)().min(0).required()}}),premiumRate:(0,L.Rx)().when("$subtype",{is:function(e){return"reactive"===e},then:function(){return(0,L.Rx)().min(0).required()}}),onSite:(0,L.Rx)().when("$subtype",{is:function(e){return"reactive"===e},then:function(){return(0,L.Rx)().min(0).required()}}),onSiteUnit:(0,L.Z_)().when("$subtype",{is:function(e){return"reactive"===e},then:function(){return(0,L.Z_)().oneOf(["minutes","hours","days"]).required()}}),jobReport:(0,L.Rx)().when("$subtype",{is:function(e){return"reactive"===e},then:function(){return(0,L.Rx)().min(0).required()}}),jobReportUnit:(0,L.Z_)().when("$subtype",{is:function(e){return"reactive"===e},then:function(){return(0,L.Z_)().oneOf(["minutes","hours","days"]).required()}}),completion:(0,L.Rx)().when("$subtype",{is:function(e){return"reactive"===e},then:function(){return(0,L.Rx)().min(0).required()}}),completionUnit:(0,L.Z_)().when("$subtype",{is:function(e){return"reactive"===e},then:function(){return(0,L.Z_)().oneOf(["minutes","hours","days"]).required()}}),quoteReturned:(0,L.Rx)().when("$subtype",{is:function(e){return"quote"===e},then:function(){return(0,L.Rx)().min(0).required()}}),quoteReturnedUnit:(0,L.Z_)().when("$subtype",{is:function(e){return"quote"===e},then:function(){return(0,L.Z_)().oneOf(["minutes","hours","days"]).required()}}),group:(0,L.Rx)()}),A=(0,L.Ry)().shape({status:(0,L.Z_)().oneOf(["active","inactive"]).required(),normalRate:(0,L.Rx)().when("$subtype",{is:function(e){return"reactive"===e},then:function(){return(0,L.Rx)().min(0).required()}}),oohRate:(0,L.Rx)().when("$subtype",{is:function(e){return"reactive"===e},then:function(){return(0,L.Rx)().min(0).required()}}),premiumRate:(0,L.Rx)().when("$subtype",{is:function(e){return"reactive"===e},then:function(){return(0,L.Rx)().min(0).required()}}),onSite:(0,L.Rx)().when("$subtype",{is:function(e){return"reactive"===e},then:function(){return(0,L.Rx)().min(0).required()}}),onSiteUnit:(0,L.Z_)().when("$subtype",{is:function(e){return"reactive"===e},then:function(){return(0,L.Z_)().oneOf(["minutes","hours","days"]).required()}}),jobReport:(0,L.Rx)().when("$subtype",{is:function(e){return"reactive"===e},then:function(){return(0,L.Rx)().min(0).required()}}),jobReportUnit:(0,L.Z_)().when("$subtype",{is:function(e){return"reactive"===e},then:function(){return(0,L.Z_)().oneOf(["minutes","hours","days"]).required()}}),completion:(0,L.Rx)().when("$subtype",{is:function(e){return"reactive"===e},then:function(){return(0,L.Rx)().min(0).required()}}),completionUnit:(0,L.Z_)().when("$subtype",{is:function(e){return"reactive"===e},then:function(){return(0,L.Z_)().oneOf(["minutes","hours","days"]).required()}}),quoteReturned:(0,L.Rx)().when("$subtype",{is:function(e){return"quote"===e},then:function(){return(0,L.Rx)().min(0).required()}}),quoteReturnedUnit:(0,L.Z_)().when("$subtype",{is:function(e){return"quote"===e},then:function(){return(0,L.Z_)().oneOf(["minutes","hours","days"]).required()}})}),H=function(e,t,n){return"quote"===t?{type:"priority",subtype:t,name:e.name,status:e.status,notes:e.notes,quoteReturned:e.quoteReturned,quoteReturnedUnit:e.quoteReturnedUnit,adminId:n}:{type:"priority",subtype:t,name:e.name,status:e.status,notes:e.notes,isDefault:e.isDefault,normalRate:parseFloat(e.normalRate).toFixed(1),oohRate:parseFloat(e.oohRate).toFixed(1),premiumRate:parseFloat(e.premiumRate).toFixed(1),onSite:e.onSite,onSiteUnit:e.onSiteUnit,jobReport:e.jobReport,jobReportUnit:e.jobReportUnit,completion:e.completion,completionUnit:e.completionUnit,adminId:n}},G=n(72936),M=n(26380),Q=n(10367),B=n(26447),T=n(98456),J=n(85893);function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function W(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach(function(t){(0,c.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var Y=function(e){var t,n=e.id,i=e.subtype,o=e.close,r=e.slas,s=(0,G.x)().user,a=(0,q.cI)({defaultValues:{status:"active"},resolver:(0,O.S)(N)}),u=a.errors,l=a.handleSubmit,c=a.register,p=a.reset,x=(0,b.a)(y,{skip:!n,variables:{id:n},onCompleted:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{sla:{}};p(e.sla)}}).loading,j=(0,f.D)(Z,{refetchQueries:["GetSla","GetSlas"],onCompleted:function(){o&&o()}}),R=(0,m.Z)(j,2),v=R[0],g=R[1].loading,U=(0,f.D)(S,{refetchQueries:["GetSla","GetSlas"],onCompleted:function(){o&&o()}}),w=(0,m.Z)(U,2),L=w[0],A=w[1].loading,Q=(t=(0,d.Z)(h().mark(function e(t){var o,a;return h().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((a=null!==(o=r.find(function(e){return e.isDefault}))&&void 0!==o?o:null)&&L({variables:{id:a.id,changes:W(W({},H(a,"reactive",s.adminId)),{},{isDefault:!1})}}),!n){e.next=7;break}return e.next=5,L({variables:{id:n,changes:H(t,i,s.adminId)}});case 5:e.next=9;break;case 7:return e.next=9,v({variables:{objects:[H(t,i,s.adminId)]}});case 9:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),V={errors:u,register:c},Y={errors:u,min:0,register:c,type:"number"};return x||g||A?(0,J.jsx)(B.Z,{alignItems:"center",children:(0,J.jsx)(T.Z,{color:"secondary"})}):"quote"===i?(0,J.jsxs)(_.Z,{id:"offCanvasForm",handleSubmit:l(Q),children:[(0,J.jsxs)($.Z,{children:[(0,J.jsxs)(I.Z,{md:4,children:[(0,J.jsx)(D.Z,{label:"Name",children:(0,J.jsx)(E.Z,W(W({},V),{},{name:"name"}))}),(0,J.jsx)(D.Z,{label:"Status",children:(0,J.jsx)(P.Z,W(W({},V),{},{name:"status",options:M.bg}))})]}),(0,J.jsx)(I.Z,{md:8,children:(0,J.jsx)(D.Z,{label:"Notes",children:(0,J.jsx)(C.Z,W(W({},V),{},{name:"notes",rows:2}))})})]}),(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(F.Z,{content:"Timings",tag:"h3"}),(0,J.jsx)($.Z,{children:(0,J.jsx)(I.Z,{md:4,children:(0,J.jsx)(D.Z,{label:"Quote Returned",children:(0,J.jsxs)(z,{children:[(0,J.jsx)(E.Z,W(W({},V),{},{name:"quoteReturned",type:"number",min:0})),(0,J.jsx)(P.Z,W(W({},V),{},{name:"quoteReturnedUnit",label:"",options:[{text:"Select",value:""},{text:"Minutes",value:"minutes"},{text:"Hours",value:"hours"},{text:"Days",value:"days"}]}))]})})})})]})]}):(0,J.jsxs)(_.Z,{id:"offCanvasForm",handleSubmit:l(Q),children:[(0,J.jsxs)($.Z,{children:[(0,J.jsxs)(I.Z,{md:4,children:[(0,J.jsx)(D.Z,{label:"Name",children:(0,J.jsx)(E.Z,W(W({},V),{},{name:"name"}))}),(0,J.jsx)(D.Z,{label:"Status",children:(0,J.jsx)(P.Z,W(W({},V),{},{name:"status",options:M.bg}))})]}),(0,J.jsxs)(I.Z,{md:8,children:[(0,J.jsx)(D.Z,{label:"Notes",children:(0,J.jsx)(C.Z,W(W({},V),{},{name:"notes",rows:2}))}),(0,J.jsx)(D.Z,{label:"Select as default sla",children:(0,J.jsx)(k.Z,W(W({},V),{},{name:"isDefault",data:[{label:"isDefault",key:"isDefault",value:!0}]}))})]})]}),(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(F.Z,{content:"Default Rates",tag:"h3"}),(0,J.jsxs)($.Z,{children:[(0,J.jsx)(I.Z,{md:4,children:(0,J.jsx)(D.Z,{label:"Normal Rate",children:(0,J.jsx)(E.Z,W(W({},Y),{},{name:"normalRate",step:"0.01"}))})}),(0,J.jsx)(I.Z,{md:4,children:(0,J.jsx)(D.Z,{label:"Out Of Hours Rate",children:(0,J.jsx)(E.Z,W(W({},Y),{},{name:"oohRate",step:"0.01"}))})}),(0,J.jsx)(I.Z,{md:4,children:(0,J.jsx)(D.Z,{label:"Premium Rate",children:(0,J.jsx)(E.Z,W(W({},Y),{},{name:"premiumRate",step:"0.01"}))})})]})]}),(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(F.Z,{content:"Timings",tag:"h3"}),(0,J.jsxs)($.Z,{children:[(0,J.jsx)(I.Z,{md:4,children:(0,J.jsx)(D.Z,{label:"On Site",children:(0,J.jsxs)(z,{children:[(0,J.jsx)(E.Z,W(W({},V),{},{name:"onSite",type:"number",min:0})),(0,J.jsx)(P.Z,W(W({},V),{},{name:"onSiteUnit",label:"",options:[{text:"Select",value:""},{text:"Minutes",value:"minutes"},{text:"Hours",value:"hours"},{text:"Days",value:"days"}]}))]})})}),(0,J.jsx)(I.Z,{md:4,children:(0,J.jsx)(D.Z,{label:"Job Report",children:(0,J.jsxs)(z,{children:[(0,J.jsx)(E.Z,W(W({},V),{},{name:"jobReport",type:"number",min:0})),(0,J.jsx)(P.Z,W(W({},V),{},{name:"jobReportUnit",label:"",options:[{text:"Select",value:""},{text:"Minutes",value:"minutes"},{text:"Hours",value:"hours"},{text:"Days",value:"days"}]}))]})})}),(0,J.jsx)(I.Z,{md:4,children:(0,J.jsx)(D.Z,{label:"Completion",children:(0,J.jsxs)(z,{children:[(0,J.jsx)(E.Z,W(W({},V),{},{name:"completion",type:"number",min:0})),(0,J.jsx)(P.Z,W(W({},V),{},{name:"completionUnit",label:"",options:[{text:"Select",value:""},{text:"Minutes",value:"minutes"},{text:"Hours",value:"hours"},{text:"Days",value:"days"}]}))]})})})]})]})]})},z=Q.ZP.div.withConfig({displayName:"slaForm__StyledOption",componentId:"sc-1og56ul-0"})(["display:flex;max-width:180px;& input{margin-right:5px;text-align:center;width:70px;}& select{width:90px;}"]);Y.defaultProps={close:function(){}};var K=n(42846),X=n(72852),ee=n(90629),et=n(46901),en=n(15861),ei=n(11057),eo=n(32836),er=n(58095),es=n(26143);function ea(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function eu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ea(Object(n),!0).forEach(function(t){(0,c.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ea(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var el=function(e){var t=e.subtype,n=e.id,i=e.slaEntityId,o=e.entity,r=e.entityId,s=e.close,a=(0,q.cI)({defaultValues:{status:"active"},context:{subtype:t},resolver:(0,O.S)(A)}),u=a.errors,l=a.handleSubmit,c=a.register,p=a.reset,j=(0,b.a)(g,{variables:{id:n,slaEntityId:i,hasEntity:!!i}}),R=j.data,v=(R=void 0===R?{sla:{}}:R).sla,y=j.loading;(0,x.useEffect)(function(){var e;i&&null!==(e=v.slaEntity)&&void 0!==e&&e[0]&&p(v.slaEntity[0])},[v]);var Z,S=(0,f.D)(U,{refetchQueries:["GetSlaEntity","GetSlas"],onCompleted:function(){s&&s()}}),k=(0,m.Z)(S,2),L=k[0],N=k[1].loading,H=(0,f.D)(w,{refetchQueries:["GetSlaEntity","GetSlas"],onCompleted:function(){s&&s()}}),G=(0,m.Z)(H,2),Q=G[0],V=G[1].loading,W=(Z=(0,d.Z)(h().mark(function e(s){var a;return h().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:var u,l;if(a="quote"===t?{inUse:"active"===s.status,status:s.status,notes:s.notes,quoteReturned:s.quoteReturned,quoteReturnedUnit:s.quoteReturnedUnit}:{inUse:"active"===s.status,status:s.status,notes:s.notes,normalRate:parseFloat(s.normalRate).toFixed(1),oohRate:parseFloat(s.oohRate).toFixed(1),premiumRate:parseFloat(s.premiumRate).toFixed(1),onSite:s.onSite,onSiteUnit:s.onSiteUnit,jobReport:s.jobReport,jobReportUnit:s.jobReportUnit,completion:s.completion,completionUnit:s.completionUnit},!i){e.next=6;break}return e.next=4,Q({variables:{id:i,changes:a}});case 4:e.next=8;break;case 6:return e.next=8,L({variables:{objects:[eu(eu({},a),{},{slaId:n,entity:o,entityId:r})]}});case 8:case"end":return e.stop()}},e)})),function(e){return Z.apply(this,arguments)}),Y={errors:u,register:c},z={errors:u,min:0,register:c,type:"number"};return y||N||V?(0,J.jsx)(B.Z,{alignItems:"center",children:(0,J.jsx)(T.Z,{color:"secondary"})}):"quote"===t?(0,J.jsxs)(_.Z,{id:"offCanvasForm",handleSubmit:l(W),children:[(0,J.jsxs)($.Z,{children:[(0,J.jsxs)(I.Z,{md:4,children:[(0,J.jsx)(F.Z,{content:"SLA: ".concat(v.name),tag:"h2"}),(0,J.jsx)(D.Z,{label:"Status",children:(0,J.jsx)(P.Z,eu(eu({},Y),{},{name:"status",options:M.bg}))})]}),(0,J.jsx)(I.Z,{md:8,children:(0,J.jsx)(D.Z,{label:"Notes",children:(0,J.jsx)(C.Z,eu(eu({},Y),{},{name:"notes",rows:2}))})})]}),(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(F.Z,{content:"Timings",tag:"h3"}),(0,J.jsx)($.Z,{children:(0,J.jsx)(I.Z,{md:4,children:(0,J.jsx)(D.Z,{label:"Quote Returned",children:(0,J.jsxs)(ec,{children:[(0,J.jsx)(E.Z,eu(eu({},Y),{},{name:"quoteReturned",type:"number",min:0})),(0,J.jsx)(P.Z,eu(eu({},Y),{},{name:"quoteReturnedUnit",label:"",options:[{text:"Select",value:""},{text:"Minutes",value:"minutes"},{text:"Hours",value:"hours"},{text:"Days",value:"days"}]}))]})})})})]})]}):(0,J.jsxs)(_.Z,{id:"offCanvasForm",handleSubmit:l(W),children:[(0,J.jsxs)($.Z,{children:[(0,J.jsxs)(I.Z,{md:4,children:[(0,J.jsx)(F.Z,{content:"SLA: ".concat(v.name),tag:"h2"}),(0,J.jsx)(D.Z,{label:"Status",children:(0,J.jsx)(P.Z,eu(eu({},Y),{},{name:"status",options:M.bg}))})]}),(0,J.jsx)(I.Z,{md:8,children:(0,J.jsx)(D.Z,{label:"Notes",children:(0,J.jsx)(C.Z,eu(eu({},Y),{},{name:"notes",rows:2}))})})]}),(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(F.Z,{content:"Default Rates",tag:"h3"}),(0,J.jsxs)($.Z,{children:[(0,J.jsx)(I.Z,{md:4,children:(0,J.jsx)(D.Z,{label:"Normal Rate",children:(0,J.jsx)(E.Z,eu(eu({},z),{},{name:"normalRate",step:"0.01"}))})}),(0,J.jsx)(I.Z,{md:4,children:(0,J.jsx)(D.Z,{label:"Out Of Hours Rate",children:(0,J.jsx)(E.Z,eu(eu({},z),{},{name:"oohRate",step:"0.01"}))})}),(0,J.jsx)(I.Z,{md:4,children:(0,J.jsx)(D.Z,{label:"Premium Rate",children:(0,J.jsx)(E.Z,eu(eu({},z),{},{name:"premiumRate",step:"0.01"}))})})]})]}),(0,J.jsxs)(J.Fragment,{children:[(0,J.jsx)(F.Z,{content:"Timings",tag:"h3"}),(0,J.jsxs)($.Z,{children:[(0,J.jsx)(I.Z,{md:4,children:(0,J.jsx)(D.Z,{label:"On Site",children:(0,J.jsxs)(ec,{children:[(0,J.jsx)(E.Z,eu(eu({},Y),{},{name:"onSite",type:"number",min:0})),(0,J.jsx)(P.Z,eu(eu({},Y),{},{name:"onSiteUnit",label:"",options:[{text:"Select",value:""},{text:"Minutes",value:"minutes"},{text:"Hours",value:"hours"},{text:"Days",value:"days"}]}))]})})}),(0,J.jsx)(I.Z,{md:4,children:(0,J.jsx)(D.Z,{label:"Job Report",children:(0,J.jsxs)(ec,{children:[(0,J.jsx)(E.Z,eu(eu({},Y),{},{name:"jobReport",type:"number",min:0})),(0,J.jsx)(P.Z,eu(eu({},Y),{},{name:"jobReportUnit",label:"",options:[{text:"Select",value:""},{text:"Minutes",value:"minutes"},{text:"Hours",value:"hours"},{text:"Days",value:"days"}]}))]})})}),(0,J.jsx)(I.Z,{md:4,children:(0,J.jsx)(D.Z,{label:"Completion",children:(0,J.jsxs)(ec,{children:[(0,J.jsx)(E.Z,eu(eu({},Y),{},{name:"completion",type:"number",min:0})),(0,J.jsx)(P.Z,eu(eu({},Y),{},{name:"completionUnit",label:"",options:[{text:"Select",value:""},{text:"Minutes",value:"minutes"},{text:"Hours",value:"hours"},{text:"Days",value:"days"}]}))]})})})]})]})]})},ec=Q.ZP.div.withConfig({displayName:"slaEntityForm__StyledOption",componentId:"sc-1qk9si7-0"})(["display:flex;max-width:180px;& input{margin-right:5px;text-align:center;width:70px;}& select{width:90px;}"]);el.defaultProps={close:function(){}};var ed=function(e){var t=e.row,n=e.item,i=e.subtype,o=e.checked;return"quote"===i?{inUse:o,status:o?"active":"inactive",notes:(null==n?void 0:n.notes)||t.notes,quoteReturned:(null==n?void 0:n.quoteReturned)||t.quoteReturned,quoteReturnedUnit:(null==n?void 0:n.quoteReturnedUnit)||t.quoteReturnedUnit}:{inUse:o,status:o?"active":"inactive",notes:(null==n?void 0:n.notes)||t.notes,normalRate:parseFloat((null==n?void 0:n.normalRate)||t.normalRate).toFixed(1),oohRate:parseFloat((null==n?void 0:n.oohRate)||t.oohRate).toFixed(1),premiumRate:parseFloat((null==n?void 0:n.premiumRate)||t.premiumRate).toFixed(1),onSite:(null==n?void 0:n.onSite)||t.onSite,onSiteUnit:(null==n?void 0:n.onSiteUnit)||t.onSiteUnit,jobReport:(null==n?void 0:n.jobReport)||t.jobReport,jobReportUnit:(null==n?void 0:n.jobReportUnit)||t.jobReportUnit,completion:(null==n?void 0:n.completion)||t.completion,completionUnit:(null==n?void 0:n.completionUnit)||t.completionUnit}};function em(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}function ep(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?em(Object(n),!0).forEach(function(t){(0,c.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):em(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var eh={item:"name",order:"asc"},ex=function(e){var t,n=e.title,i=e.subtype,o=e.isEntity,r=e.isLocation,s=e.customerId,a=e.entity,u=e.entityId,l=e.tableHeight,c=e.containerHeight,p=(0,er.a)(),j=(0,(0,G.x)().hasRole)("admin"),R=(0,K.x)({filters:{},initialSort:eh}),y=R.initialData,Z=R.ref,S=(0,b.a)(v,{variables:ep(ep({},y),{},{subtype:i,isEntity:o,isLocation:r,customerId:s,entity:a,entityId:u})}),g=S.data,q=(g=void 0===g?{slas:[],meta:{aggregate:{totalCount:0}}}:g).slas,O=g.meta,_=S.loading,$=S.refetch,I=(0,f.D)(U,{refetchQueries:["GetSlas"]}),D=(0,m.Z)(I,2),E=D[0],P=D[1].loading,C=(0,f.D)(w,{refetchQueries:["GetSlas"]}),F=(0,m.Z)(C,2),k=F[0],L=F[1].loading,N=function(e){e.stopPropagation(),p.show({content:(0,J.jsx)(Y,{subtype:i,close:p.close,slas:q}),title:"Add SLA",xs3:"100vw",sm:"100vw",sm2:"100vw",sm3:"50vw",md2:"50vw",lg:"50vw",lg2:"50vw"})},A=(0,x.useCallback)(function(e){if(o){var t;p.show({content:(0,J.jsx)(el,{subtype:i,id:e.id,slaEntityId:null===(t=e.entity)||void 0===t?void 0:t.id,entity:a,entityId:u,close:p.close}),title:"Edit SLA",xs3:"100vw",sm:"100vw",sm2:"100vw",sm3:"50vw",md2:"50vw",lg:"50vw",lg2:"50vw"})}else p.show({content:(0,J.jsx)(Y,{subtype:i,id:e.id,close:p.close,slas:q}),title:"Edit SLA",xs3:"100vw",sm:"100vw",sm2:"100vw",sm3:"50vw",md2:"50vw",lg:"50vw",lg2:"50vw"})},[a,u,o,p,i,q]),H=(0,x.useCallback)(function(e){var t=[];return t.push({icon:"edit",onClick:function(t){t.stopPropagation(),A(e)},tooltip:"Edit"}),t},[A]),M=(0,x.useCallback)((t=(0,d.Z)(h().mark(function e(t,n,o){var r,s;return h().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.stopPropagation(),r=o.entity,s=ed({row:o,item:r,subtype:i,entity:a,entityId:u,checked:n}),!r){e.next=8;break}return e.next=6,k({variables:{id:r.id,changes:s}});case 6:e.next=10;break;case 8:return e.next=10,E({variables:{objects:[ep(ep({},s),{},{slaId:o.id,entity:a,entityId:u})]}});case 10:case"end":return e.stop()}},e)})),function(e,n,i){return t.apply(this,arguments)}),[E,a,u,i,k]),Q=(0,x.useCallback)(function(e){var t,n,i,o,s=e.row,a="boolean"!=typeof(null===(t=s.entity)||void 0===t?void 0:t.inUse)||(null===(n=s.entity)||void 0===n?void 0:n.inUse),u=!!r&&!(null!==(i=s.customerEntity)&&void 0!==i&&null!==(o=i[0])&&void 0!==o&&o.inUse);return(0,J.jsx)(X.Z,{color:"secondary",disabled:u,checked:a,onChange:function(e,t){return M(e,t,s)}})},[M,r]),T=(0,x.useMemo)(function(){return[{flex:1,field:"name",headerName:"Name"},{flex:1,headerName:"Is default SLA",field:"isDefault",valueFormatter:function(e){return e.value?"Yes":"No"}},{flex:1,field:"inUse",headerName:"In Use",renderCell:Q},{flex:1,field:"normalRate",headerName:"Normal",renderCell:function(e){return parseFloat(e.row.normalRate).toFixed(1)+"x"}},{flex:1,field:"oohRate",headerName:"OOH",renderCell:function(e){return parseFloat(e.row.oohRate).toFixed(1)+"x"}},{flex:1,field:"premiumRate",headerName:"Premium",renderCell:function(e){return parseFloat(e.row.premiumRate).toFixed(1)+"x"}},{flex:1,field:"quoteReturned",headerName:"Quote returned",renderCell:function(e){var t=e.row;return t.quoteReturned?"".concat(t.quoteReturned," ").concat(t.quoteReturnedUnit):"-"}},{flex:1,field:"onSite",headerName:"On Site",sortable:!1,renderCell:function(e){var t=e.row;return t.onSite?"".concat(t.onSite," ").concat(t.onSiteUnit):"-"}},{flex:1,field:"jobReport",headerName:"Job Report",sortable:!1,renderCell:function(e){var t=e.row;return t.jobReport?"".concat(t.jobReport," ").concat(t.jobReportUnit):"-"}},{flex:1,field:"completion",headerName:"Completion",sortable:!1,renderCell:function(e){var t=e.row;return t.completion?"".concat(t.completion," ").concat(t.completionUnit):"-"}},{flex:1,field:"status",headerName:"Status",sortable:!1},{flex:1,field:"notes",headerName:"Notes",sortable:!1},{width:50,field:"actions",headerName:"Actions",sortable:!1,renderCell:function(e){var t,n,i=e.row,o=!!r&&!(null!==(t=i.customerEntity)&&void 0!==t&&null!==(n=t[0])&&void 0!==n&&n.inUse);return(0,J.jsx)(es.C,{disabled:o,row:i,actionsData:H})}}]},[H,r,Q,q]),V=(0,x.useMemo)(function(){return q.map(function(e){if(o&&null!==(t=e.entities)&&void 0!==t&&t[0]){var t,n,i=e.entities[0];return{id:e.id,name:e.name,normalRate:i.normalRate,oohRate:i.oohRate,premiumRate:i.premiumRate,quoteReturned:i.quoteReturned,quoteReturnedUnit:i.quoteReturnedUnit,onSite:i.onSite,onSiteUnit:i.onSiteUnit,jobReport:i.jobReport,jobReportUnit:i.jobReportUnit,completion:i.completion,completionUnit:i.completionUnit,status:i.status,notes:i.notes||"-",entity:i,customerEntity:e.customerSla,actions:""}}var r=null===(n=e.customerSla)||void 0===n?void 0:n[0];return{id:e.id,name:e.name,normalRate:(null==r?void 0:r.normalRate)||e.normalRate,oohRate:(null==r?void 0:r.oohRate)||e.oohRate,premiumRate:(null==r?void 0:r.premiumRate)||e.premiumRate,quoteReturned:(null==r?void 0:r.quoteReturned)||e.quoteReturned,quoteReturnedUnit:(null==r?void 0:r.quoteReturnedUnit)||e.quoteReturnedUnit,onSite:(null==r?void 0:r.onSite)||e.onSite,onSiteUnit:(null==r?void 0:r.onSiteUnit)||e.onSiteUnit,jobReport:(null==r?void 0:r.jobReport)||e.jobReport,jobReportUnit:(null==r?void 0:r.jobReportUnit)||e.jobReportUnit,completion:(null==r?void 0:r.completion)||e.completion,completionUnit:(null==r?void 0:r.completionUnit)||e.completionUnit,status:(null==r?void 0:r.status)||e.status,notes:(null==r?void 0:r.notes)||e.notes||"-",entity:null,customerEntity:e.customerSla,actions:"",isDefault:e.isDefault}})},[JSON.stringify(q)]);return(0,J.jsxs)(ee.Z,{sx:{paddingTop:"16px",paddingBottom:"16px",height:c},children:[r&&(0,J.jsx)(et.Z,{color:"info",variant:"filled",sx:{ml:2,mr:2,mb:2},children:"In order to set up location SLAs, you must first add or confirm the appropriate customer SLA for that priority level."}),(0,J.jsxs)(B.Z,{direction:"row",justifyContent:"space-between",children:[(0,J.jsx)(en.Z,{ml:2,variant:"h5",sx:{fontWeight:600},children:n}),!o&&(0,J.jsx)(ei.Z,{sx:{mr:2},variant:"contained",color:"secondary",onClick:N,children:"Create SLA"})]}),(0,J.jsx)(eo.i,{autoHeight:!1,loading:_||P||L,ref:Z,columns:T,rows:V,meta:O,refetch:$,initialSort:eh,containerHeight:l,columnVisibilityModel:{name:!0,isDefault:!o,inUse:j&&o,normalRate:"reactive"===i,oohRate:"reactive"===i,premiumRate:"reactive"===i,quoteReturned:"quote"===i,onSite:"reactive"===i,jobReport:"reactive"===i,completion:"reactive"===i,status:o,notes:!0,actions:j}})]})};ex.defaultProps={isEntity:!1,isLocation:!1,containerHeight:"calc(100vh - 100px)",tableHeight:"calc(100% - 32px)"}}}]);