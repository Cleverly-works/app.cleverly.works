(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1617],{92264:function(e,t,n){"use strict";n.d(t,{H:function(){return u}});var a=n(59499),s=n(55377),o=n(16551),i=n(77439),l=n(85893);function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}var u=function(e){var t=e.children,n=e.content,u=e.context,c=e.data,p=e.disabled,d=e.handleClick,m=e.size,b=e.type;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s.Z,{size:"sm"}),(0,l.jsxs)(o.Z,{align:"flex-end",children:[t,(0,l.jsx)(i.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){(0,a.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({content:n,context:u,disabled:p,onClick:d,size:m,type:b},c))]})]})};u.defaultProps={content:"Add",context:"secondary",disabled:!1,size:"sm",type:"button"}},69496:function(e,t,n){"use strict";n.d(t,{$E:function(){return _},AX:function(){return w},I4:function(){return S},JA:function(){return P},MT:function(){return U},Px:function(){return x},WF:function(){return C},ZA:function(){return H},a8:function(){return A},fA:function(){return q},fo:function(){return I},ge:function(){return B},iM:function(){return Z},nE:function(){return J},nh:function(){return O},r1:function(){return D},tW:function(){return $},uz:function(){return N}});var a,s,o,i,l,r,u,c,p,d,m,b,y,f,h,g,T,j,k=n(71383),v=n(75063),S=(0,v.Ps)(a||(a=(0,k.Z)(["\n  mutation InsertAccountUser($objects: [Account_User_insert_input!]!) {\n    insert_Account_User(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]))),w=(0,v.Ps)(s||(s=(0,k.Z)(["\n  mutation UpdateUser(\n    $id: Int!\n    $accountUserId: Int!\n    $accountUserChanges: Account_User_set_input\n    $changes: User_set_input\n    $updateAccountUser: Boolean!\n  ) {\n    update_Account_User_by_pk(pk_columns: { id: $accountUserId }, _set: $accountUserChanges)\n      @include(if: $updateAccountUser) {\n      id\n    }\n    update_User_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"]))),I=(0,v.Ps)(o||(o=(0,k.Z)(["\n  query GetUsers(\n    $accountId: Int\n    $accountType: String\n    $date: timestamptz\n    $limit: Int\n    $offset: Int\n    $q: String\n    $orderBy: User_order_by!\n    $status: String\n  ) {\n    users: User(\n      limit: $limit\n      offset: $offset\n      where: {\n        Account_Users: { Account: { id: { _eq: $accountId }, type: { _eq: $accountType } } }\n        createdAt: { _eq: $date }\n        _or: [\n          { email: { _ilike: $q } }\n          { nameFirst: { _ilike: $q } }\n          { nameLast: { _ilike: $q } }\n        ]\n        status: { _eq: $status }\n      }\n      order_by: [$orderBy]\n    ) {\n      id\n      name: nameFirst\n      nameFirst\n      nameLast\n      phone\n      status\n      email\n      createdAt\n      meta\n      invoiceThreshold\n      quoteThreshold\n      media: Media {\n        id\n        medium: Medium {\n          id\n          category\n          filename\n          meta\n          type\n        }\n      }\n      accounts: Account_Users {\n        id\n        role\n        position\n        isContact\n        status\n        account: Account {\n          id\n          name\n          type\n        }\n        userLocations: User_Account_Locations {\n          accountLocationId\n        }\n      }\n    }\n    meta: User_aggregate(\n      where: {\n        Account_Users: { Account: { id: { _eq: $accountId }, type: { _eq: $accountType } } }\n        createdAt: { _eq: $date }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n        status: { _eq: $status }\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n"]))),P=(0,v.Ps)(i||(i=(0,k.Z)(["\n  query GetUser($id: Int!) {\n    user: User_by_pk(id: $id) {\n      id\n      fullName\n      name: nameFirst\n      nameFirst\n      nameLast\n      phone\n      status\n      email\n      createdAt\n      meta\n      invoiceThreshold\n      quoteThreshold\n      media: Media {\n        id\n        medium: Medium {\n          id\n          category\n          filename\n          meta\n          type\n        }\n      }\n      accounts: Account_Users {\n        id\n        role\n        position\n        isContact\n        status\n        account: Account {\n          id\n          name\n          type\n        }\n      }\n    }\n  }\n"]))),C=(0,v.Ps)(l||(l=(0,k.Z)(["\n  query CheckDuplicateEmail($email: String!) {\n    users: User_public(where: { email: { _eq: $email } }) {\n      id\n      nameFirst\n      nameLast\n      email\n      phone\n    }\n  }\n"]))),x=(0,v.Ps)(r||(r=(0,k.Z)(["\n  fragment UserFields on User {\n    id\n    email\n    nameFirst\n    nameLast\n    fullName\n    phone\n    status\n  }\n"]))),A=(0,v.Ps)(u||(u=(0,k.Z)(["\n  mutation SendGoogleAuthCode($code: String!, $id: Int!, $type: String!) {\n    createGoogleToken(code: $code, id: $id, type: $type) {\n      success\n      tokens\n      error\n    }\n  }\n"]))),D=(0,v.Ps)(c||(c=(0,k.Z)(["\n  mutation GenerateMSURL($type: String!, $id: Int!) {\n    genenrateMSURL(id: $id, type: $type) {\n      url\n    }\n  }\n"]))),U=(0,v.Ps)(p||(p=(0,k.Z)(["\n  mutation signoutMS($id: Int!, $type: String!, $email: String!) {\n    signoutMS(id: $id, type: $type, email: $email) {\n      error\n      msId\n      success\n    }\n  }\n"]))),J=(0,v.Ps)(d||(d=(0,k.Z)(["\n  query getAccountMeta($id: Int!) {\n    account: Account_by_pk(id: $id) {\n      meta\n    }\n  }\n"]))),O=(0,v.Ps)(m||(m=(0,k.Z)(["\n  query user($id: Int!) {\n    user: User_by_pk(id: $id) {\n      meta\n      invoiceThreshold\n      quoteThreshold\n    }\n  }\n"]))),Z=(0,v.Ps)(b||(b=(0,k.Z)(["\n  query GetAccountUserMeta($userId: Int!, $accountId: Int!) {\n    accountUser: Account_User(where: { userId: { _eq: $userId }, accountId: { _eq: $accountId } }) {\n      meta\n    }\n  }\n"]))),q=(0,v.Ps)(y||(y=(0,k.Z)(["\n  mutation UpdateAccountUserByUserIdAccoutId(\n    $userId: Int!\n    $accountId: Int!\n    $changes: Account_User_set_input!\n  ) {\n    update_Account_User(\n      where: { userId: { _eq: $userId }, accountId: { _eq: $accountId } }\n      _set: $changes\n    ) {\n      returning {\n        id\n      }\n    }\n  }\n"]))),_=(0,v.Ps)(f||(f=(0,k.Z)(["\n  mutation updateAccount($accountId: Int!, $set: Account_set_input!) {\n    update_Account_by_pk(pk_columns: { id: $accountId }, _set: $set) {\n      id\n    }\n  }\n"]))),N=(0,v.Ps)(h||(h=(0,k.Z)(["\n  mutation updateUserMeta($userId: Int!, $meta: jsonb!) {\n    update_User_by_pk(pk_columns: { id: $userId }, _set: { meta: $meta }) {\n      id\n      meta\n    }\n  }\n"]))),B=(0,v.Ps)(g||(g=(0,k.Z)(['\n  query userDevices($accountId: Int!) {\n    users: User(\n      where: {\n        Account_Users: { accountId: { _eq: $accountId }, status: { _eq: "active" } }\n        UserDevices: { status: { _eq: "active" } }\n        status: { _eq: "active" }\n      }\n    ) {\n      id\n      fullName\n      devices: UserDevices(\n        order_by: { updatedAt: desc_nulls_last }\n        where: { status: { _eq: "active" } }\n        limit: 1\n      ) {\n        id\n        playerId\n      }\n    }\n  }\n']))),H=(0,v.Ps)(T||(T=(0,k.Z)(['\n  query GetAccountLocations($accountId: Int, $limit: Int, $offset: Int) {\n    location: Location(\n      offset: $offset\n      limit: $limit\n      where: {\n        Account_Locations: {\n          accountId: { _eq: $accountId }\n          Account: { type: { _eq: "customer" } }\n        }\n      }\n    ) {\n      id\n      name\n      accountLocations: Account_Locations {\n        id\n      }\n      addresses: Addresses(where: { entity: { _eq: "Location" }, registered: { _eq: true } }) {\n        id\n        status\n        address: Address {\n          id\n          name\n          addressLine1\n          postCode\n        }\n      }\n    }\n    meta: Location_aggregate(\n      where: {\n        Account_Locations: {\n          accountId: { _eq: $accountId }\n          Account: { type: { _eq: "customer" } }\n        }\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n']))),$=(0,v.Ps)(j||(j=(0,k.Z)(["\n  mutation InsertUserAccountLocations(\n    $accountUserId: Int!\n    $objects: [User_Account_Location_insert_input!]!\n  ) {\n    delete_User_Account_Location(where: { accountUserId: { _eq: $accountUserId } }) {\n      affected_rows\n    }\n    insert_User_Account_Location(objects: $objects) {\n      affected_rows\n      returning {\n        id\n      }\n    }\n  }\n"])))},45463:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return e7}});var a,s,o,i=n(19076),l=n(67294),r=n(11163),u=n(41085),c=n(16835),p=n(73359),d=n(71383),m=n(75063),b=(0,m.Ps)(a||(a=(0,d.Z)(["\n  query CommunicationSetting($adminId: Int!, $category: String) {\n    items: CommunicationSetting(\n      where: { adminId: { _eq: $adminId }, category: { _eq: $category } }\n    ) {\n      id\n      name\n      title\n      description\n      category\n      systemTemplate\n      email\n      emailTemplate\n      emailTemplateData\n      emailSubjectTemplate\n      emailBodyTemplate\n      notification\n      notificationHeading\n      notificationSubtitle\n      notificationContent\n      sms\n      smsTemplate\n      slack\n      slackTemplate\n      task\n      taskPriority\n      taskTemplate\n      toast\n      toastTemplate\n      whatsapp\n      whatsappTemplate\n      status\n      meta\n      tags\n      updatedAt\n      admin: Admin {\n        id\n        name\n      }\n      user: User {\n        nameFirst\n        nameLast\n      }\n    }\n  }\n"]))),y=(0,m.Ps)(s||(s=(0,d.Z)(["\n  mutation AddCommunicationSetting($objects: [CommunicationSetting_insert_input!]!) {\n    insert_CommunicationSetting(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]))),f=(0,m.Ps)(o||(o=(0,d.Z)(["\n  mutation UpdateCommunicationSetting($id: Int!, $changes: CommunicationSetting_set_input) {\n    update_CommunicationSetting_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"]))),h=n(73987),g=n(50029),T=n(64687),j=n.n(T),k=n(50319),v=n(78289),S=n(51466),w=n(68956),I=n(58965),P=n(16540),C=n(55863),x=n(86831),A=n(59499),D=n(42283),U=n(79665),J=n(94054),O=n(47312),Z=n(18972),q=n(18360),_=n(76600),N=n(9270),B=n(62140),H=n(49501),$=n(55563),L=n(95103),E=n(62047),R=n(6710),Q=n(55843),F=n(55377),z=n(70982),V=n(77439),M=n(77651),Y=n(46901),W=n(14564),G=n(5616),X=n(11057),K=n(21023),ee=n(93946),et=n(23795),en=n(50135),ea=n(74721),es=n(92264),eo=n(27812),ei=n(40826),el=n(60036),er=n(85893);function eu(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function ec(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eu(Object(n),!0).forEach(function(t){(0,A.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eu(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ep,ed,em,eb,ey=function(e,t,n){var a=[];return t.filter(function(t){return t.category===e}).forEach(function(e){var t=ec({},e),s=n.find(function(t){return t.name===e.name});s&&(t=ec(ec({},e),s)),t.tags=ec(ec({},e.tags),null==s?void 0:s.tags),a.push(t)}),a},ef=function(e,t){var n,a=ec({adminId:t},e);return["email","notification","sms","slack","task","toast","whatsapp"].forEach(function(e){a[e]||(a[e]=!1)}),a.taskPriority||(a.taskPriority=3),null!=a&&null!==(n=a.meta)&&void 0!==n&&n.sendTo&&(a.sendTo=a.meta.sendTo),a},eh=function(e){return{name:e.name,title:e.title,description:e.description,category:e.category,systemTemplate:e.systemTemplate,email:e.email,emailTemplate:e.emailTemplate,emailTemplateData:e.emailTemplateData,emailSubjectTemplate:e.emailSubjectTemplate,emailBodyTemplate:e.emailBodyTemplate,notification:e.notification,notificationHeading:e.notificationHeading,notificationSubtitle:e.notificationSubtitle,notificationContent:e.notificationContent,task:e.task,taskTemplate:e.taskTemplate,toast:e.toast,status:e.status,meta:ec(ec({},e.meta),{},{sendTo:Object.assign.apply(Object,[{}].concat((0,eo.Z)(Object.keys(e.sendTo).map(function(t){return e.sendTo[t]?(0,A.Z)({},t,e.sendTo[t]):{}}))))}),adminId:e.adminId,toastTemplate:e.toastTemplate,taskPriority:e.taskPriority,tags:e.tags}},eg=function(e,t){var n=function(){return(0,er.jsx)(ei.Z,{context:"success",icon:"check",size:"sm",title:"Enabled"})},a=function(){return(0,er.jsx)(ei.Z,{context:"warning",icon:"times",size:"sm",title:"Disabled"})},s=function(){return(0,er.jsx)(ei.Z,{context:"dark",icon:"minus",size:"sm",title:"Unavailable"})};return e.enabled.includes(t)?e[t]?n:a:s},eT=function(e){var t,n,a=function(){return(0,er.jsx)(ei.Z,{context:"success",icon:"check",size:"sm",title:"Enabled"})},s=function(){return(0,er.jsx)(ei.Z,{context:"warning",icon:"times",size:"sm",title:"Disabled"})};return e.id?"object"===(0,x.Z)(null===(t=e.meta)||void 0===t?void 0:t.sendTo)&&Object.keys(null===(n=e.meta)||void 0===n?void 0:n.sendTo).length?function(){return(0,er.jsx)("strong",{children:Object.keys(e.meta.sendTo).join(", ")})}:a:s},ej=(ep=(0,g.Z)(j().mark(function e(t){var n,a;return j().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="homyze",a="".concat(t.name,"-").concat(n,"-").concat(t.adminId),e.next=4,window.fetch("".concat("https://aws.cleverly.works","/aws/ses/create-template"),{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({instance:n,subject:t.emailSubjectTemplate,template:a,templateData:t.emailBodyTemplate})}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return(0,el.Tb)({message:e,section:"fetch"}),e});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)})),function(e){return ep.apply(this,arguments)}),ek=(ed=(0,g.Z)(j().mark(function e(t){var n,a,s,o,i,l;return j().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.name,a=t.adminId,s=t.emailSubjectTemplate,o=t.emailTemplateData,i="homyze",l="".concat(n,"-").concat(i,"-").concat(a),e.next=5,window.fetch("".concat("https://aws.cleverly.works","/aws/ses/test-render"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subject:s,template:l,templateData:o})}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){(0,el.Tb)({message:e,section:"fetch"})});case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}},e)})),function(e){return ed.apply(this,arguments)}),ev=(em=(0,g.Z)(j().mark(function e(t,n,a){var s,o,i,l,r;return j().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return s=a.admin.emailSettings,o="homyze",i="".concat(t.name,"-").concat(o,"-").concat(t.adminId),l=n("emailTo"),r=n("emailTemplateData"),e.next=7,window.fetch("".concat("https://aws.cleverly.works","/aws/ses/send-template"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({reply:'"'.concat(s.replyToName,'" <').concat(s.replyToEmail,">"),source:'"'.concat(s.replyToName,'" <job@cleverly.works>'),subject:t.emailSubjectTemplate,template:i,templateData:r,to:l})}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return(0,el.Tb)({message:e,section:"fetch"}),e});case 7:return e.abrupt("return",e.sent);case 8:case"end":return e.stop()}},e)})),function(e,t,n){return em.apply(this,arguments)}),eS=(eb=(0,g.Z)(j().mark(function e(t){var n,a;return j().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n="homyze",a="".concat(t.name,"-").concat(n,"-").concat(t.adminId),e.next=4,window.fetch("".concat("https://aws.cleverly.works","/aws/ses/get-template"),{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({template:a})}).then(function(e){return e.json()}).then(function(e){return e}).catch(function(e){return(0,el.Tb)({message:e,section:"fetch"}),e});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)})),function(e){return eb.apply(this,arguments)}),ew=function(e){var t,n,a=e.data;return(0,er.jsx)("div",{dangerouslySetInnerHTML:(t=a.data.RenderedTemplate.indexOf("<!doctype html>"),n=a.data.RenderedTemplate.indexOf("</html>"),{__html:a.data.RenderedTemplate.substring(t,n+7)})})},eI=n(60092);function eP(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function eC(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eP(Object(n),!0).forEach(function(t){(0,A.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eP(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ex={componentsProps:{tooltip:{style:{maxWidth:"none",backgroundColor:eI.Q.COLOUR.secondary}},arrow:{style:{color:eI.Q.COLOUR.secondary}}},PopperProps:{style:{zIndex:9999}}},eA=function(e){var t=e.app,n=e.defaultValues,a=void 0===n?{}:n,s=e.errors,o=e.getValues,i=e.register,r=e.setValue,u=e.watch,c=e.trigger,p=e.test,d=e.setTest,m=(0,l.useContext)(v.Z),b=(0,l.useState)(!1),y=b[0],f=b[1],h=(0,l.useState)(!1),T=h[0],k=h[1],w=(0,l.useState)(!1),I=w[0],P=w[1],C=(0,l.useState)(null),x=C[0],A=C[1],D=u("email",a.email);D="false"!==D&&Boolean(D),(0,l.useEffect)(function(){eS(a).then(function(e){if(!(null!=e&&e.success))return k("Template does not exist. Please submit the form to create it.")}).catch(function(){return k("Template does not exist. Please submit the form to create it.")})},[]);var U,O,Z=function(){d(!p)},q=(U=(0,g.Z)(j().mark(function e(t){var n,s,i,l,r,u,p;return j().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),t.stopPropagation(),e.next=4,c("emailTemplateData");case 4:if(e.sent){e.next=7;break}return e.abrupt("return");case 7:return s=JSON.parse(o("emailTemplateData")),i=o("tags.button_url"),l=o("tags.button_title"),r=o("tags.file_url"),u=eC(eC({},a),{},{emailTemplateData:JSON.stringify(eC(eC({},s),{},{button_title:l,button_url:i,filePath:r}))}),e.next=14,ek(u);case 14:(p=e.sent).success?m.show({content:(0,er.jsx)(ew,{data:p}),submit:!1,title:"Email Preview",width:"70%"}):f({message:p.message,type:"error"});case 16:case"end":return e.stop()}},e)})),function(e){return U.apply(this,arguments)}),_=(O=(0,g.Z)(j().mark(function e(n){var s;return j().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),n.stopPropagation(),e.next=4,ev(a,o,t);case 4:null!=(s=e.sent)&&s.success?f({message:"Email sent successfully.",type:"success"}):f({message:"Email failed to send.",type:"error"});case 6:case"end":return e.stop()}},e)})),function(e){return O.apply(this,arguments)}),N=function(){f(!1)},B=function(e,t){r(e,t)},L={errors:s,register:i},eo=eC(eC({},L),{},{context:"secondary",size:"sm"});return(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(M.Z,{anchorOrigin:{vertical:"top",horizontal:"right"},open:y,autoHideDuration:6e3,onClose:N,children:(0,er.jsx)(Y.Z,{onClose:N,severity:y.type,variant:"filled",sx:{width:"100%"},children:y.message})}),(0,er.jsx)(W.ZP,{sx:{zIndex:9999,backgroundColor:"rgba(0,0,0,0.5)"},open:I,anchorEl:x,onClose:function(){P(!1),A(null)},children:(0,er.jsxs)(G.Z,{sx:{display:"flex",flexDirection:"column",alignItems:"center",backgroundColor:"#ffffff",padding:"16px"},children:[(0,er.jsx)("img",{style:{width:400,borderRadius:5,border:"1px solid #EBEBEF"},src:"https://cleverly-media.s3.eu-west-2.amazonaws.com/images/CleverlyMail.jpg",alt:"Button Url"}),(0,er.jsx)(X.Z,{sx:{width:"100%",backgroundColor:"#1893f9",marginTop:"16px"},variant:"contained",size:"large",onClick:function(){P(!1),A(null)},children:"Got it"})]})}),(0,er.jsx)(H.Z,{label:"Email",children:(0,er.jsx)(E.Z,eC(eC({},eo),{},{onToggle:function(e){return B("email",e)},toggled:D}))}),D&&(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(H.Z,{label:"Subject",children:(0,er.jsx)($.Z,eC(eC({},L),{},{name:"emailSubjectTemplate"}))}),(0,er.jsx)(H.Z,{label:"Content",children:(0,er.jsx)(R.Z,eC(eC({},L),{},{name:"emailBodyTemplate",rows:8}))}),(null==a?void 0:a.tags)&&(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(Q.Z,{}),(0,er.jsxs)(S.Z,{children:["Available tags:"," ",Object.keys(a.tags||{}).filter(function(e){return"button_url"!==e&&"button_title"!==e&&"file_buttons"!==e}).map(function(e){return"{{".concat(e,"}}")}).join(", ")]}),(0,er.jsx)(Q.Z,{})]}),(0,er.jsxs)(G.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,er.jsx)(S.Z,{children:"Button Title:"}),(0,er.jsx)(K.Z,eC(eC({title:(0,er.jsx)("p",{style:{fontSize:"1rem",margin:5},children:"This is the text that will show on the button in the email."}),placement:"left-end",leaveDelay:1500,arrow:!0},ex),{},{children:(0,er.jsx)(ee.Z,{size:"small",children:(0,er.jsx)(ea.Z,{color:"secondary"})})})),(0,er.jsx)(et.Z,{color:"secondary",underline:"none",sx:{cursor:"pointer"},onClick:function(e){P(!0),A(e.currentTarget)},children:"Preview"})]}),(0,er.jsx)(J.Z,{fullWidth:!0,children:(0,er.jsx)(en.Z,{style:{marginBottom:10},inputRef:i,name:"tags.button_title",size:"small",placeholder:"e.g Go to Cleverly"})}),(0,er.jsxs)(G.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,er.jsx)(S.Z,{children:"Button Link:"}),(0,er.jsx)(K.Z,eC(eC({title:(0,er.jsx)("p",{style:{fontSize:"1rem",margin:5},children:"This is where the user will be directed upon clicking the button."}),placement:"left-end",leaveDelay:1500,arrow:!0},ex),{},{children:(0,er.jsx)(ee.Z,{size:"small",children:(0,er.jsx)(ea.Z,{color:"secondary"})})}))]}),(0,er.jsx)(J.Z,{fullWidth:!0,children:(0,er.jsx)(en.Z,{inputRef:i,name:"tags.button_url",size:"small",placeholder:"e.g https://app.cleverly.works"})}),p&&(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(F.Z,{}),(0,er.jsx)(H.Z,{label:"Email To",children:(0,er.jsx)($.Z,eC(eC({},L),{},{name:"emailTo"}))}),(0,er.jsxs)(H.Z,{label:"Template data",children:[(0,er.jsx)(R.Z,eC(eC({},L),{},{name:"emailTemplateData",rows:15})),(0,er.jsx)(z.Z,{message:"Used in test send only"})]}),T&&(0,er.jsx)("p",{children:(0,er.jsx)(z.Z,{message:T})})]}),(0,er.jsxs)(es.H,{context:p?"warning":"info",content:p?"Close Test":"Send Test",handleClick:Z,size:"sm",children:[p&&(0,er.jsx)(V.Z,{disabled:!!T,context:"secondary",content:"Preview Template",onClick:q,size:"sm"}),p&&(0,er.jsx)(V.Z,{disabled:!!T,context:"success",content:"Send",onClick:_,size:"sm"})]})]}),(0,er.jsx)($.Z,eC(eC({},L),{},{name:"email",type:"hidden"}))]})},eD=n(6812),eU=n(69496),eJ=n(72936);function eO(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function eZ(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eO(Object(n),!0).forEach(function(t){(0,A.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eO(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var eq=function(e){var t=e.defaultValues,n=void 0===t?{}:t,a=e.errors,s=(e.getValues,e.register),o=e.setValue,i=e.watch,r=(0,eJ.x)().user,u=(0,l.useState)(!1),c=u[0],p=u[1],d=i("notification",n.notification);d="false"!==d&&Boolean(d);var m=(0,eD.a)(eU.ge,{variables:{accountId:r.accountId}}).data,b=(m=void 0===m?{users:[]}:m).users,y=[{disabled:!0,text:"Select user",value:""}];b.length&&b.forEach(function(e){y.push({text:e.fullName,value:e.devices[0].playerId})});var f,h=function(){p(!c)},T=(f=(0,g.Z)(j().mark(function e(t){var a;return j().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),t.stopPropagation(),a=i("playerId"),!d){e.next=6;break}return e.next=6,window.fetch("".concat("https://aws.cleverly.works","/onesignal/send-push"),{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({content:n.notificationContent,heading:n.notificationHeading,subtitle:n.notificationSubtitle,playerId:a})}).then(function(e){return e.json()}).then(function(e){}).catch(function(e){(0,el.Tb)({message:e,section:"fetch"})});case 6:case"end":return e.stop()}},e)})),function(e){return f.apply(this,arguments)}),k=function(e,t){o(e,t)},v={errors:a,register:s},w=eZ(eZ({},v),{},{context:"secondary",size:"sm"});return(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(H.Z,{label:"Push Notification",children:(0,er.jsx)(E.Z,eZ(eZ({},w),{},{onToggle:function(e){return k("notification",e)},toggled:d}))}),d&&(0,er.jsxs)(er.Fragment,{children:[(0,er.jsxs)(N.Z,{children:[(0,er.jsx)(B.Z,{md:6,children:(0,er.jsx)(H.Z,{label:"Heading",children:(0,er.jsx)($.Z,eZ(eZ({},v),{},{name:"notificationHeading"}))})}),(0,er.jsx)(B.Z,{md:6,children:(0,er.jsx)(H.Z,{label:"Subtitle",children:(0,er.jsx)($.Z,eZ(eZ({},v),{},{name:"notificationSubtitle"}))})})]}),(0,er.jsx)(H.Z,{label:"Content",children:(0,er.jsx)(R.Z,eZ(eZ({},v),{},{name:"notificationContent",rows:2}))}),(null==n?void 0:n.tags)&&(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(Q.Z,{}),(0,er.jsxs)(S.Z,{children:["Available tags:"," ",Object.keys(n.tags||{}).filter(function(e){return"button_url"!==e&&"button_title"!==e&&"file_buttons"!==e}).map(function(e){return"{{".concat(e,"}}")}).join(", ")]})]}),c&&(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(F.Z,{}),(0,er.jsx)(H.Z,{label:"To",children:(0,er.jsx)(L.Z,eZ(eZ({},v),{},{name:"playerId",options:y}))})]}),(0,er.jsx)(es.H,{context:c?"warning":"info",content:c?"Close Test":"Send Test",handleClick:h,size:"sm",children:c&&(0,er.jsx)(V.Z,{context:"success",content:"Send",onClick:T,size:"sm"})})]}),(0,er.jsx)($.Z,eZ(eZ({},v),{},{name:"notification",type:"hidden"}))]})},e_=n(74231);function eN(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function eB(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eN(Object(n),!0).forEach(function(t){(0,A.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eN(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var eH=function(e){var t=e.defaultValues,n=void 0===t?{}:t,a=e.errors,s=e.register;return e.setValue,e.watch,(0,er.jsxs)(H.Z,{label:"Content",children:[(0,er.jsx)(R.Z,eB(eB({},{errors:a,register:s}),{},{name:"systemTemplate",rows:2})),(null==n?void 0:n.tags)&&(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(Q.Z,{}),(0,er.jsxs)(S.Z,{children:["Available tags:"," ",Object.keys(n.tags||{}).filter(function(e){return"button_url"!==e&&"button_title"!==e&&"file_buttons"!==e}).map(function(e){return"{{".concat(e,"}}")}).join(", ")]})]})]})},e$=[{text:"P1",value:1},{text:"P2",value:2},{text:"P3",value:3},{text:"P4",value:4},{text:"P5",value:5}];function eL(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function eE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eL(Object(n),!0).forEach(function(t){(0,A.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eL(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var eR=function(e){var t=e.defaultValues,n=void 0===t?{}:t,a=e.errors,s=e.register,o=e.setValue,i=(0,e.watch)("task",n.task);i="false"!==i&&Boolean(i);var l=function(e,t){o(e,t)},r={errors:a,register:s},u=eE(eE({},r),{},{context:"secondary",size:"sm"});return(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(H.Z,{label:"Task",children:(0,er.jsx)(E.Z,eE(eE({},u),{},{onToggle:function(e){return l("task",e)},toggled:i}))}),i&&(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(H.Z,{label:"Default priority",children:(0,er.jsx)(L.Z,eE(eE({},r),{},{name:"taskPriority",options:e$}))}),(0,er.jsx)(H.Z,{label:"Content",children:(0,er.jsx)(R.Z,eE(eE({},r),{},{name:"taskTemplate",rows:2}))}),(null==n?void 0:n.tags)&&(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(Q.Z,{}),(0,er.jsxs)(S.Z,{children:["Available tags:"," ",Object.keys(n.tags||{}).filter(function(e){return"button_url"!==e&&"button_title"!==e&&"file_buttons"!==e}).map(function(e){return"{{".concat(e,"}}")}).join(", ")]})]})]}),(0,er.jsx)($.Z,eE(eE({},r),{},{name:"task",type:"hidden"}))]})};function eQ(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function eF(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eQ(Object(n),!0).forEach(function(t){(0,A.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eQ(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ez=function(e){var t=e.defaultValues,n=void 0===t?{}:t,a=e.errors,s=e.register,o=e.setValue,i=(0,e.watch)("toast",n.toast);i="false"!==i&&Boolean(i);var l=function(e,t){o(e,t)},r={errors:a,register:s},u=eF(eF({},r),{},{context:"secondary",size:"sm"});return(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(H.Z,{label:"Toast",children:(0,er.jsx)(E.Z,eF(eF({},u),{},{onToggle:function(e){return l("toast",e)},toggled:i}))}),i&&(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(H.Z,{label:"Content",children:(0,er.jsx)(R.Z,eF(eF({},r),{},{name:"toastTemplate",rows:2}))}),(null==n?void 0:n.tags)&&(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(Q.Z,{}),(0,er.jsxs)(S.Z,{children:["Available tags:"," ",Object.keys(n.tags||{}).filter(function(e){return"button_url"!==e&&"button_title"!==e&&"file_buttons"!==e}).map(function(e){return"{{".concat(e,"}}")}).join(", ")]})]})]}),(0,er.jsx)($.Z,eF(eF({},r),{},{name:"toast",type:"hidden"}))]})},eV=[{text:"Jobs",value:"bookings"},{text:"Quotes",value:"quotes"},{text:"Planned Maintenance",value:"ppm"},{text:"Assets",value:"assets"},{text:"Supplier Onboarding",value:"supplierOnboarding"},{text:"Customer Onboarding",value:"customerOnboarding"},{text:"Tenant Onboarding",value:"tenantOnboarding"},{text:"Accounts",value:"accounts"},{text:"Broadcasts",value:"broadcasts"},{text:"System Emails",value:"system-emails"}],eM=[{id:"admin",name:"admin",label:"Admin",options:[{value:null,label:"Disabled"},{value:"all",label:"All Contact Users"},{value:"assigned",label:"Assigned User"}]},{id:"supplier",name:"supplier",label:"Supplier",options:[{value:null,label:"Disabled"},{value:"all",label:"All Contact Users"},{value:"assigned",label:"Assigned User"},{value:"owner",label:"Account Owners"},{value:"manager",label:"Account Managers"}]},{id:"customer",name:"customer",label:"Customer",options:[{value:null,label:"Disabled"},{value:"all",label:"All Contact Users"},{value:"assigned",label:"Assigned User"},{value:"owner",label:"Account Owners"},{value:"manager",label:"Account Managers"}]},{id:"tenant",name:"tenant",label:"Tenant",options:[{value:null,label:"Disabled"},{value:"all",label:"All Contact Users"}]}],eY=[{category:"bookings",type:"trigger",description:"A tenant or customer has submitted a request",emailBodyTemplate:"Issue details:\n\n    Title: {{shortJobDesc}}\n    Description: {{description}}\n    Address: {{addressInline}}\n    Customer: {{customer}}",emailSubjectTemplate:"Issue reported at {{property}}",name:"issueReported",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:"Issue reported at {{property}}",systemTemplate:"Issue reported by {{user}} at {{property}}: {{shortJobDesc}}",taskPriority:3,taskTemplate:"Approve a new job request {{jobId}} at {{property}}: {{shortJobDesc}}",title:"Issue reported",toastTemplate:"Issue {{jobId}} reported at {{property}}: {{shortJobDesc}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",user:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"An admin user has approved a job request",emailBodyTemplate:"Hi {{requester}}\n\n    Your request at {{property}} has been approved. Click below to follow the job progress.",emailSubjectTemplate:"Job approved",name:"jobApproved",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job approved by {{user}}: {{userNotes}}",taskPriority:3,taskTemplate:null,title:"Job approved",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",serviceLine:"",requester:"",user:"",userNotes:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"A job has been raised and assigned to admin user",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobRaised",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job has been raised by {{user}}. {{description}}",taskPriority:3,taskTemplate:"Job {{jobId}} is created and assigned to you, please assign suppliers",title:"Job raised",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",user:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:'A job has been marked "on hold"',emailBodyTemplate:null,emailSubjectTemplate:null,name:"onHoldRaise",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job is On Hold by {{user}}",taskPriority:3,taskTemplate:"Job {{jobId}} is on Hold , please waiting for resume",title:"On Hold Job",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",user:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"A job has been reposted",emailBodyTemplate:"Hi {{name}},\n\n    You don't have any responsibility for job with Id {{jobId}}, it's\n     assigned to Other supplier.\n\n    Best Regards,\n    ",emailSubjectTemplate:"Job is Assigned",name:"jobReposted",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job was reposted by {{user}}",taskPriority:3,taskTemplate:"Job {{jobId}} is Reposted Job",title:"Job was reposted",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",user:""},meta:{sendTo:{}}},{category:"bookings",type:"cron",description:"A supplier has not been assigned to job (<1 day before attendance)",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobNotAssigned",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Supplier not assigned to job <1 day before attendance",taskPriority:1,taskTemplate:"Assign supplier for {{jobId}}",title:"Supplier not assigned",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:""},meta:{sendTo:{}}},{category:"bookings",type:"cron",description:"A location requires a permit but it has not been added to a job within 72 hours.",emailBodyTemplate:null,emailSubjectTemplate:null,name:"permitsNotAdded",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"A location requires a permit but it has not been added to a job within 72 hours.",taskPriority:1,taskTemplate:"Assign permits for {{jobId}}",title:"Permits not added",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{jobId:"",jobStatus:"",property:"",addressPostCode:"",addressInline:"",shortJobDesc:"",description:"",serviceLine:"",scheduleDate:"",customer:"",customerUser:"",supplier:"",supplierUser:""},meta:{sendTo:{}}},{category:"bookings",type:"cron",description:"Job is multiple days in length",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobNotFinished",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job is multiple days in length",taskPriority:1,taskTemplate:"Job is multiple days in length",title:"Job is not finished",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"Notify a supplier that they have been offered a job",emailBodyTemplate:"Please see below details of an instruction that has been offered to you.\n\n    Job ID: {{jobId}}\n    Date: {{scheduleDate}}\n    Address: {{addressInline}}\n    Service line: {{serviceLine}}\n\n    Description: {{shortJobDesc}}\n    {{description}}\n\n    For further information on these works and any others, just login to your account below.",emailSubjectTemplate:"New job offer",name:"supplierBookingOffered",notificationContent:"Please accept or reject through the application ASAP.",notificationHeading:"Booking Offered",notificationSubtitle:"Cleverly has a new booking offer for you.",slackTemplate:null,smsTemplate:"You have been offered a job please check the app.",systemTemplate:"",taskPriority:3,taskTemplate:null,title:"Supplier receives job offer",toastTemplate:"New job offer",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",supplier:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"A supplier has rejected a job offer",emailBodyTemplate:null,emailSubjectTemplate:null,name:"supplierBookingRejected",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job rejected by {{user}} on behalf of {{supplier}}: {{userNotes}}",taskPriority:3,taskTemplate:null,title:"Job offer rejected",toastTemplate:"Job {{jobId}} rejected by {{supplier}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",supplier:"",user:"",userNotes:""},meta:{sendTo:{}}},{category:"bookings",type:"cron",description:"No suppliers have accepted the job (2 hours after receiving offer)",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobNotAllocated",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"None of the suppliers accepted the job 2 hours after receiving offer",taskPriority:2,taskTemplate:"Re-offer the job {{jobId}}",title:"Job offer not allocated",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"A supplier has accepted a job offer",emailBodyTemplate:null,emailSubjectTemplate:null,name:"supplierBookingAccepted",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job has been accepted by {{user}} on behalf of {{supplier}}",taskPriority:3,taskTemplate:null,title:"Job offer accepted",toastTemplate:"Job has been accepted by {{user}} on behalf of {{supplier}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:"",user:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"A supplier has accepted the job offered",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobAccepted",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"{{supplierUser}} will arrive at {{scheduleDate}}",taskPriority:3,taskTemplate:null,title:"Job gets accepted status",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:"",user:"",userNotes:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"A supplier that accepted the job can no longer attend",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobRejected",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job rejected by {{user}} on behalf of {{supplier}}: {{userNotes}}",taskPriority:1,taskTemplate:"Job {{jobId}} rejected by {{supplier}}, repost required",title:"Job rejected",toastTemplate:"Job {{jobId}} rejected by {{supplier}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",supplier:"",user:"",userNotes:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"An admin user has changed the job time",emailBodyTemplate:"Hi {{supplierUser}}\n\n    The scheduled time for job {{jobId}} has changed to {{scheduleDate}}.\n\n    Please login and confirm the attendance time.",emailSubjectTemplate:"Job timing changed",name:"jobTimingChange",notificationContent:"Please confirm the new attendance time",notificationHeading:"Booking Time Changed",notificationSubtitle:"Job {{jobId}}",slackTemplate:null,smsTemplate:null,systemTemplate:"Time has been changed by {{user}} from {{startDate}} - {{endDate}}\n    to {{newStartDate}} - {{newEndDate}}.",taskPriority:3,taskTemplate:null,title:"Job timing changed",toastTemplate:"Job {{jobId}} timing changed",whatsappTemplate:null,enabled:["system","email","sms","notification","toast","slack","whatsapp"],tags:{jobId:"",invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",user:"",startDate:"",endDate:"",newStartDate:"",newEndDate:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"An admin user has changed the pricing or service",emailBodyTemplate:"Hi {{supplierUser}}\n\n    The pricing for job {{jobId}} has changed.\n\n    Please login and confirm attendance.",emailSubjectTemplate:"Job price / service changed",name:"jobPricingChange",notificationContent:"Please confirm the attendance",notificationHeading:"Booking Pricing Changed",notificationSubtitle:"Job {{jobId}}",slackTemplate:null,smsTemplate:null,systemTemplate:"Job pricing or service changed",taskPriority:3,taskTemplate:null,title:"Job price / service changed",toastTemplate:"Job {{jobId}} pricing changed",whatsappTemplate:null,enabled:["email","task","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:""},meta:{sendTo:{}}},{category:"bookings",type:"cron",description:"Notification about upcoming job (48 hours before scheduled time)",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobUpcoming",notificationContent:"Upcoming job",notificationHeading:"{{jobId}}",notificationSubtitle:"Scheduled at {{scheduleDate}}",slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,title:"Upcoming job",toastTemplate:"You have an upcoming job {{jobId}} at {{scheduleDate}}",whatsappTemplate:null,enabled:["system","email","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:""},meta:{sendTo:{}}},{category:"bookings",type:"cron",description:"Reminder about upcoming job (24 hours before scheduled time)",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobReminder",notificationContent:"Job reminder",notificationHeading:"{{jobId}}",notificationSubtitle:"Scheduled at {{scheduleDate}}",slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,title:"Job reminder",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:""},meta:{sendTo:{}}},{category:"bookings",type:"cron",description:"A job has not started at the scheduled time",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobNotStarted",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job has not started as scheduled by {{supplierUser}} from {{supplier}}",taskPriority:1,taskTemplate:"Job {{jobId}} late arrival, please check with supplier",title:"Job not started / late arrival",toastTemplate:"Job {{jobId}} late arrival",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:""},meta:{sendTo:{}}},{category:"bookings",type:"cron",description:"SLA breached: a job has not started within the SLA time window",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobSlaBreached",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job has not started in the SLA time window",taskPriority:1,taskTemplate:"SLA breached for {{jobId}}, contact supplier & customer",title:"SLA breached",toastTemplate:"SLA breached for {{jobId}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"A supplier has started the job",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobStarted",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job started by {{supplier}}, {{user}} activated the timer",taskPriority:3,title:"Job started",toastTemplate:"Job {{jobId}} started by {{supplierUser}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:"",user:""},meta:{sendTo:{}}},{category:"bookings",type:"cron",description:"A timer is still active (4 hours after job started)",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobTooLong",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Timer active 4 hours after job started",taskPriority:1,taskTemplate:"Contact supplier {{supplier}} for job {{jobId}} to ensure they did not just\n    leave timer running",title:"Long job",toastTemplate:"Job {{jobId}} time active 4 hours after job started",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"A supplier has marked their job as complete",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobCompleted",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job completed by {{supplier}}, {{user}} stopped the timer",taskPriority:3,taskTemplate:null,title:"Job completed",toastTemplate:"Job {{jobId}} completed by {{supplierUser}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:"",user:""},meta:{sendTo:{}}},{category:"bookings",type:"cron",description:"A supplier has not submitted their job report (4 hours after job marked complete)",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobReportNotReceived",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"{{supplier}} has not submitted job report",taskPriority:1,taskTemplate:"Contact {{jobId}} supplier for job report",title:"Job report not received",toastTemplate:"{{jobId}} job report not received",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"A supplier has submitted their job report",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobReportSentSupplier",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"{{supplier}} job report submitted by {{user}}: {{jobReport}}",taskPriority:3,taskTemplate:null,title:"Job report submitted",toastTemplate:"{{jobId}} job report submitted by {{supplier}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:"",jobReport:"",user:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:'A supplier has submitted a job report indicating a "failed" status',emailBodyTemplate:null,emailSubjectTemplate:null,name:"reportFailed",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:'{{supplier}} job report has been submitted by {{user}} indicating a "failed" status and recommendations as follows: {{recommendations}}',taskPriority:3,taskTemplate:null,title:"Job failed",toastTemplate:'Job report for {{jobId}} has been submitted by {{supplier}} indicating a "failed" status',whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{user:"",recommendations:"",customer:"",customerUser:"",supplier:"",supplierUser:"",property:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",serviceLine:"",jobReport:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"A supplier has resolved the failed status on a job",emailBodyTemplate:null,emailSubjectTemplate:null,name:"reportFailureResolved",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Failed status reported by {{supplier}}  has been resolved by {{user}} with comments as follows: {{comments}}",taskPriority:3,taskTemplate:null,title:"Job failure resolved",toastTemplate:"Failed status on {{jobId}} has been resolved by {{supplier}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{user:"",comments:"",customer:"",customerUser:"",supplier:"",supplierUser:"",property:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",serviceLine:"",jobReport:""},meta:{sendTo:{}}},{category:"bookings",type:"cron",description:"A job report has not been sent to customer (8 hours after job completed)",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobReportNotSent",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"{{jobId}} job report has not been sent to {{customer}}",taskPriority:1,taskTemplate:"Send job report to customer",title:"Job report not sent to customer",toastTemplate:"{{jobId}} job report not sent to customer",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"An admin user has validated a job",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobValidated",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job validated by {{user}}. {{notes}}",taskPriority:3,taskTemplate:"Send invoices to customer and supplier",title:"Job validated",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:"",user:"",notes:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"An admin user has unvalidated a job",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobUnvalidated",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job unvalidated by {{user}}. {{notes}}",taskPriority:3,taskTemplate:null,title:"Job unvalidated",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:"",user:"",notes:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"An admin user has sent an invoice to a customer",emailBodyTemplate:"Hi {{customer}},\n\n    Your invoice for job {{jobId}} at {{property}} is now available, click the button below to\n    download it.",emailSubjectTemplate:"Invoice for job {{jobId}}",name:"jobInvoiceSentCustomer",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Invoice for {{total}} sent to customer by {{user}}",taskPriority:3,taskTemplate:null,title:"Invoice sent to customer",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",total:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customerUser:"",serviceLine:"",user:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"An admin user has sent an invoice to a supplier",emailBodyTemplate:"Hi {{supplierUser}},\n\n    Your invoice for job {{jobId}} at {{property}} is now available, click the button below to\n    download it.",emailSubjectTemplate:"Invoice for job {{jobId}}",name:"jobInvoiceSentSupplier",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Invoice for {{total}} sent to customer by {{user}}",taskPriority:3,taskTemplate:null,title:"Invoice sent to supplier",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",total:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:"",user:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"An admin user has sent a job report to a customer",emailBodyTemplate:"Hi {{customer}}\n\n    A report for job {{jobId}} at {{property}} can be downloaded by clicking the button below.",emailSubjectTemplate:"{{jobId}} job report",name:"jobReportSent",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job report sent to {{customer}} {{customerEmail}} by {{user}}",taskPriority:3,taskTemplate:null,title:"Job report sent",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:"",user:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"A job dispute has been submitted",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobDisputeAdded",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job dispute submitted by {{user}}: {{userNotes}}",taskPriority:1,taskTemplate:"Job {{jobId}} at {{property}} disputed, contact customer & supplier",title:"Job disputed",toastTemplate:"A dispute submitted for job {{jobId}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:"",user:"",userNotes:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"An admin user has marked a job dispute as resolved",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobDisputeResolved",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job dispute marked as resolved by {{user}}: {{userNotes}}",taskPriority:3,taskTemplate:null,title:"Job dispute resolved",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:"",user:"",userNotes:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"A job has been marked as paid by customer",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobCustomerPaid",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Customer has paid {{amount}}.",taskPriority:3,taskTemplate:null,title:"Customer paid",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",amount:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"A job has been marked as paid to supplier",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobSupplierPaid",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Supplier has been paid.",taskPriority:3,taskTemplate:null,title:"Supplier paid",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:"",user:"",userNotes:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"An admin user has closed a job",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobClosed",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job was closed by {{user}}. {{userNotes}}",taskPriority:3,title:"Job closed",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:"",user:"",userNotes:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"An admin user has reopened a job",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobReopened",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Job was reopened by {{user}}. {{userNotes}}",taskPriority:3,title:"Job reopened",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customerUser:"",user:"",userNotes:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"The finances have been updated on a job",emailBodyTemplate:null,emailSubjectTemplate:null,name:"jobFinancesUpdated",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Finances changed to {{total}} by {{user}}",taskPriority:3,title:"Job finances updated",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","sms","notification","toast","slack","whatsapp"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",type:"",value:"",difference:"",shortJobDesc:"",description:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:"",user:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"A supplier has uploaded an invoice to a job",emailBodyTemplate:"{{supplier}} uploaded an invoice for job {{jobId}} .\n    Please review the invoice.",emailSubjectTemplate:"Supplier invoice added",name:"supplierUploadedInvoice",notificationContent:"{{supplier}} uploaded an invoice for job {{jobId}}",notificationHeading:"Invoice Upload",notificationSubtitle:"Supplier uploaded an invoice",slackTemplate:null,smsTemplate:"Invoice Uploaded by supplier",systemTemplate:"{{supplier}} uploaded invoice",taskPriority:3,taskTemplate:null,title:"Supplier invoice added",toastTemplate:"Supplier invoice added",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",supplier:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"Media has been uploaded to a job",emailBodyTemplate:"A media uploaded for job {{jobId}} .\n    Please review the job.",emailSubjectTemplate:"Media uploaded to job",name:"mediaUploadedForJob",notificationContent:"A media uploaded for job {{jobId}}",notificationHeading:"Media uploaded to job",notificationSubtitle:"Media uploaded for a job",slackTemplate:null,smsTemplate:"A media uploaded for job {{jobId}}",systemTemplate:"{{user}} uploaded a file {{filename}}.",taskPriority:3,taskTemplate:null,title:"Media uploaded to job",toastTemplate:"Media uploaded to job",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",user:"",filename:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",supplier:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"Threshold approval is required on a job",emailBodyTemplate:"{{requester}} requested  threshold approval for\n     {{jobTotal}} from {{requestee}} for job {{jobId}}",emailSubjectTemplate:"waiting for approval",name:"waitingThresholdApproval",notificationContent:"{{requester}} requested  threshold approval for\n     {{jobTotal}} from {{requestee}} for job {{jobId}}",notificationHeading:"Waiting for approval",notificationSubtitle:"Waiting for approval",slackTemplate:null,smsTemplate:"{{requester}} requested  threshold approval for\n     {{jobTotal}} from {{requestee}} for job {{jobId}}",systemTemplate:"{{requester}} requested  threshold approval for\n     {{jobTotal}} from {{requestee}} for job {{jobId}}",taskPriority:1,taskTemplate:"{{requester}} requested  threshold approval for\n     {{jobTotal}} from {{requestee}} for job {{jobId}}",title:"Job is waiting for threshold approval",toastTemplate:"{{requester}} requested  threshold approval for\n     {{jobTotal}} from {{requestee}} for job {{jobId}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobTotal:"",requestee:"",requester:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"The threshold request has been approved on a job",emailBodyTemplate:"{{type}} of {{jobTotal}} approved by {{approver}} for job {{jobId}}",emailSubjectTemplate:"{{type}} of {{jobTotal}} approved by {{approver}} for job {{jobId}}",name:"thresholdApproved",notificationContent:"{{type}} of {{jobTotal}} approved by {{approver}} for job {{jobId}}",notificationHeading:"Threshold is approved",notificationSubtitle:"Threshold is approved",slackTemplate:null,smsTemplate:"Threshold is approved",systemTemplate:"{{type}} of {{jobTotal}} approved by {{approver}} for job {{jobId}}",taskPriority:3,taskTemplate:"{{type}} of {{jobTotal}} approved by {{approver}} for job {{jobId}}",title:"Threshold is approved",toastTemplate:"{{type}} of {{jobTotal}} approved by {{approver}} for job {{jobId}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",type:"",jobTotal:"",approver:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"The threshold request has been rejected on a job",emailBodyTemplate:"{{type}} of {{jobTotal}} rejected by {{rejecter}} for job {{jobId}}",emailSubjectTemplate:"Threshold is rejected",name:"thresholdRejected",notificationContent:"Threshold is rejected",notificationHeading:"Threshold is rejected",notificationSubtitle:"Threshold is rejected",slackTemplate:null,smsTemplate:"Threshold is rejected",systemTemplate:"{{type}} of {{jobTotal}} rejected by {{rejecter}} for job {{jobId}}",taskPriority:3,taskTemplate:"{{type}} of {{jobTotal}} rejected by {{rejecter}} for job {{jobId}}",title:"Threshold is rejected",toastTemplate:"{{type}} of {{jobTotal}} rejected by {{rejecter}} for job {{jobId}}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",type:"",jobTotal:"",rejecter:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"An uplift has been requested by a supplier",emailBodyTemplate:"Uplift is requested by supplier.",emailSubjectTemplate:"Uplift is requested",name:"jobSupplierUpliftRequested",notificationContent:"Uplift is requested by supplier.",notificationHeading:"Uplift is requested",notificationSubtitle:"Uplift is requested by supplier.",slackTemplate:null,smsTemplate:"Uplift is requested by supplier.",systemTemplate:"Uplift is requested of {{total}} by supplier.",taskPriority:3,taskTemplate:"Uplift is requested by supplier.",title:"Uplift is requested",toastTemplate:"Uplift is requested by supplier.",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",total:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",supplier:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"An admin user has sent an uplift request to a customer",emailBodyTemplate:"Uplift request sent to customer.",emailSubjectTemplate:"Uplift request sent to customer",name:"jobUpliftRequestSendCustomer",notificationContent:"Uplift request sent to customer.",notificationHeading:"Uplift request sent to customer",notificationSubtitle:"Uplift request sent to customer",slackTemplate:null,smsTemplate:"Uplift request sent to customer.",systemTemplate:"Admin sends uplift of {{total}} to customer.",taskPriority:3,taskTemplate:"Uplift request sent to customer.",title:"Uplift request sent to customer",toastTemplate:"Uplift request sent to customer.",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",total:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",supplier:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"An uplift request has been approved by a customer",emailBodyTemplate:"Uplift is approved by customer",emailSubjectTemplate:"Uplift is approved by customer",name:"jobCustomerUpliftApproved",notificationContent:"Uplift is approved by customer",notificationHeading:"Uplift is approved",notificationSubtitle:"Uplift is approved by customer",slackTemplate:null,smsTemplate:"Uplift is approved by customer",systemTemplate:"Uplift is approved by customer. {{notes}}",taskPriority:3,taskTemplate:"Uplift is approved by customer",title:"Uplift is approved",toastTemplate:"Uplift is approved by customer",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",notes:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",supplier:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"An uplift request has been rejected by a customer",emailBodyTemplate:"An uplift request has been rejected by a customer",emailSubjectTemplate:"Uplift is rejected",name:"jobCustomerUpliftRejected",notificationContent:"An uplift request has been rejected by a customer",notificationHeading:"Uplift is rejected",notificationSubtitle:"An uplift request has been rejected by a customer",slackTemplate:null,smsTemplate:"An uplift request has been rejected by a customer",systemTemplate:"An uplift request has been rejected by a customer. {{notes}}",taskPriority:3,taskTemplate:"An uplift request has been rejected by a customer",title:"Uplift is rejected",toastTemplate:"An uplift request has been rejected by a customer",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",notes:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",supplier:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"A job has been cancelled by a supplier",emailBodyTemplate:"Job is cancelled by supplier",emailSubjectTemplate:"Job is cancelled by supplier",name:"jobSupplierCancel",notificationContent:"Job is cancelled by supplier",notificationHeading:"Job is cancelled by supplier",notificationSubtitle:"Job is cancelled by supplier",slackTemplate:null,smsTemplate:"Job is cancelled by supplier",systemTemplate:"Job is cancelled by supplier",taskPriority:3,taskTemplate:"Job is cancelled by supplier",title:"Job is cancelled by supplier",toastTemplate:"Job is cancelled by supplier",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",user:"",customerUser:"",serviceLine:"",supplier:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"Job offer input has been updated by a supplier",emailBodyTemplate:"Job offer input is updated by supplier",emailSubjectTemplate:"Job offer input is updated by supplier",name:"jobUpdateAcceptOfferInput",notificationContent:"Job offer input is updated by supplier",notificationHeading:"Job offer input is updated by supplier",notificationSubtitle:"Job offer input is updated by supplier",slackTemplate:null,smsTemplate:"Job offer input is updated by supplier",systemTemplate:"Job offer input is updated by supplier",taskPriority:3,taskTemplate:"Job offer input is updated by supplier",title:"Job offer input is updated by supplier",toastTemplate:"Job offer input is updated by supplier",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",supplier:""},meta:{sendTo:{}}},{category:"quotes",type:"trigger",description:"A quote has been raised on the system",emailBodyTemplate:null,emailSubjectTemplate:null,name:"quoteRaised",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Quote raised",taskPriority:3,taskTemplate:null,title:"Quote raised",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{property:"",customer:"",addressPostCode:"",addressInline:"",user:"",jobId:"",jobStatus:"",shortJobDesc:"",description:""},meta:{sendTo:{}}},{category:"quotes",type:"trigger",description:'The status of a quote has changed to "requested"',emailBodyTemplate:null,emailSubjectTemplate:null,name:"quoteRequested",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Quote requested from suppliers",taskPriority:3,taskTemplate:null,title:"Quote requested",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:""},meta:{sendTo:{}}},{category:"quotes",type:"trigger",description:"A supplier has rejected a request for quote",emailBodyTemplate:null,emailSubjectTemplate:null,name:"supplierQuoteRefused",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Quote declined by {{supplier}}",taskPriority:3,taskTemplate:null,title:"Quote declined",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:""},meta:{sendTo:{}}},{category:"quotes",type:"trigger",description:"A supplier has submitted a quotation",emailBodyTemplate:null,emailSubjectTemplate:null,name:"supplierQuoteComplete",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Quote totalling {{total}} has been submitted by {{supplier}} {{user}}",taskPriority:3,taskTemplate:null,title:"Quotation submitted",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{property:"",customer:"",addressPostCode:"",addressInline:"",total:"",supplier:"",user:"",jobId:"",jobStatus:"",shortJobDesc:"",description:""},meta:{sendTo:{}}},{category:"quotes",type:"trigger",description:"An admin user has sent a quotation to a customer",emailBodyTemplate:null,emailSubjectTemplate:null,name:"quoteSent",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Quote number {{quoteNumber}} has been sent to customer.",taskPriority:3,taskTemplate:null,title:"Quotation sent to customer",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{property:"",customer:"",addressPostCode:"",addressInline:"",quoteNumber:"",jobId:"",jobStatus:"",shortJobDesc:"",description:""},meta:{sendTo:{}}},{category:"quotes",type:"trigger",description:"A customer has accepted a quotation",emailBodyTemplate:null,emailSubjectTemplate:null,name:"quoteAccepted",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Quote number {{quoteNumber}} has been accepted by {{customer}} User: {{user}}",taskPriority:3,taskTemplate:null,title:"Quote accepted",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{property:"",customer:"",addressPostCode:"",addressInline:"",quoteNumber:"",user:"",jobId:"",jobStatus:"",shortJobDesc:"",description:""},meta:{sendTo:{}}},{category:"quotes",type:"trigger",description:"A customer has rejected a quotation",emailBodyTemplate:null,emailSubjectTemplate:null,name:"quoteRejected",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Quote number {{quoteNumber}} has been rejected by {{customer}} User: {{user}}",taskPriority:3,taskTemplate:null,title:"Quote rejected",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{property:"",customer:"",addressPostCode:"",addressInline:"",quoteNumber:"",user:"",jobId:"",jobStatus:"",shortJobDesc:"",description:""},meta:{sendTo:{}}},{category:"quotes",type:"trigger",description:"A supplier has selected the timing of a site visit",emailBodyTemplate:null,emailSubjectTemplate:null,name:"supplierSelectSiteVisit",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Supplier selects site visit {{siteVisitAt}}",taskPriority:3,taskTemplate:null,title:"Site visit option selected",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",siteVisitAt:""},meta:{sendTo:{}}},{category:"quotes",type:"trigger",description:"A quote has not been sent to the customer",emailBodyTemplate:null,emailSubjectTemplate:null,name:"quoteNotSent",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Quote is not sent",taskPriority:3,taskTemplate:null,title:"Quote is not sent",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:""},meta:{sendTo:{}}},{category:"quotes",type:"trigger",description:"A quotation has not been completed by the supplier",emailBodyTemplate:null,emailSubjectTemplate:null,name:"quoteNotComplete",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Quote is not completed",taskPriority:3,taskTemplate:null,title:"Quote is not completed",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:""},meta:{sendTo:{}}},{category:"quotes",type:"trigger",description:"A quote is currently awaiting threshold approval",emailBodyTemplate:"Quote is waiting for threshold approval.",emailSubjectTemplate:"waiting for approval",name:"quoteWaitingForThresholdApproval",notificationContent:"Quote is waiting for threshold approval.",notificationHeading:"Quote is waiting for threshold approval",notificationSubtitle:"Quote is waiting for threshold approval",slackTemplate:null,smsTemplate:"Quote is waiting for threshold approval.",systemTemplate:"Quote is waiting for threshold approval.",taskPriority:3,taskTemplate:"Quote is waiting for threshold approval.",title:"Quote is waiting for threshold approval",toastTemplate:"Quote is waiting for threshold approval.",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{user:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",threshold:""},meta:{sendTo:{}}},{category:"quotes",type:"trigger",description:"The threshold request on a quote has been approved",emailBodyTemplate:"Quote threshold is approved",emailSubjectTemplate:"Threshold is approved",name:"quoteThresholdApproved",notificationContent:"Quote threshold is approved",notificationHeading:"Quote threshold is approved",notificationSubtitle:"Quote threshold is approved",slackTemplate:null,smsTemplate:"Quote threshold is approved",systemTemplate:"Quote threshold is approved",taskPriority:3,taskTemplate:"Quote threshold is approved",title:"Quote threshold is approved",toastTemplate:"Quote threshold is approved",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{user:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",threshold:""},meta:{sendTo:{}}},{category:"quotes",type:"trigger",description:"The threshold request on a quote has been rejected",emailBodyTemplate:"Quote threshold is rejected",emailSubjectTemplate:"Quote threshold is rejected",name:"quoteThresholdRejected",notificationContent:"Quote threshold is rejected",notificationHeading:"Quote threshold is rejected",notificationSubtitle:"Quote threshold is rejected",slackTemplate:null,smsTemplate:"Quote threshold is rejected",systemTemplate:"Quote threshold is rejected",taskPriority:3,taskTemplate:"Quote threshold is rejected",title:"Quote threshold is rejected",toastTemplate:"Quote threshold is rejected}",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{user:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",threshold:""},meta:{sendTo:{}}},{category:"ppm",type:"trigger",description:"A new supplier contract has been created at a property",emailBodyTemplate:"Hi {{name}},\n\nA new supplier contract has been created at {{property}}: {{shortJobDesc}}.\nClick the button below to review and confirm.\n",emailSubjectTemplate:"Booking added to Cleverly",name:"ppmSupplierContractAdded",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,taskTemplate:null,title:"Supplier contract added",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms","notification","toast"],tags:{name:"",property:"",customer:"",addressPostCode:"",addressInline:"",shortJobDesc:""},meta:{sendTo:{}}},{category:"ppm",type:"cron",description:"This is the reminder for an upcoming scheduled job (<1 day before scheduled attendance)",emailBodyTemplate:"Hi {{name}},\n\nYou have an upcoming job at {{property}} scheduled at {{date}}.\nClick the button below to confirm attendance.\n",emailSubjectTemplate:"Upcoming scheduled job",name:"ppmJobReminder",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,taskTemplate:null,title:"Upcoming scheduled job",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms","notification","toast"],tags:{name:"",property:"",addressPostCode:"",addressInline:"",date:"",shortJobDesc:""},meta:{sendTo:{}}},{category:"assets",type:"trigger",description:"Notify invitees when a booking is created",emailBodyTemplate:"Hi,\n\nYou've been invited to {{bookingTitle}} at {{property}} on {{bookingStart}}.",emailSubjectTemplate:"Invitation",name:"assetBookingAdded",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,taskTemplate:null,title:"Asset booking invitation",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",bookingEnd:"",bookingStart:"",bookingTitle:""},meta:{sendTo:{}}},{category:"assets",type:"trigger",description:"Notify invitees when a booking is updated",emailBodyTemplate:"Hi,\n\nInvitation to {{bookingTitle}} at {{property}} on {{bookingStart}} has been updated.",emailSubjectTemplate:"Booking updated",name:"assetBookingUpdated",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,taskTemplate:null,title:"Asset booking invitation update",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",bookingEnd:"",bookingStart:"",bookingTitle:""},meta:{sendTo:{}}},{category:"assets",type:"trigger",description:"Notify invitees when a booking is cancelled",emailBodyTemplate:"Hi {{name}},\n\nInvitation to {{bookingTitle}} at {{property}} on {{bookingStart}} has been cancelled.",emailSubjectTemplate:"Booking cancelled",name:"assetBookingCancelled",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,taskTemplate:null,title:"Asset booking invitation cancelled",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",bookingEnd:"",bookingStart:"",bookingTitle:""},meta:{sendTo:{}}},{category:"assets",type:"trigger",description:"Temperature sensor out of bounds",emailBodyTemplate:"Hi {{name}},\n\nA sensor at {{property}} is out of bounds.",emailSubjectTemplate:"Sensor out of bounds",name:"sensorOutOfBounds",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,taskTemplate:null,title:"Sensor out of bounds",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:""},meta:{sendTo:{}}},{category:"assets",type:"cron",description:"Asset vacated based on occupancy sensor",emailBodyTemplate:"Hi {{name}},\n\nAsset {{asset}} at {{property}} has been vacated.",emailSubjectTemplate:"Asset vacated",name:"assetVacated",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,taskTemplate:null,title:"Asset vacated",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",asset:""},meta:{sendTo:{}}},{category:"supplierOnboarding",type:"trigger",description:"An admin user has created a new supplier account",emailBodyTemplate:"Thank you for your interest in becoming a supplier to Cleverly\n\n    By completing your profile you will be able to start receiving work orders from the system and\n    getting paid for works undertaken.\n\n    By clicking the button below, you will be prompted to create a password. After this, you will\n    eed to provide information to register yourself as a supplier.\n\n    We hope that you will find the platform easy to use and self-explanatory, but please let us know\n    if you encounter any issues. You can do so by emailing us at suppliers@cleverly.works\n\n    We look forward to welcoming you as a Cleverly supplier soon.",emailSubjectTemplate:"Becoming a Cleverly Supplier",name:"supplierCreated",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"",taskPriority:3,taskTemplate:null,title:"Supplier created",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms"],tags:{name:"",accountName:""},meta:null},{category:"customerOnboarding",type:"trigger",description:"An admin user has created a new customer account",emailBodyTemplate:"Hi {{accountName}}\n\n    Let’s get started!\n\n    Cleverly has been built to be as intuitive and powerful as possible.\n\n    The first step is to complete your profile and add your team members and colleagues. By letting\n    us know who to contact about jobs, invoices etc. you can ensure that the right people get the\n    right information.\n\n    By clicking the button below, you will be prompted to create a password and complete your\n    profile. Once this is done, you can start to add other information such as properties.\n\n    And if you have any issues, just get in touch with us. We are happy to help.",emailSubjectTemplate:"Welcome to Cleverly",name:"customerCreated",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"",taskPriority:3,taskTemplate:null,title:"Customer created",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms"],tags:{name:"",accountName:""},meta:null},{category:"tenantOnboarding",type:"trigger",description:"A tenant has been added to a property",emailBodyTemplate:"Hi {{name}},\n\n    Your booking at {{property}} has been added to Cleverly.\n    Click the button below to report any issues during your stay:",emailSubjectTemplate:"Booking added to Cleverly",name:"tenantBookingAdded",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,taskTemplate:null,title:"Tenant booking added",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:""},meta:{sendTo:{}}},{category:"accounts",type:"trigger",description:"A new user has been added to an existing account",emailBodyTemplate:"Hi {{name}},\n\n    You have been invited to Cleverly by {{accountName}}. Click the button below to set your\n    password and complete your profile.",emailSubjectTemplate:"Welcome to Cleverly",name:"userAddedToAccount",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,title:"User created",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms"],tags:{name:"",accountName:""},meta:null},{category:"accounts",type:"trigger",description:"A user has forgotten their password and requested a reset",emailBodyTemplate:"Hi {{name}},\n\n    You can reset your Cleverly password by clicking the button below or copying and pasting it\n    into your browser. For increased security, this password reset link will expire 24 hours after\n    it was sent.",emailSubjectTemplate:"Reset your Cleverly password",name:"userPasswordReset",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,title:"User password reset",toastTemplate:null,whatsappTemplate:null,enabled:["email"],tags:{name:""},meta:null},{category:"accounts",type:"trigger",description:"A user has received a message within the job context window",emailBodyTemplate:"Hi {{name}},\n\nYou've been tagged in a message:\n{{message}}",emailSubjectTemplate:"{{sender}} has sent a new message",name:"userReceivesMessage",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,title:"New message",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms","notification","toast"],tags:{name:"",message:"",sender:""},meta:null},{category:"accounts",type:"trigger",description:"A user has been assigned a new task",emailBodyTemplate:"Hi {{name}},\n\nA new task has been assigned to you. Click the button bellow to see it.",emailSubjectTemplate:"New task assigned",name:"userReceivesTask",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,title:"New task assigned",toastTemplate:null,whatsappTemplate:null,enabled:["email","sms","notification","toast"],tags:{name:"",date:"",content:""},meta:null},{category:"accounts",type:"trigger",description:"There is a compliance document which is shortly due to expire (in 30 days)",emailBodyTemplate:'Hi {{name}},\n\n    We wanted to let you know that one (or more) of your accreditations or insurances listed below\n    is due to expire shortly. In order to keep your account active, please send us an updated copy\n    of your document so that we can place this on your account.\n\n    [[TABLE {"Type": "scheme", "Issuing body": "provider", "Expiry Date": "date"}]]\n\n    To see all your current documents and account details, along with further details of works,\n    your earnings history and of course your performance data just login to your Cleverly account.',emailSubjectTemplate:"Cleverly Admin Document Expiry",name:"documentExpiry",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:"Document is expiring, please check the desktop platform.",systemTemplate:null,taskPriority:3,taskTemplate:"Check customer documents with them",title:"Document expiry",toastTemplate:null,whatsappTemplate:null,enabled:["email"],tags:{name:"",accountName:"",date:""},meta:null},{category:"broadcasts",type:"trigger",description:"Broadcast message is published",emailBodyTemplate:"Hi {{name}},\n\n    {{message}}",emailSubjectTemplate:"You have a message",name:"broadcast",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:"A broadcast message is published",systemTemplate:null,taskPriority:3,taskTemplate:"A broadcast message is published",title:"A broadcast message is published",toastTemplate:null,whatsappTemplate:null,enabled:["email"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",name:"",message:""},meta:null},{category:"system-emails",type:"trigger",description:"An admin user has sent an invoice to the customer",emailBodyTemplate:"Hi {{customer}},\n\n    Your invoice for job {{jobId}} at {{property}} is now available, click the button below to\n    download it.",emailSubjectTemplate:"System - Invoice for job {{jobId}}",name:"system-jobInvoiceSentCustomer",notificationContent:null,notificationHeading:"Customer Invoice for {{total}} sent",notificationSubtitle:"For Job {{jobId}}",slackTemplate:null,smsTemplate:null,systemTemplate:"Invoice in PDF has sent to customer {{userEmail}} by {{user}}",taskPriority:3,taskTemplate:null,title:"System - Invoice sent to customer",toastTemplate:null,whatsappTemplate:null,enabled:["system","email"],tags:{invoiceNumber:"",userEmail:"",property:"",customer:"",addressPostCode:"",addressInline:"",total:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customerUser:"",serviceLine:"",user:"",file_buttons:""},meta:null},{category:"system-emails",type:"trigger",description:"A non logged user has reported an issue",emailBodyTemplate:"Hi {{userName}} (phone - {{userPhone}}, email - {{userEmail}}),\n\n    Your issue about {{issueType}} with a reason {{description}} was reported with number {{jobNumber}}, thank you! \n",emailSubjectTemplate:"System - Reported issue by {{userName}}",name:"system-reportedByNonLoggedUser",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Issue was reported",taskPriority:3,taskTemplate:null,title:"System - Non logged user reported an issue",toastTemplate:null,whatsappTemplate:null,enabled:["system","email"],tags:{jobNumber:"",userEmail:"",userName:"",userPhone:"",description:"",issueType:""},meta:null},{category:"system-emails",type:"trigger",description:"An admin user has sent an invoice to the supplier",emailBodyTemplate:"Hi {{supplierUser}},\n\n    Your invoice for job {{jobId}} at {{property}} is now available, click the button below to\n    download it.",emailSubjectTemplate:"System - Invoice for job {{jobId}}",name:"system-jobInvoiceSentSupplier",notificationContent:"{{user}} has sent an Invoice to Supplier {{supplierUser}}",notificationHeading:"Supplier Invoice for {{total}} sent",notificationSubtitle:"For Job {{jobId}}",slackTemplate:null,smsTemplate:null,systemTemplate:"Invoice in PDF has sent to supplier {{userEmail}} by {{user}}",taskPriority:3,taskTemplate:null,title:"System - Invoice sent to supplier",toastTemplate:null,whatsappTemplate:null,enabled:["system","email"],tags:{invoiceNumber:"",userEmail:"",property:"",customer:"",addressPostCode:"",addressInline:"",total:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:"",user:"",file_buttons:""},meta:null},{category:"system-emails",type:"trigger",description:"An admin user has sent a submitted quotation to the customer",emailBodyTemplate:"Hi {{customer}},\n\n    {{name}} has sent you a new Quotation for job {{jobId}} just for now.\n\n Click the button below to view it on Cleverly portal.",emailSubjectTemplate:"System - New Quote for Job {{jobId}}!",name:"system-emailQuoteSent",notificationContent:"{{name}} has sent a Quote to {{customer}}",notificationHeading:"Quote sent",notificationSubtitle:"For Job {{jobId}}",slackTemplate:null,smsTemplate:null,systemTemplate:"Quote sent in PDF to {{userEmail}} by {{name}}",taskPriority:3,title:"System - Send Quote",toastTemplate:null,whatsappTemplate:null,enabled:["system","email"],tags:{customer:"",userEmail:"",jobId:"",name:"",file_buttons:""},meta:null},{category:"system-emails",type:"trigger",description:"An admin user has sent a job report to the customer",emailBodyTemplate:"Hi {{customer}}\n\n    A report for job {{jobId}} at {{property}} can be downloaded by clicking the button below.",emailSubjectTemplate:"System - {{jobId}} job report",name:"system-jobReportSent",notificationContent:"{{name}} has sent a Report to {{customer}}",notificationHeading:"Report Sent",notificationSubtitle:"For Job {{jobId}}",slackTemplate:null,smsTemplate:null,systemTemplate:"Job report in PDF sent to {{userEmail}} by {{user}}",taskPriority:3,taskTemplate:null,title:"System - Job report sent",toastTemplate:null,whatsappTemplate:null,enabled:["system","email"],tags:{property:"",customer:"",userEmail:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customerUser:"",supplier:"",supplierUser:"",user:"",file_buttons:""},meta:null},{category:"bookings",type:"trigger",description:"A credit note has been applied to an invoice",emailBodyTemplate:"{{supplier}} created an creditNote for job {{jobId}} .\n    Please review the creditNote.",emailSubjectTemplate:"Created creditNote",name:"creditNoteCreated",notificationContent:"{{user}} created an creditNote for job {{jobId}}. {{reason}}",notificationHeading:"CreditNote Created",notificationSubtitle:"added an CreditNote",slackTemplate:null,smsTemplate:"CreditNote Uploaded",systemTemplate:"CreditNote created, {{reason}}",taskPriority:3,taskTemplate:null,title:"Credit note created",toastTemplate:"Created creditNote",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",supplier:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"A proforma invoice has been created on a job",emailBodyTemplate:"{{customer}} created a Proforma Invoice for job {{jobId}} .\n    Please review it.",emailSubjectTemplate:"Created proforma invoice",name:"proformaInvoiceCreated",notificationContent:"{{user}} created a proformaInvoice for job {{jobId}}.",notificationHeading:"ProformaInvoice Created",notificationSubtitle:"added a proformaInvoice",slackTemplate:null,smsTemplate:"proformaInvoice Uploaded",systemTemplate:"proformaInvoice created",taskPriority:3,taskTemplate:null,title:"Pro-forma invoice created",toastTemplate:"Pro-forma invoice created",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",user:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"Sent to a supplier when an admin user changes the job time",emailBodyTemplate:"Hi {{supplierUser}}\n\n    The scheduled time for job {{jobId}} has changed.\n    Job start: {{correctStart}} Job end: {{correctEnd}}\n\n    Please login and confirm the attendance time.",emailSubjectTemplate:"Job start, end date were changed",name:"jobCorrectTiming",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"{{user}} changed job timings. Job start: {{correctStart}} Job end: {{correctEnd}}",taskPriority:3,taskTemplate:null,title:"Job timings changed",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",supplierUser:"",correctStart:"",correctEnd:"",jobId:"",user:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"Triggers when estimated duration was changed.",emailBodyTemplate:"{{user}} changed the estimated job duration to {{estimatedDuration}} {{estimatedDurationUnit}}",emailSubjectTemplate:"Job estimated duration was changed",name:"jobEstimatedDuration",notificationContent:"{{user}} changed the estimated job duration to {{estimatedDuration}} {{estimatedDurationUnit}}",notificationHeading:"Job estimated duration was changed",notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"{{user}} changed the estimated job duration to {{estimatedDuration}} {{estimatedDurationUnit}}",taskPriority:3,taskTemplate:null,title:"Job estimated duration was changed",toastTemplate:"Job estimated duration was changed",whatsappTemplate:null,enabled:["system","email","sms","notification","toast"],tags:{user:"",estimatedDuration:"",estimatedDurationUnit:"",property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"A signature has been added to a job report",emailBodyTemplate:"A signature has been added to a job report",emailSubjectTemplate:"Signatures added for jobReport",name:"signatureUploaded",notificationContent:"Signatures added for jobReport with this jobId: {{jobId}}",notificationHeading:"Signature captured",notificationSubtitle:"Signatures added for a jobReport",slackTemplate:null,smsTemplate:"Signatures added for job {{jobId}}",systemTemplate:"A signature has been added to a job report",taskPriority:3,taskTemplate:null,title:"Signature captured",toastTemplate:"Signatures added",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",user:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:"",jobReport:"",signatureName:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"A job that requires it did not record a customer or engineer signature",emailBodyTemplate:"Signature not captured for jobReport {{jobId}} .\n    Please review the job.",emailSubjectTemplate:"Signature not captured for jobReport",name:"signatureNotCaptured",notificationContent:"Signature not captured for jobReport {{jobId}}",notificationHeading:"signatureNotCaptured",notificationSubtitle:"Signature not captured for a jobReport",slackTemplate:null,smsTemplate:"Signature not captured for job {{jobId}}",systemTemplate:"A job that requires it did not record a customer or engineer signature",taskPriority:3,taskTemplate:null,title:"Signature not captured",toastTemplate:"Signature not captured",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{invoiceNumber:"",property:"",customer:"",addressPostCode:"",addressInline:"",user:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:"",jobReport:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"An expense with a pending price has been input.",emailBodyTemplate:"",emailSubjectTemplate:"",name:"expensesPendingAmount",notificationContent:"",notificationHeading:"",notificationSubtitle:"",slackTemplate:null,smsTemplate:"",systemTemplate:"",taskPriority:3,taskTemplate:null,title:"Pending expense status added",toastTemplate:"",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",user:"",supplier:"",serviceLine:"",supplierUser:"",expenseName:""},meta:{sendTo:{}}},{category:"quotes",type:"trigger",description:"A remedial quote has been raised on the system",emailBodyTemplate:null,emailSubjectTemplate:null,name:"remedialQuoteRaised",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"A remedial quote has been raised on the system",taskPriority:3,taskTemplate:null,title:"Remedial quote raised",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{jobType:"",property:"",customer:"",addressPostCode:"",addressInline:"",supplier:"",user:"",jobId:"",jobStatus:"",shortJobDesc:"",description:""},meta:{sendTo:{}}},{category:"quotes",type:"trigger",description:"Quote SLA breach",emailBodyTemplate:null,emailSubjectTemplate:null,name:"quoteSlaBreached",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:"Quote SLA breach",taskPriority:3,taskTemplate:null,title:"Quote SLA breach",toastTemplate:null,whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast","slack","whatsapp"],tags:{property:"",customer:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customerUser:"",serviceLine:"",supplier:""},meta:{sendTo:{}}},{category:"bookings",type:"trigger",description:"A work order has been rolled back to a previous status.",emailBodyTemplate:"",emailSubjectTemplate:"",name:"rollBackEvent",notificationContent:"",notificationHeading:"",notificationSubtitle:"",slackTemplate:null,smsTemplate:"",systemTemplate:"{{user}} changed the job status from {{oldJobStatus}} to {{jobStatus}}",taskPriority:3,taskTemplate:null,title:"Revert job to prior status",toastTemplate:"",whatsappTemplate:null,enabled:["system","email","task","sms","notification","toast"],tags:{oldJobStatus:"",jobReport:"",timer:"",property:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",scheduleDate:"",customer:"",customerUser:"",serviceLine:"",supplier:"",supplierUser:"",user:"",jobTotal:""},meta:{sendTo:{}}},{category:"accounts",type:"trigger",description:"A new comment has been added that is visible to admin users",emailBodyTemplate:"A new comment has been added by {{sender}}.\n    //  {{message}}. //\n    Please click on the button below to see it.",emailSubjectTemplate:"New comment added",name:"newCommentAddedAdmin",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,taskTemplate:null,title:"New comment for Admins",toastTemplate:null,whatsappTemplate:null,enabled:["email"],tags:{name:"",message:"",sender:"",property:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customer:""},meta:{sendTo:{admin:"all"}}},{category:"accounts",type:"trigger",description:"A new comment has been added that is visible to supplier users",emailBodyTemplate:"A new comment has been added by {{sender}}.\n      //  {{message}}. //\n      Please click on the button below to see it.",emailSubjectTemplate:"New comment added",name:"newCommentAddedSupplier",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,taskTemplate:null,title:"New comment for Suppliers",toastTemplate:null,whatsappTemplate:null,enabled:["email"],tags:{name:"",message:"",sender:"",property:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customer:""},meta:{sendTo:{supplier:"all"}}},{category:"accounts",type:"trigger",description:"A new comment has been added that is visible to customer users",emailBodyTemplate:"A new comment has been added by {{sender}}.\n      //  {{message}}. //\n      Please click on the button below to see it.",emailSubjectTemplate:"New comment added",name:"newCommentAddedCustomer",notificationContent:null,notificationHeading:null,notificationSubtitle:null,slackTemplate:null,smsTemplate:null,systemTemplate:null,taskPriority:3,taskTemplate:null,title:"New comment for Customers",toastTemplate:null,whatsappTemplate:null,enabled:["email"],tags:{name:"",message:"",sender:"",property:"",addressPostCode:"",addressInline:"",jobId:"",jobStatus:"",shortJobDesc:"",description:"",customer:""},meta:{sendTo:{customer:"all"}}}],eW=n(10367);function eG(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function eX(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eG(Object(n),!0).forEach(function(t){(0,A.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eG(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var eK=function(e){var t,n,a,s,o,i,r=e.app,u=e.defaultValues,c=void 0===u?{}:u,p=e.onSubmit,d=Object.keys(c.tags).reduce(function(e,t){return eX(eX({},e),{},(0,A.Z)({},t,t))},{});c.emailTemplateData=JSON.stringify(d);var m,b=(0,l.useState)(!1),y=b[0],f=b[1],h=(0,D.cI)({defaultValues:c,resolver:(0,U.S)((m=!y,(0,e_.Ry)().shape({title:(0,e_.Z_)().required(),category:(0,e_.Z_)().required(),name:(0,e_.Z_)().required(),description:(0,e_.Z_)(),sendTo:(0,e_.Ry)().shape({admin:(0,e_.Z_)().nullable(),customer:(0,e_.Z_)().nullable(),supplier:(0,e_.Z_)().nullable(),tenant:(0,e_.Z_)().nullable()}).required(),email:(0,e_.Xg)(),emailTemplate:(0,e_.Z_)(),emailSubjectTemplate:(0,e_.Z_)().when(["email"],function(e,t){return e?t.required().min(1):t.nullable()}),emailBodyTemplate:(0,e_.Z_)().when(["email"],function(e,t){return e?t.required().min(1):t.nullable()}),emailTemplateData:m?(0,e_.Z_)():(0,e_.Z_)().test("is-object","Email template data is not a valid JSON object",function(e){try{var t=JSON.parse(e);return"object"===(0,x.Z)(t)}catch(n){return!1}}).required("Email template data is required"),notification:(0,e_.Xg)(),notificationHeading:(0,e_.Z_)(),notificationSubtitle:(0,e_.Z_)(),notificationContent:(0,e_.Z_)(),task:(0,e_.Xg)(),taskPriority:(0,e_.Rx)().transform(function(e){return isNaN(e)?null:e}).nullable(),taskTemplate:(0,e_.Z_)(),systemTemplate:(0,e_.Z_)()})))}),g=h.errors,T=h.getValues,j=h.handleSubmit,k=h.register,v=h.setValue,S=h.watch,w=h.control,P={errors:g,getValues:T,register:k,trigger:h.trigger},C=(0,l.useCallback)(function(){var e,t=[],n=eY.find(function(e){return e.name===c.name}),a=null===(e=n.meta)||void 0===e?void 0:e.sendTo;return n.meta&&a&&"object"===(0,x.Z)(a)?Object.keys(a).length?(Object.keys(a).forEach(function(e){var n=a[e],s=eM.find(function(t){return t.name===e});if(s&&"all"===n)t.push(s);else if(s&&Array.isArray(s.options)&&Array.isArray(n)){var o=s.options.filter(function(e){return n.includes(e.value)}),i=eX(eX({},s),{},{options:o});t.push(i)}}),t):eM:[]},[null===(t=c.meta)||void 0===t?void 0:t.sendTo,eM]),q=(0,l.useMemo)(function(){return C()},[]);return(0,er.jsxs)(_.Z,{id:"offCanvasForm",handleSubmit:j(p),children:[(0,er.jsxs)(N.Z,{children:[(0,er.jsxs)(B.Z,{md:6,children:[(0,er.jsx)(H.Z,{label:"Title",children:(0,er.jsx)($.Z,eX(eX({},P),{},{name:"title"}))}),(0,er.jsx)(H.Z,{label:"Category",children:(0,er.jsx)(L.Z,eX(eX({},P),{},{name:"category",options:eV}))})]}),(0,er.jsxs)(B.Z,{md:6,children:[(0,er.jsx)(H.Z,{label:"Name",children:(0,er.jsx)($.Z,eX(eX({},P),{},{name:"name",readOnly:!0}))}),(0,er.jsx)(H.Z,{label:"Description",children:(0,er.jsx)($.Z,eX(eX({},P),{},{name:"description"}))})]})]}),!!q.length&&(0,er.jsx)(I.Z,{title:"Send to",children:q.map(function(e){return(0,er.jsx)(D.Qr,{id:e.id,control:w,name:"sendTo.".concat(e.name),render:function(t){return(0,er.jsxs)(J.Z,{fullWidth:!0,children:[(0,er.jsx)(O.Z,{sx:{zIndex:0},id:"demo-simple-select-label",size:"small",children:e.label}),(0,er.jsx)(e0,eX(eX({labelId:"demo-simple-select-label",id:"demo-simple-select",label:e.label,MenuProps:{style:{zIndex:99999}}},t),{},{children:e.options.map(function(e){return(0,er.jsx)(Z.Z,{value:e.value,children:e.label},e.value)})}))]})}})})}),(null==c?void 0:null===(n=c.enabled)||void 0===n?void 0:n.includes("system"))&&(0,er.jsx)(I.Z,{title:"System Message",children:(0,er.jsx)(eH,eX(eX({},P),{},{defaultValues:c,setValue:v,watch:S}))}),(null==c?void 0:null===(a=c.enabled)||void 0===a?void 0:a.includes("email"))&&(0,er.jsx)(I.Z,{title:"Email",children:(0,er.jsx)(eA,eX(eX({},P),{},{app:r,defaultValues:c,setValue:v,watch:S,test:y,setTest:f}))}),(null==c?void 0:null===(s=c.enabled)||void 0===s?void 0:s.includes("task"))&&(0,er.jsx)(I.Z,{title:"Task",children:(0,er.jsx)(eR,eX(eX({},P),{},{defaultValues:c,setValue:v,watch:S}))}),(null==c?void 0:null===(o=c.enabled)||void 0===o?void 0:o.includes("notification"))&&(0,er.jsx)(I.Z,{title:"Push",children:(0,er.jsx)(eq,eX(eX({},P),{},{defaultValues:c,setValue:v,watch:S}))}),(null==c?void 0:null===(i=c.enabled)||void 0===i?void 0:i.includes("toast"))&&(0,er.jsx)(I.Z,{title:"Toast",children:(0,er.jsx)(ez,eX(eX({},P),{},{defaultValues:c,setValue:v,watch:S}))}),c.id&&(0,er.jsx)($.Z,eX(eX({},P),{},{name:"id",type:"hidden"})),c.adminId&&(0,er.jsx)($.Z,eX(eX({},P),{},{name:"adminId",type:"hidden"}))]})},e0=(0,eW.ZP)(q.Z).withConfig({displayName:"form__StyledSelect",componentId:"sc-ogcbrm-0"})(["height:36px;margin-bottom:10px;"]),e3=function(e){var t,n=e.adminId,a=e.events,s=e.filters,o=e.refetch,i=e.title,r=(0,C.q)(),u=(0,eJ.x)().user,p=(0,l.useContext)(v.Z),d=(0,k.D)(y),m=(0,c.Z)(d,1)[0],b=(0,k.D)(f),h=(0,c.Z)(b,1)[0],T=(t=(0,g.Z)(j().mark(function e(t){var n;return j().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=eh(t),!t.id){e.next=6;break}return e.next=4,h({variables:{id:t.id,changes:n}});case 4:e.next=9;break;case 6:return n.adminId=u.accountId,e.next=9,m({variables:{objects:n}});case 9:if(p.close(),o&&o(),!(n.email&&n.emailSubjectTemplate)){e.next=14;break}return e.next=14,ej(n);case 14:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),x=function(e){var t=ef(e.item,n);p.show({content:(0,er.jsx)(eK,{app:r,defaultValues:t,onSubmit:T}),title:"Edit Event Settings"})},A=[{formatter:function(e){var t=e.row;return(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)("strong",{children:t.name}),(0,er.jsx)(S.Z,{size:"sm",children:t.item.description})]})},text:"Event"},{text:"Send to"},{text:"Email"},{text:"Task"},{text:"Push"},{text:"Toast"},{formatter:w.Z,formatterData:[{context:"secondary",icon:["fas","edit"],onClick:function(e,t){return x(t)},tooltip:"Edit"}],text:"Actions"},{hidden:!0}];return(0,er.jsx)(I.Z,{open:!0,title:i,children:(0,er.jsx)(P.Z,{columns:A,rows:a.filter(function(e){return!s.q||e.name.includes(s.q)||e.title.includes(s.q)||e.description.includes(s.q)}).filter(function(e){return!s.type||e.type===s.type}).map(function(e){return{name:e.title,sendTo:eT(e),email:eg(e,"email"),task:eg(e,"task"),notification:eg(e,"notification"),toast:eg(e,"toast"),actions:"",item:e}})})})},e1=n(75903);function e6(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,a)}return n}function e4(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?e6(Object(n),!0).forEach(function(t){(0,A.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):e6(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var e9=function(e){var t=e.filters,n=e.setFilters,a=(0,D.cI)({defaultValues:t}),s=a.errors,o=a.handleSubmit,i=a.register,l=function(e){n(function(t){return e4(e4({},t),{},{q:e.query||""})})};return(0,er.jsx)(I.Z,{title:"Filters",open:!0,children:(0,er.jsx)(_.Z,{handleSubmit:o(l),children:(0,er.jsxs)(N.Z,{children:[(0,er.jsx)(B.Z,{md:3,children:(0,er.jsx)(e1.Z,{errors:s,label:"Search",placeholder:"Search...",prependSearchIcon:!0,register:i,type:"search"})}),(0,er.jsx)(B.Z,{md:3,children:(0,er.jsx)(L.Z,e4(e4({},{errors:s,register:i}),{},{name:"type",onChange:function(e){return n(function(t){return e4(e4({},t),{},{type:e.target.value||""})})},options:[{value:"",text:"Type"},{value:"trigger",text:"Triggered Events"},{value:"cron",text:"Cron Events"}]}))})]})})})},e5=function(e){var t=e.category,n=(0,l.useContext)(h.Z).user,a=(0,l.useState)({q:"",type:""}),s=a[0],o=a[1],i=(0,l.useState)([]),r=i[0],u=i[1],d=(null==n?void 0:n.accountType)==="admin"?n.accountId:null,m=(0,p.t)(b,{skip:!d,variables:{adminId:d,category:t},onCompleted:function(e){var n=ey(t,eY,null==e?void 0:e.items);u(n)}}),y=(0,c.Z)(m,1)[0];return((0,l.useEffect)(function(){y()},[]),d)?(0,er.jsxs)(er.Fragment,{children:[(0,er.jsx)(e9,{filters:s,setFilters:o}),(0,er.jsx)(e3,{adminId:d,events:r,filters:s,refetch:y,title:"Events"},t)]}):null},e2=function(){var e=(0,r.useRouter)().query,t=(0,l.useMemo)(function(){return e.tab||"jobs"},[e.tab]);return(0,er.jsxs)(u.Z,{children:[(0,er.jsx)("div",{active:"jobs"===t,label:"Jobs",children:(0,er.jsx)(e5,{category:"bookings"})}),(0,er.jsx)("div",{active:"quotes"===t,label:"Quotes",children:(0,er.jsx)(e5,{category:"quotes"})}),(0,er.jsx)("div",{active:"planned-maintenance"===t,label:"Planned Maintenance",children:(0,er.jsx)(e5,{category:"ppm"})}),(0,er.jsx)("div",{active:"suppliers"===t,label:"Suppliers",children:(0,er.jsx)(e5,{category:"supplierOnboarding"})}),(0,er.jsx)("div",{active:"customers"===t,label:"Customers",children:(0,er.jsx)(e5,{category:"customerOnboarding"})}),(0,er.jsx)("div",{active:"tenants"===t,label:"Tenants",children:(0,er.jsx)(e5,{category:"tenantOnboarding"})}),(0,er.jsx)("div",{active:"accounts"===t,label:"Accounts",children:(0,er.jsx)(e5,{category:"accounts"})}),(0,er.jsx)("div",{active:"system-emails"===t,label:"System Emails",children:(0,er.jsx)(e5,{category:"system-emails"})})]},t)},e7=function(){return(0,er.jsx)(i.Z,{pageHeading:{heading:"Communications"},View:(0,er.jsx)(e2,{})})}},6256:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/communications",function(){return n(45463)}])}},function(e){e.O(0,[2283,212,8890,619,1336,6043,1564,6540,1023,7811,9774,2888,179],function(){return e(e.s=6256)}),_N_E=e.O()}]);