(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6889],{53344:function(e,n,t){"use strict";t.d(n,{Q:function(){return i}});var i=function(e){var n,t,i=e&&e.length>0&&e.find(function(e){var n;return(null===(n=e.medium)||void 0===n?void 0:n.category)==="avatar"});if(!i)return null;var a="".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(i.medium.filename),r=null==i?void 0:null===(n=i.medium)||void 0===n?void 0:null===(t=n.meta)||void 0===t?void 0:t.thumbnails;if(null!=r&&r.length){var o=r.find(function(e){return"small"===e.name});null!=o&&o.relativePath&&(a="".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(o.relativePath))}return a}},46165:function(e,n,t){"use strict";t.d(n,{g:function(){return E}});var i,a=t(67294),r=t(10367),o=t(78289),l=t(74147),d=t(9270),c=t(62140),s=t(65414),u=t(55843),m=t(45481),f=t(97303),x=t(33006),v=t(40826),p=t(55171),y=t.n(p),h=t(6812),j=t(71383),g=(0,t(75063).Ps)(i||(i=(0,j.Z)(["\n  query GetLog($entityId: bigint!, $entityName: String!) {\n    activity: audit_Activity(\n      where: { _and: [{ entityid: { _eq: $entityId } }, { entity: { _eq: $entityName } }] }\n    ) {\n      eventId\n      userId\n      user: User {\n        fullName\n      }\n      sessionUserName\n      transactionStart\n      statementStart\n      applicationName\n      clientAddr\n      clientPort\n      action\n      changedFields\n    }\n  }\n"]))),b=t(58965),Z=t(26186),_=t(86036),w=t(49501),N={U:"Update",I:"Insert",D:"Delete"},I=t(85893),P=function(e){var n=e.entityId,t=e.entityName,i=(0,h.a)(g,{variables:{entityId:n,entityName:t}}),a=i.loading,r=i.data,o=(r=void 0===r?{activity:[]}:r).activity;return!a&&(0,I.jsx)(d.Z,{children:(0,I.jsx)(c.Z,{md:12,children:o.map(function(e){var n,t;return(0,I.jsxs)(b.Z,{title:"".concat((null===(n=e.user)||void 0===n?void 0:n.fullName)||"Backend"," - ").concat((0,Z.Z)(e.transactionStart,!0)),children:[(0,I.jsx)(_.Z,{content:"Action:",text:N[t=e.action]||"-"}),(0,I.jsx)(u.Z,{}),(0,I.jsx)(w.Z,{label:"Changed:",children:(0,I.jsx)(y(),{collapsed:!0,displayDataTypes:!1,src:e.changedFields||"-"})}),(0,I.jsx)(_.Z,{content:"Application:",text:e.applicationName||"-"})]},e.userId)})})})},C=t(99229),S=t(93673),k=t(825),q=t(86559),H=t(72936),A=function(e){var n,t,i,a,r=e.job,o=e.numberPrefix,l=e.numberSuffix,d=(0,H.x)().hasRole;return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(_.Z,{content:"Type",text:(null===(n=S.x.find(function(e){return e.value===r.type}))||void 0===n?void 0:n.text)||"-"}),(0,I.jsx)(_.Z,{content:"Order",text:(0,I.jsx)(k.D,{id:r.id,number:r.number,invoiceNumber:null==r?void 0:null===(t=r.invoices)||void 0===t?void 0:null===(i=t[0])||void 0===i?void 0:i.invoiceNumber,type:r.type,numberPrefix:o,numberSuffix:l,isQuote:r.quoted})}),d("admin")&&r.source&&(0,I.jsx)(_.Z,{content:"Source",text:null===(a=q.Y.find(function(e){return e.value===r.source}))||void 0===a?void 0:a.text})]})};A.defaultProps={numberPrefix:"",numberSuffix:""};var E=function(e){var n=e.avatar,t=e.editable,i=e.entity,r=e.entityName,x=e.icons,v=e.job,p=e.linkTitleTo,y=e.log,h=e.numberPrefix,j=e.numberSuffix,g=e.prefix,b=(0,a.useContext)(o.Z),Z=(0,a.useState)(n),_=Z[0],w=Z[1],N=function(e){b.close(),null!=e&&e.filename?w("".concat("https://cleverly-media.s3.eu-west-2.amazonaws.com","/").concat(null==e?void 0:e.filename)):w(null)},S=function(){b.show({content:(0,I.jsx)(C.G,{category:"avatar",entity:r,entityId:null==i?void 0:i.id,filters:{category:"avatar"},limit:1,onMediaAdd:N,onMediaRemove:N,type:"image"}),title:"Avatar"})},k=function(){return(0,I.jsxs)(I.Fragment,{children:[(0,I.jsx)(F,{context:"primary",icon:"building"}),p?(0,I.jsx)($,{border:!1,passHref:!0,to:p,children:null==i?void 0:i.name}):null==i?void 0:i.name]})},q=function(){b.show({content:(0,I.jsx)(P,{entityId:Number(null==y?void 0:y.entityId),entityName:null==y?void 0:y.entityName}),submit:!1,title:"Log Details",width:"50%"})};return(0,I.jsxs)(T,{children:[(0,I.jsx)(l.Z,{children:(0,I.jsxs)(d.Z,{children:[(0,I.jsx)(c.Z,{md:3,children:(0,I.jsx)(s.Z,{action:t?"Edit":null,actionClick:S,content:(null==i?void 0:i.name)||"test",context:"primary",gmail:null==i?void 0:i.email,src:_})}),(0,I.jsxs)(c.Z,{md:9,children:[(0,I.jsx)(D,{content:(0,I.jsx)(k,{}),noMargin:!0}),(null==i?void 0:i.description)&&(0,I.jsx)(z,{content:null==i?void 0:i.description,noMargin:!0}),(null==i?void 0:i.website)&&(0,I.jsxs)(M,{href:null==i?void 0:i.website,rel:"nofollow noopener noreferrer",target:"_blank",children:[(0,I.jsx)(F,{context:"primary",icon:"window-maximize"}),"Visit website"]})]}),v&&(0,I.jsx)(c.Z,{md:12,children:(0,I.jsx)(A,{job:v,numberPrefix:h,numberSuffix:j})})]})}),(0,I.jsx)(u.Z,{marginTop:"sm"}),x&&(0,I.jsxs)(R,{children:[x.map(function(e){var n=e.icon,t=e.onClick,i=e.to;return(0,I.jsxs)("div",{children:[t&&(0,I.jsx)(O,{onClick:t,children:(0,I.jsx)(m.Z,{icon:n,prefix:g})}),i&&(0,I.jsx)(f.Z,{border:!1,passHref:!0,to:i,children:(0,I.jsx)(m.Z,{icon:n,prefix:g})})]},n)}),y&&(0,I.jsx)(O,{onClick:q,children:(0,I.jsx)(m.Z,{icon:"history",size:"lg"})})]})]})},T=r.ZP.div.withConfig({displayName:"profileHeader__StyledHeader",componentId:"sc-ssc7qm-0"})(["background-color:#fff;border:1px solid #eee;box-shadow:rgba(45,62,80,0.12) 0 1px 5px 0;margin-bottom:0.5rem;padding:1rem 0;"]),D=(0,r.ZP)(x.Z).withConfig({displayName:"profileHeader__StyledHeading",componentId:"sc-ssc7qm-1"})(["font-size:1rem;margin-top:0.5rem;"]),z=(0,r.ZP)(x.Z).withConfig({displayName:"profileHeader__StyledDescription",componentId:"sc-ssc7qm-2"})(["font-size:0.9rem;margin-top:0.5rem;"]),M=r.ZP.a.withConfig({displayName:"profileHeader__StyledLink",componentId:"sc-ssc7qm-3"})(["margin-bottom:1rem;"]),F=(0,r.ZP)(v.Z).withConfig({displayName:"profileHeader__StyledIcon",componentId:"sc-ssc7qm-4"})(["margin-right:0.5rem;"]),$=(0,r.ZP)(f.Z).withConfig({displayName:"profileHeader__StyledTitle",componentId:"sc-ssc7qm-5"})(["display:inline;"]),R=r.ZP.div.withConfig({displayName:"profileHeader__StyledIconContainer",componentId:"sc-ssc7qm-6"})(["display:flex;justify-content:center;"]),O=r.ZP.div.withConfig({displayName:"profileHeader__Click",componentId:"sc-ssc7qm-7"})(["cursor:pointer;"]);E.defaultProps={avatar:"",editable:!0,numberPrefix:"",numberSuffix:""}},93673:function(e,n,t){"use strict";t.d(n,{x:function(){return i}});var i=[{text:"Reactive",value:"reactive",context:"#2EE6CA"},{text:"Planned Maintenance",value:"ppm",context:"#D67EFF"},{text:"Quote",value:"quote",context:"#7D7"},{text:"Compliance",value:"cppm",context:"#CC7429"}]},86559:function(e,n,t){"use strict";t.d(n,{Y:function(){return i}});var i=[{text:"Select...",value:""},{text:"Call",value:"call"},{text:"Email",value:"email"},{text:"Portal",value:"portal"},{text:"Other",value:"other"}]},49992:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return h}});var i,a=t(19076),r=t(11163),o=t(6812),l=t(71383),d=(0,t(75063).Ps)(i||(i=(0,l.Z)(["\n  query GetAdmin($id: Int!) {\n    admin: Account_by_pk(id: $id) {\n      id\n      name\n      type\n      media: Media {\n        id\n        medium: Medium {\n          id\n          category\n          filename\n          meta\n          type\n        }\n      }\n    }\n  }\n"]))),c=t(9270),s=t(62140),u=t(62929),m=t(53344),f=t(46165),x=t(72936),v=t(39259),p=t(85893),y=function(){var e=(0,r.useRouter)().query,n=(0,x.x)(),t=n.hasRole,i=n.user,a=null;t("superadmin")&&e.id?a=parseInt(e.id):t(["admin","superadmin"])&&i.accountId&&(a=i.accountId);var l=(0,o.a)(d,{skip:!a,variables:{id:a}}),y=l.loading,h=l.data,j=(h=void 0===h?{admin:{}}:h).admin;return y||!a?null:(0,p.jsx)(c.Z,{children:(0,p.jsxs)(s.Z,{md:12,children:[(0,p.jsx)(c.Z,{children:(0,p.jsx)(s.Z,{md:4,children:(0,p.jsx)(f.g,{avatar:(0,m.Q)(j.media),entity:j,entityName:"Account",icons:t(["admin","superadmin"])?(0,u.Y)(j):[]})})}),(0,p.jsx)(v.P,{accountType:"admin",filters:{accountId:a}})]})})},h=function(){return(0,p.jsx)(a.Z,{View:(0,p.jsx)(y,{})})}},51332:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/admins/view",function(){return t(49992)}])}},function(e){e.O(0,[3662,367,2283,212,8890,619,1100,1336,4135,5020,6043,1564,4244,5370,3911,3776,6540,2329,778,4046,1023,3148,2797,653,1207,6212,7725,9229,8403,9774,2888,179],function(){return e(e.s=51332)}),_N_E=e.O()}]);