(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8978],{16551:function(e,t,n){"use strict";var r,i,o=n(51174),a=n(67294),c=n(45697),u=n(10367),s=function(e){var t=e.align,n=e.children;return a.createElement(l,{align:t,"aria-label":"Toolbar with button groups",role:"toolbar"},a.createElement(d,{role:"group","aria-label":"First group"},n))};s.displayName="ButtonToolbar";var l=u.ZP.div(r||(r=(0,o.Z)(["\n  display: flex;\n  flex-wrap: wrap;\n  justify-content: ",";\n"])),function(e){return e.align}),d=u.ZP.div(i||(i=(0,o.Z)(["\n  display: inline-flex;\n  position: relative;\n  vertical-align: middle;\n\n  a:hover {\n    color: white;\n  }\n\n  &:last-child > div:last-of-type button {\n    border-top-right-radius: 0.25rem;\n    border-bottom-right-radius: 0.25rem;\n    border-right: 0;\n  }\n\n  a:not(:last-child),\n  button:not(:last-child) {\n    border-bottom-right-radius: 0;\n    border-right: 1px solid ",";\n    border-top-right-radius: 0;\n  }\n\n  a:not(:first-child),\n  button:not(:first-child),\n  a:not(:first-child) button,\n  div:not(:first-child) button {\n    border-top-left-radius: 0;\n    border-bottom-left-radius: 0;\n    margin-left: 0;\n  }\n\n  a:not(:last-child) button,\n  div:not(:last-child) button {\n    border-bottom-right-radius: 0;\n    border-right: 1px solid ",";\n    border-top-right-radius: 0;\n  }\n"])),function(e){return e.theme.COLOUR.light},function(e){return e.theme.COLOUR.light});s.propTypes={align:c.string,children:c.node.isRequired},s.defaultProps={align:"center"},t.Z=s},55563:function(e,t,n){"use strict";var r=n(18391),i=n(76702),o=n(66080),a=n(67294),c=n(45697),u=n(64522),s=n(66349),l=n(55334),d=["disabled","errors","helperMessage","name","placeholder","readOnly","regExp","register","size","validate","withAddon"],p=function(e){var t=e.disabled,n=e.errors,c=e.helperMessage,s=e.name,p=e.placeholder,f=e.readOnly,m=(e.regExp,e.register),b=e.size,g=(e.validate,e.withAddon),y=(0,o.Z)(e,d),h=(0,a.useState)(!1),v=(0,i.Z)(h,2),Z=v[0],j=v[1];return a.createElement(u.Z,(0,r.Z)({"aria-label":s,component:l.Z,disabled:t,helperMessage:c,onKeyDown:function(e){j(!0)},onBlur:function(){j(!1)},errors:n[s],isTyping:Z,key:s,name:s,placeholder:p,readOnly:f,register:m,size:b,withAddon:g},y))};p.displayName="FormField",p.propTypes={accept:c.string,autoComplete:(0,c.oneOfType)([c.bool,c.string]),autoFocus:c.bool,disabled:c.bool,errors:c.object.isRequired,helperMessage:c.string,label:c.string,name:c.string.isRequired,placeholder:c.string,readOnly:c.bool,register:c.func.isRequired,size:(0,c.oneOf)([s.Z.SM,s.Z.MD,s.Z.LG]),style:c.object,textAlign:c.string,type:c.string,value:(0,c.oneOfType)([c.string,c.number,c.bool,(0,c.arrayOf)((0,c.oneOfType)([c.string,c.number,c.bool]))])},p.defaultProps={autoComplete:"off",autoFocus:!1,disabled:!1,errors:{},readOnly:!1,type:"text"},t.Z=p},55334:function(e,t,n){"use strict";var r,i,o,a,c,u,s=n(51174),l=n(10367),d=n(6269),p=n(92415),f=n(66349),m=l.ZP.input.attrs(function(e){return{autoComplete:"off",autoFocus:!1}})(r||(r=(0,s.Z)(["\n  ","\n\n  ","\n\n    ","\n"])),function(e){return(0,d.Z)(e)},function(e){return e.errors&&(0,l.iv)(i||(i=(0,s.Z)(["\n      ","\n    "])),function(e){return(0,p.Z)(e)})},function(e){var t=e.size;switch(t){case f.Z.SM:return(0,l.iv)(o||(o=(0,s.Z)(["\n          height: 1.5rem;\n        "])));case f.Z.MD:return(0,l.iv)(a||(a=(0,s.Z)(["\n          height: 1.875rem;\n        "])));case f.Z.LG:return(0,l.iv)(c||(c=(0,s.Z)(["\n          height: 2.25rem;\n        "])));default:return(0,l.iv)(u||(u=(0,s.Z)(["\n          height: 2.25rem;\n        "])))}});t.Z=m},76600:function(e,t,n){"use strict";var r,i=n(51174),o=n(67294),a=n(45697),c=n(10367),u=function(e){var t=e.children,n=e.className,r=e.handleSubmit,i=e.id,a=e.style;return o.createElement(s,{className:n,id:i,onSubmit:r,style:a},t)};u.displayName="Form";var s=c.ZP.form(r||(r=(0,i.Z)(["\n  margin-bottom: 1rem;\n"])));u.propTypes={children:a.node.isRequired,className:a.any,handleSubmit:a.func.isRequired,id:a.string,style:a.any},t.Z=u},26186:function(e,t,n){"use strict";var r=n(34613),i=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=new Date(e),i=n.getFullYear(),o=""+(n.getMonth()+1),a=""+n.getDate();o.length<2&&(o="0"+o),a.length<2&&(a="0"+a);var c=[i,o,a].join("-");return t?c+" "+(0,r.Z)(e):c};t.Z=i},34613:function(e,t){"use strict";var n=function(e){var t=new Date(e),n=""+t.getHours(),r=""+t.getMinutes();return n.length<2&&(n="0"+n),r.length<2&&(r="0"+r),"".concat(n,":").concat(r)};t.Z=n},54224:function(e,t,n){"use strict";n.d(t,{z:function(){return _}});var r=n(59499),i=n(50029),o=n(16835),a=n(64687),c=n.n(a),u=n(50319),s=n(7221),l=n(42283),d=n(79665),p=n(76600),f=n(49501),m=n(55563),b=n(6710),g=n(58594),y=n(95103),h=n(72936),v=n(26380),Z=n(27940),j=n(74231),O=(0,j.Ry)().shape({name:(0,j.Z_)().required(),status:(0,j.Z_)().oneOf(["active","inactive"]).required(),complianceCategorySelected:(0,j.Ry)().required(),url:(0,j.Z_)().url()}),x=function(e){var t=e.form,n=e.id,r=e.user;return(t.categoryId=t.complianceCategorySelected.value,delete t.complianceCategorySelected,n)?{id:n,changes:t}:(t.adminId=r.accountId,{objects:[t]})},C=n(85893);function w(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function P(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?w(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):w(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var _=function(e){var t,n=e.defaultValues,r=e.onSuccess,a=(0,h.x)().user,j=(0,l.cI)({defaultValues:n,resolver:(0,d.S)(O)}),w=j.control,_=j.errors,S=j.handleSubmit,E=j.register,D=(0,u.D)(s.gO,{onCompleted:function(e){var t=e.insert_Compliance.returning[0].id;r&&r(t)}}),$=(0,o.Z)(D,1)[0],k=(0,u.D)(s.Vd,{onCompleted:function(e){var t=e.update_Compliance_by_pk.id;r&&r(t)}}),q=(0,o.Z)(k,1)[0],A=(t=(0,i.Z)(c().mark(function e(t){var r;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=x({form:t,id:n.id,user:a}),!n.id){e.next=6;break}return e.next=4,q({variables:r});case 4:e.next=8;break;case 6:return e.next=8,$({variables:r});case 8:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),N={control:w,errors:_,register:E};return(0,C.jsxs)(p.Z,{id:"offCanvasForm",handleSubmit:S(A),children:[(0,C.jsx)(f.Z,{label:"Name",children:(0,C.jsx)(m.Z,P(P({},N),{},{name:"name"}))}),(0,C.jsx)(Z.l,P(P({},N),{},{label:"Category",name:"complianceCategorySelected",type:"complianceCategory"})),(0,C.jsx)(f.Z,{label:"Description",children:(0,C.jsx)(b.Z,P(P({},N),{},{name:"description",rows:2}))}),(0,C.jsx)(f.Z,{label:"Governing Body",children:(0,C.jsx)(m.Z,P(P({},N),{},{name:"governingBody"}))}),(0,C.jsx)(f.Z,{label:"Registration number example",children:(0,C.jsx)(m.Z,P(P({},N),{},{name:"regNumExample"}))}),(0,C.jsx)(f.Z,{label:"URL",children:(0,C.jsx)(m.Z,P(P({},N),{},{name:"url"}))}),(0,C.jsx)(g.Z,P(P({},N),{},{data:[{id:"hasInsuranceAmount",label:"Has Insurance Amount Attached"}],name:"hasInsuranceAmount"})),(0,C.jsx)(g.Z,P(P({},N),{},{data:[{id:"expectCertificate",label:"Expect Certificate"}],name:"expectCertificate"})),(0,C.jsx)(f.Z,{label:"Status",children:(0,C.jsx)(y.Z,P(P({},N),{},{name:"status",options:v.bg}))})]})}},7221:function(e,t,n){"use strict";n.d(t,{$i:function(){return s},G1:function(){return l},Vd:function(){return p},gO:function(){return d}});var r,i,o,a,c=n(71383),u=n(75063),s=(0,u.Ps)(r||(r=(0,c.Z)(["\n  query GetCompliace($id: Int!) {\n    compliance: Compliance_by_pk(id: $id) {\n      id\n      name\n      url\n      regNumExample\n      status\n      type\n      governingBody\n      hasInsuranceAmount\n      description\n      createdAt\n      media: Media {\n        id\n        medium: Medium {\n          id\n          category\n          filename\n          meta\n          type\n        }\n      }\n      Compliance_Entities {\n        Location {\n          id\n          name\n          status\n        }\n        Account {\n          id\n          name\n          type\n        }\n      }\n    }\n  }\n"]))),l=(0,u.Ps)(i||(i=(0,c.Z)(['\n  query GetCompliances(\n    $limit: Int\n    $offset: Int\n    $q: String\n    $orderBy: Compliance_order_by!\n    $status: String\n    $type: String\n  ) {\n    compliance: Compliance(\n      limit: $limit\n      offset: $offset\n      where: { name: { _ilike: $q }, status: { _eq: $status }, type: { _eq: $type } }\n      order_by: [$orderBy]\n    ) {\n      id\n      name\n      description\n      status\n      regNumExample\n      hasInsuranceAmount\n      expectCertificate\n      url\n      governingBody\n      createdAt\n      category: Category {\n        id\n        name\n      }\n      questions: Taxonomies {\n        id\n      }\n      media: Media(where: { entity: { _eq: "Compliance" } }) {\n        mediaId\n      }\n    }\n    meta: Compliance_aggregate(\n      where: { name: { _ilike: $q }, status: { _eq: $status }, type: { _eq: $type } }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n']))),d=(0,u.Ps)(o||(o=(0,c.Z)(["\n  mutation AddCompliance($objects: [Compliance_insert_input!]!) {\n    insert_Compliance(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]))),p=(0,u.Ps)(a||(a=(0,c.Z)(["\n  mutation UpdateCompliance($id: Int!, $changes: Compliance_set_input) {\n    update_Compliance_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"])))},43134:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return M}});var r=n(19076),i=n(12964),o=n(59499),a=n(67294),c=n(11163),u=n.n(c),s=n(6812),l=n(7221),d=n(78289),p=n(68956),f=n(26186),m=n(74297),b=n(16551),g=n(77439),y=n(58965),h=n(67872),v=n(54224),Z=n(2034),j=n(42846),O=n(72936),x=n(85893);function C(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var w={item:"name",order:"asc"},P=function(e){var t=e.filters,n=(0,j.x)({filters:t,initialSort:w}),r=n.initialData,i=n.ref,c=(0,(0,O.x)().hasRole)("customer"),P=(0,a.useContext)(d.Z),_=(0,s.a)(l.G1,{variables:r}),S=_.data,E=(S=void 0===S?{compliance:[],meta:{aggregate:{totalCount:0}}}:S).compliance,D=S.meta,$=_.loading,k=_.refetch,q=function(){k(),P.close()},A=function(e,t){e.stopPropagation();var n={};t?(n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?C(Object(n),!0).forEach(function(t){(0,o.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):C(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t.item)).complianceCategorySelected={label:t.item.category.name,value:t.item.category.id}:n.status="active",P.show({content:(0,x.jsx)(v.z,{defaultValues:n,onSuccess:q}),title:n.id?"Edit":"Add Compliance"})},N=function(e,t){P.show({content:(0,x.jsx)(Z.R,{defaultValues:t,entity:"Compliance",entityId:t.id,groups:{},parentId:t.id,refetchCompliance:k,type:"complianceQuestions"}),submit:!1,title:"Questions"}),e.stopPropagation()},I=[{hidden:!0},{sortable:!0,sortName:"name",text:"Name"},{text:"Category"},{hidden:!0},{text:"Date"},{text:"Status"},{hidden:!0},{hidden:!0},{hidden:!0},{formatter:p.Z,formatterData:[{context:"secondary",icon:["fas","edit"],onClick:function(e,t){return A(e,t)},tooltip:"Edit"},{context:"info",icon:["fas","question"],numberOverlay:"childCount",onClick:function(e,t){return N(e,t)},tooltip:"Manage Questions"}],text:"Actions"}],T=function(e){u().push("".concat("/dashboard/compliance/","view?id=").concat(e.id))},M=function(){return(0,x.jsx)(b.Z,{children:(0,x.jsx)(g.Z,{context:"secondary",content:"Add New",onClick:A,size:"sm"})})};return(0,x.jsx)(y.Z,{open:!0,title:"Compliance",toolbar:!c&&(0,x.jsx)(M,{}),children:(0,x.jsx)(h.t,{columns:I,initialSort:w,loading:$,meta:D,ref:i,refetch:k,rowClick:T,rows:E.map(function(e){var t,n;return{id:e.id,name:e.name,categoryName:e.category.name,description:e.description,date:(0,f.Z)(e.createdAt),status:(0,m.Z)(e.status),mediaCount:(null===(t=e.media)||void 0===t?void 0:t.length)||null,childCount:(null===(n=e.questions)||void 0===n?void 0:n.length)||null,item:e,actions:""}})})})},_=n(9270),S=n(62140),E=n(95103),D=n(75420),$=[{text:"Type",value:""},{text:"Regulatory",value:"regulatory"},{text:"SSIP",value:"ssip"}],k=n(26380);function q(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function A(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?q(Object(n),!0).forEach(function(t){(0,o.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):q(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var N=function(e){var t=e.errors,n=e.register,r=e.setFilters,i={errors:t,register:n};return(0,x.jsxs)(_.Z,{children:[(0,x.jsx)(S.Z,{md:6,children:(0,x.jsx)(E.Z,A(A({},i),{},{name:"type",onChange:function(e){return r(function(t){return A(A({},t),{},{type:e.target.value||null})})},options:$}))}),(0,x.jsx)(S.Z,{md:6,children:(0,x.jsx)(D.r,A(A({},i),{},{onChange:function(e){return r(function(t){return A(A({},t),{},{status:e.target.value||null})})},options:k.bg}))})]})},I={q:null,status:null,type:null,filterType:"compliance_table"},T=function(){return(0,x.jsx)(i.J,{FiltersComp:N,initialFilters:I,TableComp:P})},M=function(){return(0,x.jsx)(r.Z,{pageHeading:{heading:"Compliance"},View:(0,x.jsx)(T,{})})}},51738:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/compliance",function(){return n(43134)}])},30907:function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,{Z:function(){return r}})},15671:function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}n.d(t,{Z:function(){return r}})},43144:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(83997);function i(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,(0,r.Z)(i.key),i)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}},4942:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(83997);function i(e,t,n){return(t=(0,r.Z)(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},60136:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(89611);function i(e,t){if("function"!=typeof t&&null!==t)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&(0,r.Z)(e,t)}},82963:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(71002),i=n(97326);function o(e,t){if(t&&("object"===(0,r.Z)(t)||"function"==typeof t))return t;if(void 0!==t)throw TypeError("Derived constructors may only return object or undefined");return(0,i.Z)(e)}},83997:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(71002);function i(e){var t=function(e,t){if("object"!=(0,r.Z)(e)||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=(0,r.Z)(i))return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==(0,r.Z)(t)?t:t+""}},71002:function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}n.d(t,{Z:function(){return r}})},40181:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(30907);function i(e,t){if(e){if("string"==typeof e)return(0,r.Z)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return(0,r.Z)(e,t)}}},4730:function(e,t,n){"use strict";function r(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],!(t.indexOf(n)>=0)&&Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}n.d(t,{Z:function(){return r}})}},function(e){e.O(0,[3662,2283,212,619,1336,1564,5370,6540,9241,14,5175,9774,2888,179],function(){return e(e.s=51738)}),_N_E=e.O()}]);