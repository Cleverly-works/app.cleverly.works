(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6305],{18574:function(e,n,t){"use strict";t.d(n,{F:function(){return w}});var r=t(59499),i=t(10166),o=t(50135),a=t(98456),s=t(16143),c=t(80482),u=t(23776),l=t(27812),d=t(4730),m=t(74061),p=t(6498),f=t(61730),y=t(75438),g=t(15861),h=t(67294),b=t(85893),v=["children"];function _(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function $(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?_(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):_(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var x=(0,h.createContext)({}),q=(0,h.forwardRef)(function(e,n){var t=(0,h.useContext)(x);return(0,b.jsx)("div",$($({ref:n},e),t))}),j=(0,h.forwardRef)(function(e,n){var t=e.children,r=(0,d.Z)(e,v),i=[];t.forEach(function(e){i.push(e),i.push.apply(i,(0,l.Z)(e.children||[]))});var o,a,s=(0,p.u)(),c=(0,f.Z)(s.breakpoints.up("sm"),{noSsr:!0}),u=i.length,y=c?36:48,g=function(e){return e.hasOwnProperty("group")?48:y},_=(a=(0,h.useRef)(null),(0,h.useEffect)(function(){null!=a.current&&a.current.resetAfterIndex(0,!0)},[u]),a);return(0,b.jsx)("div",{ref:n,children:(0,b.jsx)(x.Provider,{value:r,children:(0,b.jsx)(m.S_,{itemData:i,height:(u>8?8*y:i.map(g).reduce(function(e,n){return e+n},0))+16,width:"100%",ref:_,outerElementType:q,innerElementType:"ul",itemSize:function(e){return g(i[e])},overscanCount:5,itemCount:u,children:I})})})});function I(e){var n=e.data,t=e.index,r=e.style,i=n[t],o=$($({},r),{},{top:r.top+8});return i.hasOwnProperty("group")?(0,b.jsx)(y.Z,{component:"div",style:o,children:i.group},i.key):(0,b.jsx)(g.Z,$($({component:"li"},i[0]),{},{noWrap:!0,style:o,children:i[1].label}))}function O(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function P(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?O(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):O(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var w=function(e){var n=e.label,t=e.loading,r=e.placeholder,i=e.error,s=e.helperText,c=e.inputProps;return(0,b.jsx)(Z,P(P({},e),{},{disableListWrap:!0,PopperComponent:S,ListboxComponent:j,renderInput:function(e){return(0,b.jsx)(o.Z,P(P(P({},e),c),{},{error:i,helperText:s,label:n,placeholder:r,color:"secondary",variant:"standard",InputProps:P(P(P({},e.InputProps),(null==c?void 0:c.InputProps)||{}),{},{endAdornment:(0,b.jsxs)(b.Fragment,{children:[t?(0,b.jsx)(a.Z,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})})}))},renderOption:function(e,n,t){return[e,n,t.index]},renderGroup:function(e){return e}}))};w.defaultProps={value:null,onChange:function(){},label:"",loading:!1,error:!1,onOpen:function(){},options:[],inputProps:{},withoutSelectIcon:!1};var S=(0,i.Z)(s.Z)((0,r.Z)({zIndex:"12000 !important"},"& .".concat(c.Z.listbox),{boxSizing:"border-box","& ul":{padding:0,margin:0}})),Z=(0,i.Z)(u.Z)(function(e){return{"& .MuiAutocomplete-root":{cursor:"pointer"},"& .MuiAutocomplete-popper":{zIndex:"12000 "},"& .MuiAutocomplete-endAdornment":{"& .MuiButtonBase-root.MuiIconButton-root.MuiAutocomplete-popupIndicator":{"& .MuiSvgIcon-root":P({},e.withoutSelectIcon&&{display:"none"})}}}})},6911:function(e,n,t){"use strict";t.d(n,{q:function(){return f}});var r=t(59499),i=t(4730),o=t(23776),a=t(87918),s=t(50135),c=t(98456),u=t(67294),l=t(85893),d=["loading","setSearch","textFieldProps"];function m(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function p(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?m(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):m(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var f=function(e){var n=e.loading,t=e.setSearch,r=e.textFieldProps,m=(0,i.Z)(e,d),f=(0,u.useState)(""),y=f[0],g=f[1];return(0,u.useEffect)(function(){var e=setTimeout(function(){t(y)},500);return function(){return clearTimeout(e)}},[y,t]),(0,l.jsx)(o.Z,p(p({},m),{},{loading:n,onInputChange:function(e,n){g(n)},getOptionLabel:function(e){return e.label},renderTags:function(e,n){return e.map(function(e,t){return(0,l.jsx)(a.Z,p({size:"small",label:e.label},n({index:t})))})},renderInput:function(e){return(0,l.jsx)(s.Z,p(p(p({},e),r),{},{InputProps:p(p(p({},e.InputProps),r.InputProps||{}),{},{endAdornment:(0,l.jsxs)(l.Fragment,{children:[n?(0,l.jsx)(c.Z,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})})}))}}))};f.defaultProps={color:"secondary",onChange:function(){},options:[],onOpen:function(){},setSearch:function(){},textFieldProps:{}}},9164:function(e,n,t){"use strict";t.d(n,{r:function(){return l}});var r=t(59499),i=t(41664),o=t.n(i),a=t(23795),s=t(85893);function c(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?c(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var l=function(e){var n=e.children,t=e.href,r=e.noWrap,i=e.target,c=e.sx,l=void 0===c?{}:c;return r?(0,s.jsx)(s.Fragment,{children:n}):t?(0,s.jsx)(o(),{href:t,target:i,passHref:!0,children:(0,s.jsx)(a.Z,u(u({sx:l},e),{},{children:n}))}):(0,s.jsx)(a.Z,u(u({sx:l},e),{},{children:n}))};l.defaultProps={onClick:function(e){e.stopPropagation()}}},76301:function(e,n,t){"use strict";t.d(n,{Ak:function(){return N},Cj:function(){return Q},K4:function(){return er},Qn:function(){return L},RJ:function(){return Y},SW:function(){return G},T_:function(){return H},UH:function(){return F},UM:function(){return en},Ve:function(){return V},_d:function(){return R},_f:function(){return et},by:function(){return B},cz:function(){return M},he:function(){return E},j$:function(){return U},kB:function(){return K},kU:function(){return X},kx:function(){return J},nD:function(){return D},nP:function(){return eo},pY:function(){return ei},qd:function(){return T},t1:function(){return z},yR:function(){return W},zR:function(){return ee}});var r,i,o,a,s,c,u,l,d,m,p,f,y,g,h,b,v,_,$,x,q,j,I,O,P,w,S,Z,C,k=t(71383),A=t(75063),M=(0,A.Ps)(r||(r=(0,k.Z)(["\n  query GetAddressForSelect($q: String, $entity: String!, $entityId: Int!) {\n    items: Address(\n      where: {\n        Address_Entities: { entity: { _eq: $entity }, entityId: { _eq: $entityId } }\n        _or: [\n          { addressLine1: { _eq: $q } }\n          { addressLine2: { _eq: $q } }\n          { addressLine3: { _eq: $q } }\n          { county: { _eq: $q } }\n          { postCode: { _eq: $q } }\n          { city: { _eq: $q } }\n        ]\n      }\n    ) {\n      label: addressLine1\n      value: id\n      id\n      name\n      addressLine1\n      addressLine2\n      addressLine3\n      postCode\n      county\n      country: Country {\n        name\n      }\n      city\n      Address_Entities {\n        invoice\n      }\n    }\n  }\n"]))),T=(0,A.Ps)(i||(i=(0,k.Z)(["\n  query GetAccountsForSelect($q: String, $type: String, $limit: Int, $offset: Int) {\n    items: Account(\n      where: { name: { _ilike: $q }, type: { _eq: $type } }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]))),D=(0,A.Ps)(o||(o=(0,k.Z)(['\n  query GetTaxonomy($q: String, $id: Int) {\n    items: Taxonomy(\n      where: { type: { _eq: "assetCategory" }, status: { _eq: "active" } }\n      order_by: { name: asc }\n    ) {\n      label: name\n      options: Taxonomies(\n        where: {\n          type: { _eq: "assetCategory" }\n          name: { _ilike: $q }\n          id: { _eq: $id }\n          status: { _eq: "active" }\n        }\n        order_by: { name: asc }\n      ) {\n        value: id\n        label: name\n      }\n    }\n  }\n']))),F=(0,A.Ps)(a||(a=(0,k.Z)(["\n  query GetAssetsForSelect($locationId: Int, $q: String, $categoryId: Int, $bookable: String) {\n    items: Asset(\n      where: {\n        categoryId: { _eq: $categoryId }\n        locationId: { _eq: $locationId }\n        name: { _ilike: $q }\n        bookable: { _eq: $bookable }\n      }\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n      parent: ParentAsset {\n        id\n        name\n      }\n      media: Media {\n        id\n        item: Medium {\n          id\n          name\n          filename\n          meta\n          category\n          type\n        }\n      }\n    }\n  }\n"]))),G=(0,A.Ps)(s||(s=(0,k.Z)(['\n  query GetCustomersForSelect($q: String, $limit: Int, $offset: Int) {\n    items: Account(\n      where: { name: { _ilike: $q }, type: { _eq: "customer" } }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      admin: Admins {\n        id: adminId\n      }\n      label: name\n      spendThreshold: meta(path: "$.finance.spendThreshold")\n      serviceRateLabour: meta(path: "$.finance.serviceRateLabour")\n      serviceRateExpenses: meta(path: "$.finance.serviceRateExpenses")\n      value: id\n    }\n  }\n']))),L=(0,A.Ps)(c||(c=(0,k.Z)(["\n  query GetJobsForSelect($_q: Int, $locationId: Int) {\n    items: Job(\n      where: {\n        Location: { id: { _eq: $locationId } }\n        _or: [{ id: { _eq: $_q } }, { Invoices: { id: { _eq: $_q } } }]\n      }\n      order_by: { title: asc }\n    ) {\n      label: label\n      value: id\n      number\n      createdAt\n      description\n      status\n      timingStart\n      title\n      type\n      Location {\n        name\n      }\n      Taxonomy {\n        Taxonomy {\n          shortJobDescription: name\n        }\n      }\n    }\n  }\n"]))),E=(0,A.Ps)(u||(u=(0,k.Z)(['\n  query GetManagersForSelect($userId: Int, $accountId: Int!, $q: String) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        Account_Users: {\n          role: { _in: ["owner", "manager"] }\n          status: { _eq: "active" }\n          Account: { id: { _eq: $accountId } }\n        }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n        id: { _neq: $userId }\n      }\n      order_by: { nameFirst: asc }\n    ) {\n      label: fullName\n      value: id\n    }\n  }\n']))),N=(0,A.Ps)(l||(l=(0,k.Z)(['\n  query GetManagersForSelect(\n    $userId: Int\n    $accountId: Int!\n    $q: String\n    $invoiceThreshold: numeric\n    $quoteThreshold: numeric\n  ) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        Account_Users: {\n          role: { _in: ["owner", "manager"] }\n          status: { _eq: "active" }\n          Account: { id: { _eq: $accountId } }\n        }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n        id: { _neq: $userId }\n        _and: [\n          {\n            _or: [\n              { invoiceThreshold: { _gt: $invoiceThreshold } }\n              { invoiceThreshold: { _is_null: true } }\n            ]\n          }\n          {\n            _or: [\n              { quoteThreshold: { _gt: $quoteThreshold } }\n              { quoteThreshold: { _is_null: true } }\n            ]\n          }\n        ]\n      }\n      order_by: { nameFirst: asc }\n    ) {\n      label: fullName\n      value: id\n    }\n  }\n']))),U=(0,A.Ps)(d||(d=(0,k.Z)(["\n  query GetPostCodeAreaForSelect($countryId: Int, $q: String) {\n    items: PostcodeArea(\n      where: { name: { _ilike: $q }, countryId: { _eq: $countryId } }\n      order_by: { name: asc }\n    ) {\n      area\n      label: name\n      value: id\n    }\n  }\n"]))),R=(0,A.Ps)(m||(m=(0,k.Z)(['\n  query GetPropertiesForSelect($where: Location_bool_exp, $limit: Int, $offset: Int) {\n    items: Location(where: $where, order_by: { name: asc }, limit: $limit, offset: $offset) {\n      label: name\n      value: id\n      access\n      permitsRequired\n      registeredAddress: Addresses(\n        where: { entity: { _eq: "Location" }, registered: { _eq: true } }\n      ) {\n        address: Address {\n          id\n          addressLine1\n          addressLine2\n          addressLine3\n          county\n          country: Country {\n            name\n          }\n          postCode\n          city\n        }\n      }\n    }\n  }\n']))),J=(0,A.Ps)(p||(p=(0,k.Z)(['\n  query GetServicesForSelect($q: String, $limit: Int, $offset: Int) {\n    items: Service(\n      where: { name: { _ilike: $q }, status: { _eq: "active" } }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n']))),z=(0,A.Ps)(f||(f=(0,k.Z)(["\n  query GetSlasForSelect($q: String, $adminId: Int, $type: String) {\n    items: SLA(\n      where: { name: { _ilike: $q }, type: { _eq: $type }, adminId: { _eq: $adminId } }\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]))),H=(0,A.Ps)(y||(y=(0,k.Z)(["\n  query GetSlasForSelectNew($where: SLA_bool_exp, $limit: Int, $offset: Int) {\n    items: SLA(where: $where, order_by: { name: asc }, limit: $limit, offset: $offset) {\n      label: name\n      value: id\n    }\n  }\n"]))),B=(0,A.Ps)(g||(g=(0,k.Z)(["\n  query GetSuppliersForSelect($where: Account_bool_exp, $limit: Int, $offset: Int) {\n    items: Account(where: $where, limit: $limit, offset: $offset, order_by: { name: asc }) {\n      label: name\n      value: id\n    }\n  }\n"]))),W=(0,A.Ps)(h||(h=(0,k.Z)(['\n  query GetUsersForSelect($accountId: Int, $q: String, $limit: Int, $offset: Int) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        Account_Users: {\n          accountId: { _eq: $accountId }\n          isContact: { _eq: true }\n          status: { _eq: "active" }\n        }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n      }\n      order_by: { nameFirst: asc }\n      limit: $limit\n      offset: $offset\n    ) {\n      label: fullName\n      value: id\n      email\n      phone\n    }\n  }\n']))),Y=(0,A.Ps)(b||(b=(0,k.Z)(['\n  query GetUsersForSelect($q: String) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n      }\n      order_by: { nameFirst: asc }\n    ) {\n      label: fullName\n      value: id\n      email\n      phone\n    }\n  }\n']))),Q=(0,A.Ps)(v||(v=(0,k.Z)(["\n  query GetTaxonomyGroupForSelect($q: String, $type: String!) {\n    items: Taxonomy(\n      where: { isGroup: { _eq: true }, name: { _ilike: $q }, type: { _eq: $type } }\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]))),V=(0,A.Ps)(_||(_=(0,k.Z)(['\n  query GetTaxonomy($q: String) {\n    items: Taxonomy(where: { type: { _eq: "expenseCategoryGroup" } }, order_by: { name: asc }) {\n      label: name\n      options: Taxonomies(\n        where: { type: { _eq: "expenseCategory" }, name: { _ilike: $q } }\n        order_by: { name: asc }\n      ) {\n        value: id\n        label: name\n      }\n    }\n  }\n']))),X=(0,A.Ps)($||($=(0,k.Z)(['\n  query GetCompliancesForSelect($q: String, $locationId: Int) {\n    items: Taxonomy(where: { type: { _eq: "complianceCategory" } }, order_by: { name: asc }) {\n      label: name\n      options: Compliances(\n        where: {\n          name: { _ilike: $q }\n          Compliance_Entities: { Location: { id: { _eq: $locationId } } }\n        }\n        order_by: { name: asc }\n      ) {\n        value: id\n        label: name\n      }\n    }\n  }\n']))),K=(0,A.Ps)(x||(x=(0,k.Z)(["\n  query GetUserRole($userId: Int!, $accountId: Int!) {\n    accountUsers: Account_User(\n      where: { userId: { _eq: $userId }, accountId: { _eq: $accountId } }\n    ) {\n      role\n    }\n  }\n"]))),ee=(0,A.Ps)(q||(q=(0,k.Z)(["\n  query GetSublocationsForSelect($locationId: Int!, $q: String, $limit: Int, $offset: Int) {\n    items: Sublocation(\n      where: { name: { _ilike: $q }, locationId: { _eq: $locationId }, active: { _eq: true } }\n      limit: $limit\n      offset: $offset\n      order_by: { createdAt: desc }\n    ) {\n      value: id\n      label: name\n    }\n  }\n"]))),en=(0,A.Ps)(j||(j=(0,k.Z)(['\n  query GetTaxonomy($q: String, $id: Int, $limit: Int, $offset: Int) {\n    items: Taxonomy(\n      where: {\n        id: { _eq: $id }\n        type: { _eq: "assetCategory" }\n        isGroup: { _eq: false }\n        status: { _eq: "active" }\n        name: { _ilike: $q }\n      }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n']))),et=(0,A.Ps)(I||(I=(0,k.Z)(["\n  query GetTaxonomyForSelect(\n    $where: Taxonomy_bool_exp\n    $limit: Int\n    $offset: Int\n    $orderBy: Taxonomy_order_by!\n  ) {\n    items: Taxonomy(where: $where, limit: $limit, offset: $offset, order_by: [$orderBy]) {\n      value: id\n      label: name\n    }\n  }\n"])));(0,A.Ps)(O||(O=(0,k.Z)(['\n  query GetTagsForTask($q: String!, $limit: Int = 50, $offset: Int = 0) {\n    items: Taxonomy(\n      where: { name: { _ilike: $q }, status: { _eq: "active" }, type: { _eq: "taskTags" } }\n      limit: $limit\n      offset: $offset\n      order_by: { id: desc }\n    ) {\n      value: id\n      label: name\n    }\n  }\n']))),(0,A.Ps)(P||(P=(0,k.Z)(['\n  query GetTagsForEntity(\n    $entityId: Int\n    $entity: String!\n    $q: String!\n    $limit: Int = 50\n    $offset: Int = 0\n  ) {\n    tags: Taxonomy(\n      where: {\n        name: { _ilike: $q }\n        status: { _eq: "active" }\n        type: { _eq: "taskTags" }\n        _not: { Taxonomy_Entities: { entity: { _eq: $entity }, entityId: { _eq: $entityId } } }\n      }\n      limit: $limit\n      offset: $offset\n      order_by: { id: desc }\n    ) {\n      id\n      name\n      meta\n    }\n  }\n']))),(0,A.Ps)(w||(w=(0,k.Z)(['\n  query GetEntityTags($entityId: Int!, $entity: String!) {\n    tags: Taxonomy_Entity(\n      where: {\n        entity: { _eq: $entity }\n        entityId: { _eq: $entityId }\n        Taxonomy: { status: { _eq: "active" }, type: { _eq: "taskTags" } }\n      }\n      order_by: { id: desc }\n    ) {\n      id\n      tag: Taxonomy {\n        id\n        name\n        meta\n      }\n    }\n  }\n'])));var er=(0,A.Ps)(S||(S=(0,k.Z)(["\n  query GetCustomerManagers($accountId: Int, $q: String, $limit: Int, $offset: Int) {\n    items: User(\n      where: { Account_Users: { accountId: { _eq: $accountId } }, fullName: { _ilike: $q } }\n      order_by: { fullName: asc }\n      limit: $limit\n      offset: $offset\n    ) {\n      label: fullName\n      value: id\n    }\n  }\n"]))),ei=(0,A.Ps)(Z||(Z=(0,k.Z)(["\n  query GetServiceSchedulesForSelect(\n    $q: String\n    $serviceId: Int\n    $entity: service_schedule_entity\n    $entityId: Int\n    $limit: Int = 50\n    $offset: Int = 0\n  ) {\n    items: ServiceSchedule(\n      where: {\n        name: { _ilike: $q }\n        serviceId: { _eq: $serviceId }\n        entity: { _eq: $entity }\n        entityId: { _eq: $entityId }\n      }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]))),eo=(0,A.Ps)(C||(C=(0,k.Z)(['\n  query GetPropertyById($id: Int!) {\n    item: Location_by_pk(id: $id) {\n      label: name\n      value: id\n      access\n      registeredAddress: Addresses(\n        where: { entity: { _eq: "Location" }, registered: { _eq: true } }\n      ) {\n        address: Address {\n          id\n          addressLine1\n          addressLine2\n          addressLine3\n          county\n          country: Country {\n            name\n          }\n          postCode\n          city\n        }\n      }\n    }\n  }\n'])))},32836:function(e,n,t){"use strict";t.d(n,{i:function(){return I}});var r=t(59499),i=t(67294),o=t(11163),a=t(83148),s=t(26447),c=t(15861),u=t(90948),l=t(5616),d=t(41796),m=t(87361),p=t(42096),f=t(87043),y=t(61730),g=t(58886),h=t(70872),b=t(85893);function v(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function _(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?v(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):v(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var $=function(e){var n=e.currentPage,t=e.totalCount,r=e.pageSize,i=e.onPageChange,o=(0,y.Z)("(max-width:400px)"),a=(0,y.Z)("(max-width:500px)");return(0,b.jsx)(x,{mb:2,page:n,count:Math.ceil(t/r),onChange:function(e,n){return i(n)},variant:"outlined",shape:"rounded",size:o?"small":"medium",hidePrevButton:1===n,hideNextButton:n===Math.ceil(t/r),siblingCount:a?0:1,renderItem:function(e){return(0,b.jsx)(g.Z,_({slots:{previous:function(){return"Previous"},next:function(){return"Next"}}},e))}})};$.defaultProps={currentPage:1,totalCount:0,pageSize:50,onPageChange:function(){}};var x=(0,u.ZP)(h.Z)(function(e){var n,t=e.hidePrevButton,i=e.hideNextButton,o=e.theme;return n={},(0,r.Z)(n,"&.MuiPagination-root",{alignSelf:"center",marginTop:"16px"}),(0,r.Z)(n,"& .MuiPaginationItem-root",{fontWeight:600,margin:0,borderRadius:0}),(0,r.Z)(n,"& .MuiPagination-ul > li:last-child .MuiPaginationItem-previousNext:last-child",{margin:0,borderRadius:"0 5px 5px 0"}),(0,r.Z)(n,"& .MuiPagination-ul > li:first-child .MuiPaginationItem-previousNext:last-child",{margin:0,borderRadius:"5px 0 0 5px"}),(0,r.Z)(n,"& button.Mui-selected",_(_({color:o.palette.white.main,backgroundColor:o.palette.secondary.main},i?{borderRadius:"0 5px 5px 0"}:{}),t?{borderRadius:"5px 0 0 5px"}:{})),n});function q(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function j(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?q(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):q(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var I=(0,i.forwardRef)(function(e,n){var t=e.columns,r=e.history,a=e.initialSort,u=e.meta,l=e.refetch,d=e.paginationSize,y=e.containerHeight,g=e.noResultsMessage,h=e.autoHeight,v=(0,o.useRouter)(),_=v.query,x=void 0===_?{}:_,q=(0,i.useState)(parseInt(null==x?void 0:x.page,10)||1),I=q[0],w=q[1],S=(0,i.useState)(d||f.C1.paginationSize),Z=S[0],C=S[1];a||(a={item:"createdAt",order:"desc"});var k=(0,i.useState)({item:a.item,order:a.order}),A=k[0],M=k[1],T=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=v.query,t=void 0===n?{}:n;if(e>1?t.page=e:delete t.page,!(Object.keys(t).length>0))return{};var r=Object.keys(t).map(function(n){return"page"===n?"".concat(n,"=").concat(e):"".concat(n,"=").concat(t[n])}).join("&");return"?".concat(r)},D=function(){M({item:a.item,order:a.order}),w(1);var e=T();v.push(e),C(d||f.C1.paginationSize)};(0,i.useImperativeHandle)(n,function(){return{currentPage:I,pageSize:Z,sort:A,resetPagination:function(){D()}}});var F=function(e){var n=T(e);r&&v.push(n),w(e),!r&&l&&l()},G=function(e){e&&e.field&&e.sort?(M({item:t.find(function(n){return n.field===e.field}).sortName||e.field||e.item||a.item,order:e.sort||e.order||a.order}),l&&l()):(M({item:a.item,order:a.order}),l&&l())};return(0,b.jsxs)(O,{containerHeight:y,children:[(0,b.jsx)(P,j({hideFooter:!0,disableColumnMenu:!0,disableSelectionOnClick:!0,autoHeight:h,sortingMode:"server",onSortModelChange:function(e){return G(e[0])},columns:t,pageSize:Z,slots:{columnSortedAscendingIcon:function(){return(0,b.jsx)(m.Z,{})},columnSortedDescendingIcon:function(){return(0,b.jsx)(p.Z,{})},columnUnsortedIcon:function(){return(0,b.jsxs)(s.Z,{alignItems:"center",sx:{width:"33px"},children:[(0,b.jsx)(m.Z,{sx:{marginBottom:"-15px"}}),(0,b.jsx)(p.Z,{})]})},noResultsOverlay:function(){return(0,b.jsx)(s.Z,{height:"100%",alignItems:"center",justifyContent:"center",spacing:1,p:1,children:(0,b.jsx)(c.Z,{children:g})})},noRowsOverlay:function(){return(0,b.jsx)(s.Z,{height:"100%",alignItems:"center",justifyContent:"center",spacing:1,p:1,children:(0,b.jsx)(c.Z,{children:g})})}}},e)),u&&Math.ceil(u.aggregate.totalCount/Z)>1&&(0,b.jsx)($,{currentPage:I,totalCount:u.aggregate.totalCount,pageSize:Z,onPageChange:F})]})});I.defaultProps={columns:[],history:!1,loading:!1,rows:[],noResultsMessage:"There are no results.",autoHeight:!0};var O=(0,u.ZP)(l.Z)(function(e){return{height:e.containerHeight,display:"flex",flexDirection:"column"}}),P=(0,u.ZP)(a.s)(function(e){var n,t=e.theme,i=e.hideHeader,o=(e.rows,e.loading,e.rowHeight),a=e.isPdf;return n={"--DataGrid-overlayHeight":"40px"},(0,r.Z)(n,"&.MuiDataGrid-root",j({color:t.palette.black.main,border:"none"},a&&{"@media print":{display:"block"}})),(0,r.Z)(n,"& .MuiDataGrid-main",j({},a&&{"@media print":{overflow:"visible !important"}})),(0,r.Z)(n,"& .MuiDataGrid-columnHeaders",j(j({},i&&{display:"none"}),{},{"& .MuiDataGrid-iconButtonContainer":{visibility:"visible","& .MuiButtonBase-root.MuiIconButton-root":{backgroundColor:"inherit",color:t.palette.black.main,"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.1)"}}}})),(0,r.Z)(n,"& .MuiDataGrid-virtualScroller",j(j({},i&&{marginTop:"0 !important"}),a&&{"@media print":{overflow:"visible !important"}})),(0,r.Z)(n,"& .MuiDataGrid-iconSeparator",{opacity:0}),(0,r.Z)(n,"& .MuiDataGrid-columnHeaderTitle",{fontWeight:700}),(0,r.Z)(n,"& .MuiButtonBase-root.MuiDataGrid-columnHeaderTitle",{fontWeight:700}),(0,r.Z)(n,"& .MuiDataGrid-virtualScrollerContent",j({},a&&{height:"initial !important",minHeight:"initial !important"})),(0,r.Z)(n,"& .MuiDataGrid-virtualScrollerRenderZone",j({},a&&{position:"relative"})),(0,r.Z)(n,"& .MuiDataGrid-overlayWrapper",(0,r.Z)({},"& .MuiCircularProgress-root",{color:t.palette.secondary.main})),(0,r.Z)(n,"& .MuiDataGrid-row",j({},a&&{minHeight:"".concat(o,"cm !important"),maxHeight:"".concat(o,"cm !important")})),(0,r.Z)(n,"& .MuiDataGrid-row > .MuiDataGrid-cell",j({},a&&{minHeight:"".concat(o,"cm !important"),maxHeight:"".concat(o,"cm !important")})),(0,r.Z)(n,"& .MuiDataGrid-row.even",{backgroundColor:t.palette.muiLightGray.main,"&:hover, &.Mui-hovered":{backgroundColor:(0,d.Fq)(t.palette.muiLightGray.main,.3),"@media (hover: none)":{backgroundColor:"transparent"}},"&.Mui-selected":{backgroundColor:(0,d.Fq)(t.palette.muiLightGray.main,.3+t.palette.action.selectedOpacity),"&:hover, &.Mui-hovered":{backgroundColor:(0,d.Fq)(t.palette.muiLightGray.main,.3+t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(0,d.Fq)(t.palette.muiLightGray.main,.3+t.palette.action.selectedOpacity)}}}}),n})},42846:function(e,n,t){"use strict";t.d(n,{x:function(){return l}});var r=t(59499),i=t(67294),o=t(96486),a=t(87043),s=function(e){try{return JSON.parse(e)}catch(n){return!1}};function c(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?c(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var l=function(e){var n,t,c,l,d,m,p,f,y,g,h,b=e.filters,v=e.newFilters,_=e.initialSort,$=(0,i.useRef)(),x=(0,i.useState)({}),q=x[0],j=x[1],I=(0,i.useState)({}),O=I[0],P=I[1],w=_||{item:"createdAt",order:"desc"},S=(0,r.Z)({},(null===(n=$.current)||void 0===n?void 0:n.sort.item)||w.item,w.inneritem?(0,r.Z)({},w.inneritem,(null===(t=$.current)||void 0===t?void 0:t.sort.order)||w.order):(null===(c=$.current)||void 0===c?void 0:c.sort.order)||w.order);return(0,i.useEffect)(function(){var e=!(0,o.isEqual)(q,b),n=!(0,o.isEqual)(O,v);if(e&&(j(b),null==$||null===(r=$.current)||void 0===r||r.resetPagination()),n&&(P(v),null==$||null===(i=$.current)||void 0===i||i.resetPagination()),null!=$&&null!==(t=$.current)&&void 0!==t&&t.setSort&&!(e||n)){var t,r,i,a,s,c,u,l,d,m,p,f=null!==(a=$.current)&&void 0!==a&&null!==(s=a.sort)&&void 0!==s&&s.item&&null!==(c=$.current)&&void 0!==c&&null!==(u=c.sort)&&void 0!==u&&u.order?{item:null===(l=$.current)||void 0===l?void 0:null===(d=l.sort)||void 0===d?void 0:d.item,order:null===(m=$.current)||void 0===m?void 0:null===(p=m.sort)||void 0===p?void 0:p.order}:S;$.current.setSort(f)}},[b,v]),{initialData:u(u({},b),{},{newFilters:(null==v?void 0:v.length)>0?v:void 0,limit:(null===(l=$.current)||void 0===l?void 0:l.pageSize)==="Infinity"?null:parseInt(null===(d=$.current)||void 0===d?void 0:d.pageSize,10)||a.C1.paginationSize,offset:((null===(m=$.current)||void 0===m?void 0:m.currentPage)-1||0)*((null===(p=$.current)||void 0===p?void 0:p.pageSize)||a.C1.paginationSize),orderBy:s(null===(f=$.current)||void 0===f?void 0:null===(y=f.sort)||void 0===y?void 0:null===(g=y.item)||void 0===g?void 0:g.replace(/ORDER/i,null===(h=$.current)||void 0===h?void 0:h.sort.order))||S}),initialSort:_,ref:$}}},45110:function(e,n,t){"use strict";function r(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GBP";return new Intl.NumberFormat(["en-GB"],{currency:n,currencyDisplay:"symbol",style:"currency"}).format(e)}t.d(n,{T:function(){return r}})},3896:function(e,n,t){"use strict";t.d(n,{X:function(){return p}});var r,i,o=t(71383),a=t(16835),s=t(59499),c=t(67294),u=t(6812),l=t(50319),d=t(75063),m=t(55863);function p(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage",r=(0,m.q)().user,i=(0,c.useState)(function(){try{switch(t){case"network":return n;case"sessionStorage":return JSON.parse(window.sessionStorage.getItem(e))||n}}catch(r){return n}}),o=i[0],d=i[1],p=function(n){try{var i=n instanceof Function?n(o):n;switch(d(i),t){case"network":h({variables:{accountUserId:null==r?void 0:r.accountUserId,filters:(0,s.Z)({},e,i)}});break;case"sessionStorage":window.sessionStorage.setItem(e,JSON.stringify(i))}}catch(a){}};(0,u.a)(f,{variables:{accountUserId:null==r?void 0:r.accountUserId},skip:"network"!==t,onCompleted:function(t){var r=t.accountUser;r&&d(r.filters[e]||n)}});var g=(0,l.D)(y),h=(0,a.Z)(g,1)[0];return[o,p]}var f=(0,d.Ps)(r||(r=(0,o.Z)(["\n  query GetAccountUserFilters($accountUserId: Int!) {\n    accountUser: Account_User_by_pk(id: $accountUserId) {\n      filters\n    }\n  }\n"]))),y=(0,d.Ps)(i||(i=(0,o.Z)(["\n  mutation SetAccountUserFilters($accountUserId: Int!, $filters: jsonb) {\n    update_Account_User_by_pk(pk_columns: { id: $accountUserId }, _append: { filters: $filters }) {\n      id\n    }\n  }\n"])))},26380:function(e,n,t){"use strict";t.d(n,{bg:function(){return r}});var r=[{text:"Status",value:""},{text:"Active",value:"active"},{text:"Inactive",value:"inactive"}]},82377:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return Q}});var r,i=t(67294),o=t(11163),a=t.n(o),s=t(73987),c=t(38033),u=t(59499),l=t(30381),d=t.n(l),m=t(72936),p=t(42846),f=t(6812),y=t(45110),g=t(71383),h=(0,t(75063).Ps)(r||(r=(0,g.Z)(['\n  query GetScheduledJobs(\n    $accountId: Int\n    $customerManager: Int\n    $now: timestamptz\n    $limit: Int\n    $offset: Int\n    $q: String\n    $status: String\n  ) {\n    properties: Location(\n      limit: $limit\n      offset: $offset\n      where: {\n        Account_Locations: {\n          accountId: { _eq: $accountId }\n          Account: { type: { _eq: "customer" }, managerId: { _eq: $customerManager } }\n        }\n        status: { _eq: $status }\n        JobSchedules: {}\n        _or: [\n          { name: { _ilike: $q } }\n          {\n            Addresses: {\n              Address: { city: { _ilike: $q } }\n              entity: { _eq: "Location" }\n              registered: { _eq: true }\n            }\n          }\n          {\n            Addresses: {\n              Address: { postCode: { _ilike: $q } }\n              entity: { _eq: "Location" }\n              registered: { _eq: true }\n            }\n          }\n        ]\n      }\n    ) {\n      id\n      access\n      createdAt\n      name\n      contactUserId\n      addresses: Addresses(where: { entity: { _eq: "Location" } }) {\n        id\n        registered\n        operating\n        trading\n        invoice\n        status\n        address: Address {\n          id\n          name\n          addressLine1\n          addressLine2\n          addressLine3\n          city\n          county\n          geo\n          postCode\n          country: Country {\n            id\n            name\n          }\n        }\n      }\n      customer: Account_Locations {\n        id\n        account: Account {\n          id\n          name\n          manager: Manager {\n            id\n            fullName\n          }\n        }\n      }\n      compliances: Compliances(\n        where: { entity: { _eq: "Location" } }\n        order_by: { expiryAt: asc }\n      ) {\n        id\n        expiryAt\n        compliance: Compliance {\n          id\n          name\n        }\n      }\n      jobSchedules: JobSchedules {\n        id\n        meta\n        frequency\n        jobs: Jobs(where: { status: { _neq: "canceled" } }) {\n          id\n          title\n          status\n          amount\n          supplierLabourAmount\n          type\n          timingStart\n          timings: JobTimings {\n            id\n            status\n            createdAt\n          }\n          shortJobDesc: Taxonomy(where: { Taxonomy: { type: { _eq: "jobTags" } } }) {\n            id\n            taxonomyId\n            comments\n            taxonomy: Taxonomy {\n              name\n            }\n          }\n        }\n        amounts: Jobs_aggregate(where: { status: { _neq: "canceled" } }) {\n          aggregate {\n            sum {\n              customerAmount: amount\n              supplierAmount: supplierLabourAmount\n            }\n          }\n        }\n      }\n      bookings: Jobs {\n        id\n        amount\n      }\n    }\n    meta: Location_aggregate(\n      where: {\n        Account_Locations: {\n          accountId: { _eq: $accountId }\n          Account: { type: { _eq: "customer" }, managerId: { _eq: $customerManager } }\n        }\n        status: { _eq: $status }\n        JobSchedules: {}\n        _or: [\n          { name: { _ilike: $q } }\n          {\n            Addresses: {\n              Address: { city: { _ilike: $q } }\n              entity: { _eq: "Location" }\n              registered: { _eq: true }\n            }\n          }\n          {\n            Addresses: {\n              Address: { postCode: { _ilike: $q } }\n              entity: { _eq: "Location" }\n              registered: { _eq: true }\n            }\n          }\n        ]\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n']))),b=t(48126),v=t(73303),_=t.n(v),$=t(26447),x=t(15861),q=t(11057),j=t(90629),I=t(32836),O=t(8602),P=t(16835),w=t(86886),S=t(50135),Z=t(11994),C=t(73359),k=t(42283),A=t(10166),M=t(18574),T=t(3896),D=t(26380),F=t(76301),G=t(6911),L=t(85893);function E(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function N(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?E(Object(t),!0).forEach(function(n){(0,u.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):E(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var U=function(e){var n=e.open,t=e.setOpen,r=e.initialFilters,o=(e.filters,e.setFilters),a=(0,m.x)(),s=a.hasRole,c=a.user,u=(0,T.X)("form_data_".concat(r.filterType),r),l=(0,P.Z)(u,2),d=l[0],p=l[1],y=(0,k.cI)({defaultValues:d}),g=y.control,h=y.handleSubmit,b=y.register,v=y.reset,_=y.getValues,x=(0,i.useState)(""),j=x[0],I=x[1],O=(0,C.t)(F.SW),Z=(0,P.Z)(O,2),A=Z[0],E=Z[1],U=E.loading,z=E.data,H=(z=void 0===z?{items:[]}:z).items,B=(0,f.a)(F.K4,{skip:!n,variables:{accountId:c.accountId,limit:50,offset:0,q:""!==j?"%".concat(j,"%"):null}}),W=B.data,Y=(W=void 0===W?{items:[]}:W).items,Q=B.loading,V=function(e){try{var n,i,a,s={accountId:null===(n=e.accountId)||void 0===n?void 0:n.value,status:null===(i=e.status)||void 0===i?void 0:i.value,customerManager:null===(a=e.customerManager)||void 0===a?void 0:a.value},c=e.q;if(c){s.q="%".concat(c,"%")||0;var u=/^\d+$/.test(c);"id"in r&&(s.id=u?Number(c):null),"meta"in r&&(s.meta=u?{invoiceNumbers:[c]}:null),"jobNumber"in r&&(s.jobNumber=u?String(c):null,s.invoiceNumber=u?Number(c):null)}o(function(e){return N(N({},e),s)});var l=_();p(function(e){return N(N({},e),l)})}finally{t(!1)}},X=function(){o(r),v(r),t(!1)},K=D.bg.map(function(e){return{value:e.value,label:e.text}});return(0,L.jsx)(R,{keepMounted:!0,open:n,onClose:function(){return t(!1)},children:(0,L.jsx)("form",{onSubmit:h(V),children:(0,L.jsx)(J,{children:(0,L.jsxs)(w.ZP,{container:!0,rowGap:4,children:[(0,L.jsx)(w.ZP,{container:!0,children:(0,L.jsx)(w.ZP,{item:!0,xs:12,children:(0,L.jsx)(S.Z,{fullWidth:!0,variant:"standard",color:"secondary",label:"Search...",name:"q",inputRef:b})})}),(0,L.jsxs)(w.ZP,{container:!0,columnSpacing:4,rowGap:4,children:[(0,L.jsx)(w.ZP,{item:!0,xs:12,xs2:6,children:(0,L.jsx)(k.Qr,{name:"status",control:g,render:function(e){var n=e.value,t=e.onChange;return(0,L.jsx)(M.F,{value:n,onChange:function(e,n){return t(n)},label:"Select status",options:K})}})}),!s(["customer"])&&(0,L.jsx)(w.ZP,{item:!0,xs:12,xs2:6,children:(0,L.jsx)(k.Qr,{name:"accountId",control:g,render:function(e){var n=e.value,t=e.onChange;return(0,L.jsx)(M.F,{value:n,onChange:function(e,n){return t(n)},label:"Select customer",loading:U,onOpen:function(){return A()},options:H})}})}),s("admin")&&(0,L.jsx)(w.ZP,{item:!0,xs:12,xs2:6,children:(0,L.jsx)(k.Qr,{name:"customerManager",control:g,render:function(e){var n=e.value,t=e.onChange;return(0,L.jsx)(G.q,{value:n,onChange:function(e,n){return t(n)},loading:Q,options:Y,setSearch:I,textFieldProps:{color:"secondary",variant:"standard",label:"Select account manager"}})}})})]}),(0,L.jsx)(w.ZP,{container:!0,item:!0,xs:12,children:(0,L.jsxs)($.Z,{width:"100%",direction:"row",justifyContent:"flex-end",spacing:2,children:[(0,L.jsx)(q.Z,{variant:"contained",color:"danger",onClick:function(){return X()},children:"Cancel"}),(0,L.jsx)(q.Z,{variant:"contained",color:"secondary",type:"submit",children:"Search"})]})})]})})})})};U.defaultProps={open:!1,setOpen:function(){},initialFilters:{},filters:{},setFilters:function(){}};var R=(0,A.Z)(Z.Z)(function(){return{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"}}),J=(0,A.Z)(j.Z)(function(){return{padding:"24px",maxWidth:"700px",maxHeight:"100vh",overflowY:"scroll"}}),z=t(9164);function H(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}var B=function(e){var n=e.initialFilters,t=(0,m.x)().hasRole,r=t("customer"),o=t("tenant"),s=t("admin"),c=t(["admin","customer"]),l=(0,i.useState)(function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?H(Object(t),!0).forEach(function(n){(0,u.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):H(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({},n)),g=l[0],v=l[1],P=(0,i.useState)(!1),w=P[0],S=P[1],Z=(0,p.x)({filters:g}),C=Z.initialData,k=Z.ref,A=(0,f.a)(h,{variables:C}),M=A.data,T=(M=void 0===M?{properties:[],meta:{aggregate:{totalCount:0}}}:M).properties,D=M.meta,F=A.loading,G=A.refetch,E=function(e){var n=e.row;a().push("/dashboard/properties/view?id=".concat(n.locationId,"&tab=planned-maintenance"))};return(0,L.jsxs)($.Z,{width:"100%",spacing:2,sx:{height:"100%"},children:[(0,L.jsx)($.Z,{width:"100%",direction:"row",justifyContent:"space-between",children:(0,L.jsx)(q.Z,{variant:"contained",startIcon:(0,L.jsx)(O.Z,{}),onClick:function(){return S(!0)},children:"Filters"})}),(0,L.jsxs)(j.Z,{sx:{paddingTop:"16px",paddingBottom:"16px",height:"calc(100% - 52px)"},children:[(0,L.jsx)(x.Z,{ml:2,variant:"h5",sx:{fontWeight:600},children:"Planned Maintenance"}),(0,L.jsx)(U,{open:w,setOpen:S,initialFilters:n,filters:g,setFilters:v}),(0,L.jsx)(I.i,{autoHeight:!1,loading:F,ref:k,columns:[{minWidth:160,flex:1,sortable:!1,field:"location",headerName:"Property",renderCell:function(e){var n=e.row;return(0,L.jsx)(z.r,{color:"secondary",href:"/dashboard/properties/view?id=".concat(n.locationId,"&tab=details"),children:n.location})}},{minWidth:120,flex:1,sortable:!1,field:"nextJob",headerName:"Next Job",renderCell:function(e){var n,t,r,i,o,a,s=e.row,c=(null===(n=s.nextJob)||void 0===n?void 0:null===(t=n.shortJobDesc)||void 0===t?void 0:null===(r=t[0])||void 0===r?void 0:null===(i=r.taxonomy)||void 0===i?void 0:i.name)||(null===(o=s.nextJob)||void 0===o?void 0:o.title);return(0,L.jsx)($.Z,{children:c?(0,L.jsxs)(L.Fragment,{children:[(0,L.jsx)(x.Z,{children:c}),(0,L.jsx)(x.Z,{children:d()(null===(a=s.nextJob)||void 0===a?void 0:a.timingStart).format("YYYY-MM-DD")})]}):"N/A"})},hide:!c},{minWidth:160,flex:1,sortable:!1,field:"customer",headerName:"Customer",hide:r,renderCell:function(e){var n=e.row;return(0,L.jsx)(z.r,{noWrap:o,color:"secondary",href:"/dashboard/customers/view?id=".concat(n.customerId),children:n.customer})}},{minWidth:180,flex:1,field:"customerManager",headerName:"Account Manager",sortable:!1,renderCell:function(e){var n=e.row;return(0,L.jsx)(z.r,{noWrap:!n.customerManagerId,color:"secondary",href:"/dashboard/users/view?id=".concat(n.customerManagerId),children:n.customerManager})}},{flex:1,maxWidth:80,sortable:!1,field:"tasks",headerName:"Tasks"},{minWidth:160,flex:1,maxWidth:180,sortable:!1,field:"cost",headerName:"Cost",renderCell:function(e){var n=e.row;return(0,L.jsxs)($.Z,{children:[(0,L.jsxs)(x.Z,{children:["Customer ",(0,y.T)(n.costCustomer)]}),!r&&(0,L.jsxs)(x.Z,{children:["Supplier ",(0,y.T)(n.costSupplier)]})]})}}],rows:T.map(function(e){var n,t,r,i,o,a,s;return{id:e.id,locationId:e.id,location:e.name,customerId:e.customer[0].account.id,nextJob:null===(n=(0,b.BH)({scheduledJobs:e.jobSchedules}))||void 0===n?void 0:n.nextJob,customer:e.customer[0].account.name,customerManager:null===(t=e.customer[0].account)||void 0===t?void 0:null===(r=t.manager)||void 0===r?void 0:r.fullName,customerManagerId:null===(i=e.customer[0].account)||void 0===i?void 0:null===(o=i.manager)||void 0===o?void 0:o.id,tasks:e.jobSchedules.length,costCustomer:(a=e.jobSchedules,_()(a,"amounts.aggregate.sum.customerAmount")),costSupplier:(s=e.jobSchedules,_()(s,"amounts.aggregate.sum.supplierAmount"))}}),meta:D,refetch:G,onRowClick:E,containerHeight:"calc(100% - 32px)",columnVisibilityModel:{nextJob:c,customer:!r,customerManager:s}})]})]})},W={accountId:null,q:null,status:null,customerManager:null,filterType:"scheduled_job_table"},Y=function(){return(0,i.useContext)(s.Z).user?(0,L.jsx)(c.Z,{children:(0,L.jsx)(B,{initialFilters:W})}):(a().push("/account/sign-in"),null)};Y.getLayout=function(e){return e};var Q=Y},68430:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/scheduledjob",function(){return t(82377)}])}},function(e){e.O(0,[3662,9809,2283,212,8890,1100,4135,5020,6043,4244,3776,2329,778,1023,4253,3148,4061,6344,4990,6021,8033,8126,9774,2888,179],function(){return e(e.s=68430)}),_N_E=e.O()}]);