(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2744],{1950:function(e,t,n){"use strict";n.d(t,{V:function(){return k}});var r=n(59499),o=n(27812),a=n(26447),i=n(15861),l=n(21023),s=n(93946),u=n(72428),c=n(67294),d=n(9164),p=n(42283),v=n(79665),f=n(50135),m=n(11057),g=n(51797),x=n(46761),h=n(74231),b=h.Ry({name:h.Z_().required(),url:h.Z_().url().required()}),y=n(85893);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var O=function(e){var t=e.noEdit,n=e.noDelete,r=e.onDelete,o=e.id,i=e.isAdded,u=e.url,h=e.name,j=e.onSave,O=(0,c.useState)(i),T=O[0],C=O[1],k=(0,p.cI)({resolver:(0,v.S)(b)}),q=k.control,P=k.handleSubmit,Z=k.errors,S=function(e){e.stopPropagation(),C(!0)},I=function(e){e.stopPropagation(),C(!1),h&&u||r()},_=function(e){j(e),C(!1)};return(0,y.jsx)("form",{children:T?(0,y.jsxs)(a.Z,{children:[(0,y.jsxs)(a.Z,{spacing:1,children:[(0,y.jsx)(p.Qr,{control:q,name:"name",defaultValue:h,render:function(e){var t;return(0,y.jsx)(f.Z,w(w({fullWidth:!0,label:"Name",variant:"standard",color:"secondary"},e),{},{error:Z.name,helperText:null===(t=Z.name)||void 0===t?void 0:t.message}))}}),(0,y.jsx)(p.Qr,{control:q,name:"url",defaultValue:u,render:function(e){var t;return(0,y.jsx)(f.Z,w(w({fullWidth:!0,label:"Link",variant:"standard",color:"secondary"},e),{},{error:Z.url,helperText:null===(t=Z.url)||void 0===t?void 0:t.message}))}})]}),(0,y.jsxs)(a.Z,{direction:"row",justifyContent:"flex-end",spacing:1,mt:2,children:[(0,y.jsx)(m.Z,{variant:"contained",color:"danger",size:"small",onClick:I,children:"Cancel"}),(0,y.jsx)(m.Z,{variant:"contained",size:"small",onClick:P(_),children:"Save"})]})]}):(0,y.jsxs)(a.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,y.jsx)(d.r,{target:"_blank",variant:"body1",color:"secondary",href:u,sx:{textDecoration:"auto",fontWeight:700},children:h}),!t&&(0,y.jsx)(l.Z,{title:"Edit",placement:"top-start",children:(0,y.jsx)(s.Z,{size:"small",sx:{":hover":{backgroundColor:"#DDDDDD"}},onClick:S,children:(0,y.jsx)(g.Z,{sx:{fontSize:"16px"}})})}),!n&&(0,y.jsx)(l.Z,{title:"Delete",placement:"top-start",children:(0,y.jsx)(s.Z,{size:"small",sx:{":hover":{backgroundColor:"#DDDDDD"}},onClick:function(){return r(o)},children:(0,y.jsx)(x.Z,{sx:{fontSize:"16px"}})})})]})})};function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}O.defaultProps={isAdded:!1,noEdit:!1,noDelete:!1,url:"",name:"",onSave:function(){},onCancel:function(){},onDelete:function(){}};var k=function(e){var t=e.values,n=e.setValue,r=e.name,d=e.title,p=e.displayMode,v=e.noDeleteEdit,f=e.titleSx,m=(0,c.useState)([]),g=m[0],x=m[1];(0,c.useEffect)(function(){Array.isArray(t)&&x(t)},[t]);var h=function(e){e.stopPropagation(),x(function(e){return[].concat((0,o.Z)(e),[{name:"",link:"",isAdded:!0}])})},b=function(e,t){var a=(0,o.Z)(g);a.splice(e,1,t),n(r,a)};return(0,y.jsxs)(a.Z,{children:[(0,y.jsxs)(a.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,y.jsxs)(i.Z,{sx:f,children:[d,":"]}),!p&&(0,y.jsx)(l.Z,{title:"Add new link",placement:"top-start",children:(0,y.jsx)(s.Z,{size:"small",sx:{":hover":{backgroundColor:"#DDDDDD"}},onClick:h,children:(0,y.jsx)(u.Z,{})})})]}),(0,y.jsx)(a.Z,{pl:2,spacing:.8,children:null!=g&&g.length?g.map(function(e,o){var a;return(0,y.jsx)(O,C(C({index:o},e),{},{noEdit:v||p,noDelete:v||p,onDelete:function(){var e=t.filter(function(e,t){return t!==o});n(r,e),x(e)},onSave:function(e){return b(o,e)}}))}):(0,y.jsx)(i.Z,{typography:"subtitle2",children:"No data"})})]})};k.defaultProps={values:[],setValue:function(){},title:"Related links",displayMode:!1,noDeleteEdit:!1,titleSx:{}}},6911:function(e,t,n){"use strict";n.d(t,{q:function(){return f}});var r=n(59499),o=n(4730),a=n(23776),i=n(87918),l=n(50135),s=n(98456),u=n(67294),c=n(85893),d=["loading","setSearch","textFieldProps"];function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function v(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var f=function(e){var t=e.loading,n=e.setSearch,r=e.textFieldProps,p=(0,o.Z)(e,d),f=(0,u.useState)(""),m=f[0],g=f[1];return(0,u.useEffect)(function(){var e=setTimeout(function(){n(m)},500);return function(){return clearTimeout(e)}},[m,n]),(0,c.jsx)(a.Z,v(v({},p),{},{loading:t,onInputChange:function(e,t){g(t)},getOptionLabel:function(e){return e.label},renderTags:function(e,t){return e.map(function(e,n){return(0,c.jsx)(i.Z,v({size:"small",label:e.label},t({index:n})))})},renderInput:function(e){return(0,c.jsx)(l.Z,v(v(v({},e),r),{},{InputProps:v(v(v({},e.InputProps),r.InputProps||{}),{},{endAdornment:(0,c.jsxs)(c.Fragment,{children:[t?(0,c.jsx)(s.Z,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})})}))}}))};f.defaultProps={color:"secondary",onChange:function(){},options:[],onOpen:function(){},setSearch:function(){},textFieldProps:{}}},9164:function(e,t,n){"use strict";n.d(t,{r:function(){return c}});var r=n(59499),o=n(41664),a=n.n(o),i=n(23795),l=n(85893);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var c=function(e){var t=e.children,n=e.href,r=e.noWrap,o=e.target,s=e.sx,c=void 0===s?{}:s;return r?(0,l.jsx)(l.Fragment,{children:t}):n?(0,l.jsx)(a(),{href:n,target:o,passHref:!0,children:(0,l.jsx)(i.Z,u(u({sx:c},e),{},{children:t}))}):(0,l.jsx)(i.Z,u(u({sx:c},e),{},{children:t}))};c.defaultProps={onClick:function(e){e.stopPropagation()}}},35137:function(e,t,n){"use strict";n.d(t,{C:function(){return v}});var r=n(59499);n(67294);var o=n(90948),a=n(61730),i=n(26447),l=n(15861),s=n(11057),u=n(85893);function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var p=(0,o.ZP)("img")({width:"300px",height:"250px"}),v=function(e){var t=e.imageSrc,n=e.sx,r=e.imageSx,o=e.title,c=e.titleSx,v=e.subtitleFirstLine,f=e.subtitleFirstLineSx,m=e.subtitleSecondLine,g=e.subtitleSecondLineSx,x=e.buttonText,h=e.onAction,b=(0,a.Z)("(max-width: 400px)");return(0,u.jsxs)(i.Z,{sx:d(d({},n),{},{width:"100%",height:"100%"}),justifyContent:"center",alignItems:"center",spacing:2,color:"#757575",children:[(0,u.jsx)(p,{src:t,sx:d(d({},r),{},{width:b?"250px":"300px"})}),(0,u.jsx)(l.Z,{typography:"h5",sx:d({},c),children:o}),(0,u.jsxs)(i.Z,{alignItems:"center",sx:{padding:"0px 10px",textAlign:"center"},children:[(0,u.jsx)(l.Z,{sx:d({},f),children:v}),(0,u.jsx)(l.Z,{sx:d({},g),children:m})]}),x&&h&&(0,u.jsx)(s.Z,{variant:"contained",color:"secondary",onClick:h,children:x})]})};v.defaultProps={title:"",subtitleFirstLine:"",subtitleSecondLine:"",sx:{},imageSx:{},titleSx:{},subtitleFirstLineSx:{},subtitleSecondLineSx:{},onAction:null}},77010:function(e,t,n){"use strict";n.d(t,{E:function(){return m}});var r=n(59499),o=n(94054),a=n(26447),i=n(40476),l=n(79717),s=n(50480),u=n(36872),c=n(15861),d=n(56815),p=n(85893);function v(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?v(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):v(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var m=function(e){var t=e.label,n=e.options,r=e.error,v=e.helperText,m=e.stackProps,x=e.formControlProps,h=e.labelLeft,b=function(e){var t=e.children;return(0,p.jsx)(p.Fragment,{children:t})};return(0,p.jsxs)(o.Z,f(f({sx:{m:3},error:r,variant:"standard"},void 0===x?{}:x),{},{children:[(0,p.jsxs)(a.Z,f(f({},h&&g),{},{children:[t&&(0,p.jsx)(i.Z,{id:"radio-group",color:"secondary",children:t}),(0,p.jsx)(l.Z,f(f({},e),{},{"aria-labelledby":"radio-group",children:(0,p.jsx)(a.Z,f(f({},void 0===m?{}:m),{},{children:n.map(function(e){var t=e.value,n=e.label,r=e.icon,o=e.ParentComponent;return(0,p.jsx)(void 0===o?b:o,{children:(0,p.jsx)(s.Z,{value:t,control:(0,p.jsx)(u.Z,{color:"secondary"}),label:(0,p.jsxs)(a.Z,{direction:"row",alignItems:"center",spacing:1,children:[r,(0,p.jsx)(c.Z,{children:n})]})})})})}))}))]})),(0,p.jsx)(d.Z,{children:v})]}))};m.defaultProps={options:[],error:!1,helperText:"",stackProps:{},formControlProps:{},labelLeft:!1};var g={direction:"row",alignItems:"center",flexWrap:"wrap",spacing:1}},76301:function(e,t,n){"use strict";n.d(t,{Ak:function(){return W},Cj:function(){return J},K4:function(){return er},Qn:function(){return Q},RJ:function(){return z},SW:function(){return A},T_:function(){return V},UH:function(){return E},UM:function(){return et},Ve:function(){return Y},_d:function(){return N},_f:function(){return en},by:function(){return B},cz:function(){return $},he:function(){return U},j$:function(){return F},kB:function(){return K},kU:function(){return X},kx:function(){return G},nD:function(){return L},nP:function(){return ea},pY:function(){return eo},qd:function(){return R},t1:function(){return M},yR:function(){return H},zR:function(){return ee}});var r,o,a,i,l,s,u,c,d,p,v,f,m,g,x,h,b,y,j,w,O,T,C,k,q,P,Z,S,I,_=n(71383),D=n(75063),$=(0,D.Ps)(r||(r=(0,_.Z)(["\n  query GetAddressForSelect($q: String, $entity: String!, $entityId: Int!) {\n    items: Address(\n      where: {\n        Address_Entities: { entity: { _eq: $entity }, entityId: { _eq: $entityId } }\n        _or: [\n          { addressLine1: { _eq: $q } }\n          { addressLine2: { _eq: $q } }\n          { addressLine3: { _eq: $q } }\n          { county: { _eq: $q } }\n          { postCode: { _eq: $q } }\n          { city: { _eq: $q } }\n        ]\n      }\n    ) {\n      label: addressLine1\n      value: id\n      id\n      name\n      addressLine1\n      addressLine2\n      addressLine3\n      postCode\n      county\n      country: Country {\n        name\n      }\n      city\n      Address_Entities {\n        invoice\n      }\n    }\n  }\n"]))),R=(0,D.Ps)(o||(o=(0,_.Z)(["\n  query GetAccountsForSelect($q: String, $type: String, $limit: Int, $offset: Int) {\n    items: Account(\n      where: { name: { _ilike: $q }, type: { _eq: $type } }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]))),L=(0,D.Ps)(a||(a=(0,_.Z)(['\n  query GetTaxonomy($q: String, $id: Int) {\n    items: Taxonomy(\n      where: { type: { _eq: "assetCategory" }, status: { _eq: "active" } }\n      order_by: { name: asc }\n    ) {\n      label: name\n      options: Taxonomies(\n        where: {\n          type: { _eq: "assetCategory" }\n          name: { _ilike: $q }\n          id: { _eq: $id }\n          status: { _eq: "active" }\n        }\n        order_by: { name: asc }\n      ) {\n        value: id\n        label: name\n      }\n    }\n  }\n']))),E=(0,D.Ps)(i||(i=(0,_.Z)(["\n  query GetAssetsForSelect($locationId: Int, $q: String, $categoryId: Int, $bookable: String) {\n    items: Asset(\n      where: {\n        categoryId: { _eq: $categoryId }\n        locationId: { _eq: $locationId }\n        name: { _ilike: $q }\n        bookable: { _eq: $bookable }\n      }\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n      parent: ParentAsset {\n        id\n        name\n      }\n      media: Media {\n        id\n        item: Medium {\n          id\n          name\n          filename\n          meta\n          category\n          type\n        }\n      }\n    }\n  }\n"]))),A=(0,D.Ps)(l||(l=(0,_.Z)(['\n  query GetCustomersForSelect($q: String, $limit: Int, $offset: Int) {\n    items: Account(\n      where: { name: { _ilike: $q }, type: { _eq: "customer" } }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      admin: Admins {\n        id: adminId\n      }\n      label: name\n      spendThreshold: meta(path: "$.finance.spendThreshold")\n      serviceRateLabour: meta(path: "$.finance.serviceRateLabour")\n      serviceRateExpenses: meta(path: "$.finance.serviceRateExpenses")\n      value: id\n    }\n  }\n']))),Q=(0,D.Ps)(s||(s=(0,_.Z)(["\n  query GetJobsForSelect($_q: Int, $locationId: Int) {\n    items: Job(\n      where: {\n        Location: { id: { _eq: $locationId } }\n        _or: [{ id: { _eq: $_q } }, { Invoices: { id: { _eq: $_q } } }]\n      }\n      order_by: { title: asc }\n    ) {\n      label: label\n      value: id\n      number\n      createdAt\n      description\n      status\n      timingStart\n      title\n      type\n      Location {\n        name\n      }\n      Taxonomy {\n        Taxonomy {\n          shortJobDescription: name\n        }\n      }\n    }\n  }\n"]))),U=(0,D.Ps)(u||(u=(0,_.Z)(['\n  query GetManagersForSelect($userId: Int, $accountId: Int!, $q: String) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        Account_Users: {\n          role: { _in: ["owner", "manager"] }\n          status: { _eq: "active" }\n          Account: { id: { _eq: $accountId } }\n        }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n        id: { _neq: $userId }\n      }\n      order_by: { nameFirst: asc }\n    ) {\n      label: fullName\n      value: id\n    }\n  }\n']))),W=(0,D.Ps)(c||(c=(0,_.Z)(['\n  query GetManagersForSelect(\n    $userId: Int\n    $accountId: Int!\n    $q: String\n    $invoiceThreshold: numeric\n    $quoteThreshold: numeric\n  ) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        Account_Users: {\n          role: { _in: ["owner", "manager"] }\n          status: { _eq: "active" }\n          Account: { id: { _eq: $accountId } }\n        }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n        id: { _neq: $userId }\n        _and: [\n          {\n            _or: [\n              { invoiceThreshold: { _gt: $invoiceThreshold } }\n              { invoiceThreshold: { _is_null: true } }\n            ]\n          }\n          {\n            _or: [\n              { quoteThreshold: { _gt: $quoteThreshold } }\n              { quoteThreshold: { _is_null: true } }\n            ]\n          }\n        ]\n      }\n      order_by: { nameFirst: asc }\n    ) {\n      label: fullName\n      value: id\n    }\n  }\n']))),F=(0,D.Ps)(d||(d=(0,_.Z)(["\n  query GetPostCodeAreaForSelect($countryId: Int, $q: String) {\n    items: PostcodeArea(\n      where: { name: { _ilike: $q }, countryId: { _eq: $countryId } }\n      order_by: { name: asc }\n    ) {\n      area\n      label: name\n      value: id\n    }\n  }\n"]))),N=(0,D.Ps)(p||(p=(0,_.Z)(['\n  query GetPropertiesForSelect($where: Location_bool_exp, $limit: Int, $offset: Int) {\n    items: Location(where: $where, order_by: { name: asc }, limit: $limit, offset: $offset) {\n      label: name\n      value: id\n      access\n      permitsRequired\n      registeredAddress: Addresses(\n        where: { entity: { _eq: "Location" }, registered: { _eq: true } }\n      ) {\n        address: Address {\n          id\n          addressLine1\n          addressLine2\n          addressLine3\n          county\n          country: Country {\n            name\n          }\n          postCode\n          city\n        }\n      }\n    }\n  }\n']))),G=(0,D.Ps)(v||(v=(0,_.Z)(['\n  query GetServicesForSelect($q: String, $limit: Int, $offset: Int) {\n    items: Service(\n      where: { name: { _ilike: $q }, status: { _eq: "active" } }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n']))),M=(0,D.Ps)(f||(f=(0,_.Z)(["\n  query GetSlasForSelect($q: String, $adminId: Int, $type: String) {\n    items: SLA(\n      where: { name: { _ilike: $q }, type: { _eq: $type }, adminId: { _eq: $adminId } }\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]))),V=(0,D.Ps)(m||(m=(0,_.Z)(["\n  query GetSlasForSelectNew($where: SLA_bool_exp, $limit: Int, $offset: Int) {\n    items: SLA(where: $where, order_by: { name: asc }, limit: $limit, offset: $offset) {\n      label: name\n      value: id\n    }\n  }\n"]))),B=(0,D.Ps)(g||(g=(0,_.Z)(["\n  query GetSuppliersForSelect($where: Account_bool_exp, $limit: Int, $offset: Int) {\n    items: Account(where: $where, limit: $limit, offset: $offset, order_by: { name: asc }) {\n      label: name\n      value: id\n    }\n  }\n"]))),H=(0,D.Ps)(x||(x=(0,_.Z)(['\n  query GetUsersForSelect($accountId: Int, $q: String, $limit: Int, $offset: Int) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        Account_Users: {\n          accountId: { _eq: $accountId }\n          isContact: { _eq: true }\n          status: { _eq: "active" }\n        }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n      }\n      order_by: { nameFirst: asc }\n      limit: $limit\n      offset: $offset\n    ) {\n      label: fullName\n      value: id\n      email\n      phone\n    }\n  }\n']))),z=(0,D.Ps)(h||(h=(0,_.Z)(['\n  query GetUsersForSelect($q: String) {\n    items: User(\n      where: {\n        status: { _eq: "active" }\n        _or: [{ nameFirst: { _ilike: $q } }, { nameLast: { _ilike: $q } }]\n      }\n      order_by: { nameFirst: asc }\n    ) {\n      label: fullName\n      value: id\n      email\n      phone\n    }\n  }\n']))),J=(0,D.Ps)(b||(b=(0,_.Z)(["\n  query GetTaxonomyGroupForSelect($q: String, $type: String!) {\n    items: Taxonomy(\n      where: { isGroup: { _eq: true }, name: { _ilike: $q }, type: { _eq: $type } }\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]))),Y=(0,D.Ps)(y||(y=(0,_.Z)(['\n  query GetTaxonomy($q: String) {\n    items: Taxonomy(where: { type: { _eq: "expenseCategoryGroup" } }, order_by: { name: asc }) {\n      label: name\n      options: Taxonomies(\n        where: { type: { _eq: "expenseCategory" }, name: { _ilike: $q } }\n        order_by: { name: asc }\n      ) {\n        value: id\n        label: name\n      }\n    }\n  }\n']))),X=(0,D.Ps)(j||(j=(0,_.Z)(['\n  query GetCompliancesForSelect($q: String, $locationId: Int) {\n    items: Taxonomy(where: { type: { _eq: "complianceCategory" } }, order_by: { name: asc }) {\n      label: name\n      options: Compliances(\n        where: {\n          name: { _ilike: $q }\n          Compliance_Entities: { Location: { id: { _eq: $locationId } } }\n        }\n        order_by: { name: asc }\n      ) {\n        value: id\n        label: name\n      }\n    }\n  }\n']))),K=(0,D.Ps)(w||(w=(0,_.Z)(["\n  query GetUserRole($userId: Int!, $accountId: Int!) {\n    accountUsers: Account_User(\n      where: { userId: { _eq: $userId }, accountId: { _eq: $accountId } }\n    ) {\n      role\n    }\n  }\n"]))),ee=(0,D.Ps)(O||(O=(0,_.Z)(["\n  query GetSublocationsForSelect($locationId: Int!, $q: String, $limit: Int, $offset: Int) {\n    items: Sublocation(\n      where: { name: { _ilike: $q }, locationId: { _eq: $locationId }, active: { _eq: true } }\n      limit: $limit\n      offset: $offset\n      order_by: { createdAt: desc }\n    ) {\n      value: id\n      label: name\n    }\n  }\n"]))),et=(0,D.Ps)(T||(T=(0,_.Z)(['\n  query GetTaxonomy($q: String, $id: Int, $limit: Int, $offset: Int) {\n    items: Taxonomy(\n      where: {\n        id: { _eq: $id }\n        type: { _eq: "assetCategory" }\n        isGroup: { _eq: false }\n        status: { _eq: "active" }\n        name: { _ilike: $q }\n      }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n']))),en=(0,D.Ps)(C||(C=(0,_.Z)(["\n  query GetTaxonomyForSelect(\n    $where: Taxonomy_bool_exp\n    $limit: Int\n    $offset: Int\n    $orderBy: Taxonomy_order_by!\n  ) {\n    items: Taxonomy(where: $where, limit: $limit, offset: $offset, order_by: [$orderBy]) {\n      value: id\n      label: name\n    }\n  }\n"])));(0,D.Ps)(k||(k=(0,_.Z)(['\n  query GetTagsForTask($q: String!, $limit: Int = 50, $offset: Int = 0) {\n    items: Taxonomy(\n      where: { name: { _ilike: $q }, status: { _eq: "active" }, type: { _eq: "taskTags" } }\n      limit: $limit\n      offset: $offset\n      order_by: { id: desc }\n    ) {\n      value: id\n      label: name\n    }\n  }\n']))),(0,D.Ps)(q||(q=(0,_.Z)(['\n  query GetTagsForEntity(\n    $entityId: Int\n    $entity: String!\n    $q: String!\n    $limit: Int = 50\n    $offset: Int = 0\n  ) {\n    tags: Taxonomy(\n      where: {\n        name: { _ilike: $q }\n        status: { _eq: "active" }\n        type: { _eq: "taskTags" }\n        _not: { Taxonomy_Entities: { entity: { _eq: $entity }, entityId: { _eq: $entityId } } }\n      }\n      limit: $limit\n      offset: $offset\n      order_by: { id: desc }\n    ) {\n      id\n      name\n      meta\n    }\n  }\n']))),(0,D.Ps)(P||(P=(0,_.Z)(['\n  query GetEntityTags($entityId: Int!, $entity: String!) {\n    tags: Taxonomy_Entity(\n      where: {\n        entity: { _eq: $entity }\n        entityId: { _eq: $entityId }\n        Taxonomy: { status: { _eq: "active" }, type: { _eq: "taskTags" } }\n      }\n      order_by: { id: desc }\n    ) {\n      id\n      tag: Taxonomy {\n        id\n        name\n        meta\n      }\n    }\n  }\n'])));var er=(0,D.Ps)(Z||(Z=(0,_.Z)(["\n  query GetCustomerManagers($accountId: Int, $q: String, $limit: Int, $offset: Int) {\n    items: User(\n      where: { Account_Users: { accountId: { _eq: $accountId } }, fullName: { _ilike: $q } }\n      order_by: { fullName: asc }\n      limit: $limit\n      offset: $offset\n    ) {\n      label: fullName\n      value: id\n    }\n  }\n"]))),eo=(0,D.Ps)(S||(S=(0,_.Z)(["\n  query GetServiceSchedulesForSelect(\n    $q: String\n    $serviceId: Int\n    $entity: service_schedule_entity\n    $entityId: Int\n    $limit: Int = 50\n    $offset: Int = 0\n  ) {\n    items: ServiceSchedule(\n      where: {\n        name: { _ilike: $q }\n        serviceId: { _eq: $serviceId }\n        entity: { _eq: $entity }\n        entityId: { _eq: $entityId }\n      }\n      limit: $limit\n      offset: $offset\n      order_by: { name: asc }\n    ) {\n      label: name\n      value: id\n    }\n  }\n"]))),ea=(0,D.Ps)(I||(I=(0,_.Z)(['\n  query GetPropertyById($id: Int!) {\n    item: Location_by_pk(id: $id) {\n      label: name\n      value: id\n      access\n      registeredAddress: Addresses(\n        where: { entity: { _eq: "Location" }, registered: { _eq: true } }\n      ) {\n        address: Address {\n          id\n          addressLine1\n          addressLine2\n          addressLine3\n          county\n          country: Country {\n            name\n          }\n          postCode\n          city\n        }\n      }\n    }\n  }\n'])))},67432:function(e,t,n){"use strict";n.d(t,{P:function(){return j}});var r=n(59499),o=n(10166),a=n(26447),i=n(15861),l=n(87918),s=n(69368),u=n(18360),c=n(5616),d=n(18972),p=n(56815),v=n(94054),f=n(47312),m=n(85893),g=n(67294);function x(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function h(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?x(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var b={text:function(e){var t=e.option,n=e.multiple,r=e.index;return n&&r>0?", ".concat(t.label):t.label},textWithIcon:function(e){var t=e.option;return(0,m.jsxs)(a.Z,{direction:"row",alignItems:"center",spacing:1,children:[t.icon,(0,m.jsxs)(i.Z,{children:[" ",t.label]})]})},chip:function(e){var t=e.chipProps,n=e.option;return(0,g.createElement)(l.Z,h(h({},t),{},{key:n.value,label:n.label,icon:n.icon,sx:{color:n.color,bgcolor:n.bgcolor}}))}},y={text:function(e){return e.option.label},textWithIcon:function(e){var t=e.option;return(0,m.jsxs)(a.Z,{direction:"row",alignItems:"center",spacing:1,children:[t.icon,(0,m.jsxs)(i.Z,{children:[" ",t.label]})]})},chip:function(e){var t=e.chipProps,n=e.option;return(0,g.createElement)(l.Z,h(h({},t),{},{key:n.value,label:n.label,icon:n.icon,sx:{color:n.color,bgcolor:n.bgcolor}}))},checkbox:function(e){var t=e.option,n=e.value;return(0,m.jsxs)(a.Z,{direction:"row",alignItems:"center",spacing:1,children:[(0,m.jsx)(s.Z,{color:"secondary",sx:{height:"10px"},checked:n.indexOf(t.value)>-1}),(0,m.jsxs)(i.Z,{children:[" ",t.label]})]})}},j=function(e){var t=e.label,n=e.value,r=e.onChange,o=e.leftSideLabel,a=e.options,l=e.inputComponent,s=e.selectComponent,v=e.withoutSelectIcon,f=e.formControl,g=e.chipProps,x=e.selectProps,j=function(e){return a.find(function(t){return t.value===e})};return(0,m.jsxs)(w,h(h({},f),{},{leftSideLabel:o,withoutSelectIcon:v,children:[t&&o&&(0,m.jsx)(i.Z,{children:t}),t&&!o&&(0,m.jsx)(O,{shrink:""!==n&&void 0!==n,children:t}),(0,m.jsx)(u.Z,h(h({displayEmpty:!0},x),{},{value:n,onChange:r,inputProps:{shrink:!0},renderValue:function(){if(Array.isArray(n))return(0,m.jsx)(c.Z,{sx:{display:"flex",flexWrap:"wrap",gap:.5},children:n.map(function(e,t){var n=j(e);return n?b[l]({chipProps:g,option:n,multiple:!0,index:t}):""})});var e=j(n);return e?(0,m.jsx)(c.Z,{children:b[l]({chipProps:g,option:e})}):""},children:a.map(function(e){return(0,m.jsx)(d.Z,{value:e.value,children:y[s]({chipProps:g,option:e,value:n})},e.value)})})),(null==f?void 0:f.helperText)&&(0,m.jsx)(p.Z,{children:f.helperText})]}))};j.defaultProps={label:"",onChange:function(){},leftSideLabel:!1,options:[],inputComponent:"text",selectComponent:"text",withoutSelectIcon:!1,formControl:{error:!1,helperText:""},chipProps:{size:"small"},selectProps:{}};var w=(0,o.Z)(v.Z)(function(e){e.theme;var t=e.leftSideLabel,n=e.withoutSelectIcon;return{"&.MuiFormControl-root":h({display:"flex",flexDirection:"column",alignItems:"flex-start"},t&&{display:"flex",flexDirection:"row",alignItems:"center",gap:"10px"}),"& .MuiSelect-icon":h({},n&&{display:"none"})}}),O=(0,o.Z)(f.Z)(function(e){return{"&.MuiFormLabel-root.MuiInputLabel-root.Mui-focused":{color:e.theme.palette.secondary.main}}})},42846:function(e,t,n){"use strict";n.d(t,{x:function(){return c}});var r=n(59499),o=n(67294),a=n(96486),i=n(87043),l=function(e){try{return JSON.parse(e)}catch(t){return!1}};function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var c=function(e){var t,n,s,c,d,p,v,f,m,g,x,h=e.filters,b=e.newFilters,y=e.initialSort,j=(0,o.useRef)(),w=(0,o.useState)({}),O=w[0],T=w[1],C=(0,o.useState)({}),k=C[0],q=C[1],P=y||{item:"createdAt",order:"desc"},Z=(0,r.Z)({},(null===(t=j.current)||void 0===t?void 0:t.sort.item)||P.item,P.inneritem?(0,r.Z)({},P.inneritem,(null===(n=j.current)||void 0===n?void 0:n.sort.order)||P.order):(null===(s=j.current)||void 0===s?void 0:s.sort.order)||P.order);return(0,o.useEffect)(function(){var e=!(0,a.isEqual)(O,h),t=!(0,a.isEqual)(k,b);if(e&&(T(h),null==j||null===(r=j.current)||void 0===r||r.resetPagination()),t&&(q(b),null==j||null===(o=j.current)||void 0===o||o.resetPagination()),null!=j&&null!==(n=j.current)&&void 0!==n&&n.setSort&&!(e||t)){var n,r,o,i,l,s,u,c,d,p,v,f=null!==(i=j.current)&&void 0!==i&&null!==(l=i.sort)&&void 0!==l&&l.item&&null!==(s=j.current)&&void 0!==s&&null!==(u=s.sort)&&void 0!==u&&u.order?{item:null===(c=j.current)||void 0===c?void 0:null===(d=c.sort)||void 0===d?void 0:d.item,order:null===(p=j.current)||void 0===p?void 0:null===(v=p.sort)||void 0===v?void 0:v.order}:Z;j.current.setSort(f)}},[h,b]),{initialData:u(u({},h),{},{newFilters:(null==b?void 0:b.length)>0?b:void 0,limit:(null===(c=j.current)||void 0===c?void 0:c.pageSize)==="Infinity"?null:parseInt(null===(d=j.current)||void 0===d?void 0:d.pageSize,10)||i.C1.paginationSize,offset:((null===(p=j.current)||void 0===p?void 0:p.currentPage)-1||0)*((null===(v=j.current)||void 0===v?void 0:v.pageSize)||i.C1.paginationSize),orderBy:l(null===(f=j.current)||void 0===f?void 0:null===(m=f.sort)||void 0===m?void 0:null===(g=m.item)||void 0===g?void 0:g.replace(/ORDER/i,null===(x=j.current)||void 0===x?void 0:x.sort.order))||Z}),initialSort:y,ref:j}}},49908:function(e,t,n){"use strict";n.d(t,{n:function(){return D}});var r=n(59499),o=n(27812),a=n(50029),i=n(16835),l=n(64687),s=n.n(l),u=n(96486),c=n(6812),d=n(50319),p=n(96405),v=n(26447),f=n(5616),m=n(23776),g=n(18972),x=n(50135),h=n(98456),b=n(78462),y=n(93946),j=n(14564),w=n(67294),O=n(93362),T=n(10166),C=n(72936),k=n(33063),q=n(52098),P=n(88284),Z=n(85893);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var _=(0,O.D)(),D=function(e){var t=e.entityId,n=e.entity,r=e.values,l=void 0===r?[]:r,j=e.name,O=void 0===j?"tags":j,T=e.setValue,S=(0,C.x)().user,D=(0,w.useState)(null),R=D[0],L=D[1],E=(0,w.useState)(""),A=E[0],Q=E[1],U=(0,w.useState)(""),W=U[0],F=U[1],N=(0,w.useState)(""),G=N[0],M=N[1],V=(0,c.a)(q.BU,{skip:!t,variables:{entityId:t,entity:n},onCompleted:function(e){T(O,e.tags)}}),B=V.data,H=(B=void 0===B?{tags:[]}:B).tags,z=V.loading,J=V.refetch,Y=(0,c.a)(q.gI,{skip:!R,variables:{entityId:t,entity:n,q:""!==G?"%".concat(G,"%"):null}}),X=Y.data,K=(X=void 0===X?{tags:[]}:X).tags,ee=Y.loading,et=(0,d.D)(q.Zm,{refetchQueries:["GetAllTags"]}),en=(0,i.Z)(et,2),er=en[0],eo=en[1].loading,ea=(0,d.D)(q.LE,{onCompleted:function(){J()}}),ei=(0,i.Z)(ea,2),el=ei[0],es=ei[1].loading,eu=(0,d.D)(q.cS,{onCompleted:function(){J()}}),ec=(0,i.Z)(eu,2),ed=ec[0],ep=ec[1].loading,ev=(0,d.D)(q.g$,{refetchQueries:["GetAllTags"]}),ef=(0,i.Z)(ev,2),em=ef[0],eg=ef[1].loading;(0,w.useEffect)(function(){var e=setTimeout(function(){M(W)},500);return function(){return clearTimeout(e)}},[W]);var ex,eh,eb,ey=function(e){e.stopPropagation(),L(e.currentTarget)},ej=function(){L(null)},ew=(ex=(0,a.Z)(s().mark(function e(r,a){var i,u;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("string"!=typeof a){e.next=4;break}Q({label:a}),e.next=24;break;case 4:if(!(a&&a.inputValue&&t)){e.next=9;break}el({variables:{objects:[{entity:n,entityId:t,Taxonomy:{data:{type:"tags",status:"active",name:a.inputValue,meta:{color:"#0679d8"},isGroup:!1,adminId:S.adminId}}}]}}),Q(null),e.next=24;break;case 9:if(!(a&&a.value&&t)){e.next=14;break}el({variables:{objects:[{entity:n,entityId:t,taxonomyId:a.value}]}}),Q(null),e.next=24;break;case 14:if(!(a&&a.inputValue)){e.next=23;break}return e.next=17,er({variables:{objects:[{type:"tags",status:"active",name:a.inputValue,meta:{color:"#0679d8"},isGroup:!1,adminId:S.adminId}]}});case 17:u=e.sent.data.insert_Taxonomy,T(O,[].concat((0,o.Z)(l),[{id:null,tag:{id:u.returning[0].id,name:u.returning[0].name,meta:u.returning[0].meta}}])),Q(null),e.next=24;break;case 23:a&&a.value&&(T(O,[].concat((0,o.Z)(l),[{id:null,tag:{id:a.value,name:a.label,meta:a.meta}}])),Q(null));case 24:case"end":return e.stop()}},e)})),function(e,t){return ex.apply(this,arguments)}),eO=(0,w.useCallback)(function(e,t){var n=_(e,t),r=t.inputValue,o=e.some(function(e){return r===e.label});return""===r||o||n.push({inputValue:r,label:'Add "'.concat(r,'"')}),n},[]),eT=(0,w.useCallback)(function(e){return"string"==typeof e?e:e.inputValue?e.inputValue:e.label},[]),eC=function(e){t?ed({variables:{tagEntityId:e}}):T(O,l.filter(function(t,n){return n!==e}))},ek=(eh=(0,a.Z)(s().mark(function e(t){var n,r,o,a,i;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.tagId,r=t.color,e.next=3,em({variables:{tagId:n,object:{meta:{color:r}}}});case 3:a=e.sent.data.update_Taxonomy_by_pk,i=l.map(function(e){return e.tag.id===n?I(I({},e),{},{tag:I({},a)}):e}),T(O,i);case 7:case"end":return e.stop()}},e)})),function(e){return eh.apply(this,arguments)}),eq=(eb=(0,a.Z)(s().mark(function e(t){var n,r,o,a,i;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.tagId,r=t.name,e.next=3,em({variables:{tagId:n,object:{name:r}}});case 3:a=e.sent.data.update_Taxonomy_by_pk,i=l.map(function(e){return e.tag.id===n?I(I({},e),{},{tag:I({},a)}):e}),T(r,i);case 7:case"end":return e.stop()}},e)})),function(e){return eb.apply(this,arguments)}),eP=Boolean(R),eZ=(0,w.useMemo)(function(){return K.map(function(e){return{label:e.name,value:e.id,meta:e.meta}})},[K]),eS=(0,w.useMemo)(function(){return u.uniqBy([].concat((0,o.Z)(H),(0,o.Z)(l)),function(e){var t;return null===(t=e.tag)||void 0===t?void 0:t.id})},[H,l]);return(0,Z.jsxs)(v.Z,{direction:"row",alignItems:"center",children:[(0,Z.jsx)(P.P,{tags:eS,handleDeleteTagEntity:eC}),(0,Z.jsx)($,{id:eP?"tags-popover":void 0,open:eP,anchorEl:R,onClose:ej,anchorOrigin:{vertical:"top",horizontal:"right"},children:(0,Z.jsxs)(f.Z,{sx:{maxHeight:"80vh",width:"280px",p:"10px",pt:"5px"},children:[(0,Z.jsx)(m.Z,{freeSolo:!0,selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,options:(0,o.Z)(eZ),value:A,onChange:ew,onInputChange:function(e,t){F(t)},filterOptions:eO,getOptionLabel:eT,renderOption:function(e,t){return(0,Z.jsx)(g.Z,I(I({},e),{},{children:t.label}))},renderInput:function(e){return(0,Z.jsx)(x.Z,I(I({},e),{},{variant:"standard",color:"secondary",label:"Search tag",InputProps:I(I({},e.InputProps),{},{endAdornment:(0,Z.jsxs)(Z.Fragment,{children:[ee||eo||es?(0,Z.jsx)(h.Z,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})})}))},sx:{pl:"16px",pr:"16px"}}),z||ep||eg?(0,Z.jsx)(v.Z,{width:"100%",alignItems:"center",p:4,children:(0,Z.jsx)(h.Z,{color:"secondary"})}):(0,Z.jsx)(b.Z,{children:null==eS?void 0:eS.map(function(e,t){var n;return(0,Z.jsx)(k.T,{tagEntityId:e.id||t,tagId:e.tag.id,name:e.tag.name,color:null===(n=e.tag.meta)||void 0===n?void 0:n.color,onDelete:eC,onColorChange:ek,onNameChange:eq})})})]})}),(0,Z.jsx)(y.Z,{color:"black",onClick:ey,children:(0,Z.jsx)(p.Z,{sx:{height:"16px",width:"16px"}})})]})};D.defaultProps={entityId:null};var $=(0,T.Z)(j.ZP)({"& .MuiPaper-root":{borderRadius:"12px"}})},46353:function(e,t,n){"use strict";n.d(t,{Y:function(){return r}});var r=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Job",n="";return null!=e&&e.length&&(n="\n      Taxonomy: {\n      _and: [\n        { entity: { _eq: ".concat(t,' } }\n        {\n          Taxonomy: {\n            status: { _eq: "active" }\n            _and: [{ id: { _in: [').concat(e,'] } }, { type: { _eq: "tags" } }]\n          }\n        }\n      ]\n    }\n  ')),n}},32715:function(e,t,n){"use strict";n.d(t,{d:function(){return i}});var r=n(11994),o=n(67294),a=n(85893);function i(){var e=(0,o.useState)(null),t=e[0],n=e[1],i=(0,o.useCallback)(function(){n(null)},[]),l=(0,o.useMemo)(function(){if(null===t)return null;var e=t.content,n=t.keepMounted;return(0,a.jsx)(r.Z,{open:!0,keepMounted:n,onClose:i,children:e})},[t,i]),s=(0,o.useCallback)(function(e){var t=e.content,r=e.keepMounted;n({keepMounted:void 0===r||r,content:t({onClose:i})})},[i]);return[l,s]}},33366:function(e,t,n){"use strict";n.d(t,{AK:function(){return s},DJ:function(){return d},E6:function(){return o},cj:function(){return l},hD:function(){return c},iz:function(){return a},l8:function(){return u},yW:function(){return i}});var r=n(60092),o=[{text:"Quotation Requested",value:"supplierQuoteRequested",context:"info"},{text:"Quotation Completed",value:"supplierQuoteComplete",context:"help"},{text:"Draft Quotation",value:"supplierQuoteDraft",context:"info"},{text:"Awaiting threshold approval",value:"waitingThresholdApproval",context:"info"},{text:"Quotation Refused",value:"supplierQuoteRefused",context:"danger"},{text:"Quotation Sent",value:"supplierQuoteSent",context:"success"},{text:"Quotation Accepted",value:"quotationAccepted",context:"success"},{text:"Quotation Rejected",value:"quotationRejected",context:"danger"},{text:"Quotation Updated",value:"supplierQuoteUpdated",context:"success"}],a=[{text:"New Quote",value:"quoteNew",customerText:"Quote issued",supplierText:null},{text:"Sent to Supplier(s)",value:"quoteOffered",customerText:"Quote issued",supplierText:"Quote offered"},{text:"Received from Supplier(s)",value:"quoteReceived",customerText:"Final review",supplierText:"Quote submitted"},{text:"Sent to Customer",value:"quoteSent",customerText:"Awaiting approval",supplierText:"Awaiting approval"},{text:"Quote Accepted",value:"quoteAccepted",customerText:"Quote accepted",supplierText:"Quote accepted"},{text:"Quote Rejected",value:"quoteRejected",customerText:"Quote rejected",supplierText:"Quote rejected"},{text:"Canceled",value:"quoteCancelled",customerText:"Cancelled",supplierText:null},{text:"Closed",value:"quoteClosed",customerText:"Closed",supplierText:"Closed"}],i=[{text:"Pending",value:"pending",colour:r.Q.COLOUR.info},{text:"Raised",value:"raised",colour:r.Q.COLOUR.info},{text:"Offered",value:"offered",colour:r.Q.COLOUR.warning},{text:"Accepted",value:"accepted",colour:r.Q.COLOUR.success},{text:"In Progress",value:"inProgress",colour:r.Q.COLOUR.primary},{text:"Completed",value:"completed",colour:r.Q.COLOUR.muiLightGray},{text:"Awaiting threshold approval",value:"waitingThresholdApproval",colour:r.Q.COLOUR.info},{text:"Report Sent",value:"reportSent",colour:r.Q.COLOUR.muiGray},{text:"Invoice Sent",value:"invoiceSent",colour:r.Q.COLOUR.secondary},{text:"Customer Paid",value:"customerPaid",colour:r.Q.COLOUR.help},{text:"Supplier Paid",value:"supplierPaid",colour:r.Q.COLOUR.help},{text:"Canceled",value:"canceled",colour:r.Q.COLOUR.black},{text:"Closed",value:"closed",colour:r.Q.COLOUR.black},{text:"On Hold",value:"onHold",colour:r.Q.COLOUR.black},{text:"Continued",value:"continued",colour:r.Q.COLOUR.primary},{text:"Paused",value:"paused",colour:r.Q.COLOUR.black}],l=[{label:"Pending",value:"pending"},{label:"Raised",value:"raised"},{label:"Offered",value:"offered"},{label:"Accepted",value:"accepted"},{label:"In Progress",value:"inProgress"},{label:"Completed",value:"completed"},{label:"Awaiting threshold approval",value:"waitingThresholdApproval"},{label:"Report Sent",value:"reportSent"},{label:"Invoice Sent",value:"invoiceSent"},{label:"Customer Paid",value:"customerPaid"},{label:"Supplier Paid",value:"supplierPaid"},{label:"Quote",value:"quote"},{label:"Site Visit",value:"siteVisit"},{label:"Canceled",value:"canceled"},{label:"Closed",value:"closed"},{label:"On Hold",value:"onHold"},{label:"Continued",value:"continued"},{label:"Paused",value:"paused"}],s=[{text:"Uplift Draft",value:"upliftDraft",context:"info"},{text:"Supplier Uplift Requested",value:"supplierUpliftRequested",context:"secondary"},{text:"Uplift Requested Send to Customer",value:"upliftRequestSendCustomer",context:"secondary"},{text:"Uplift Approved",value:"customerUpliftApproved",context:"success"},{text:"Uplift Rejected",value:"customerUpliftRejected",context:"danger"}],u=[{text:"Offered",value:"offered",context:"info"},{text:"Raised",value:"raised",context:"info"},{text:"Pending",value:"pending",context:"info"},{text:"Accepted",value:"accepted",context:"info"},{text:"Uplift Requested by Supplier",value:"supplierUpliftRequested",context:"info"},{text:"Uplift Draft",value:"upliftDraft",context:"info"},{text:"Uplift Requested Send Customer",value:"upliftRequestSendCustomer",context:"info"},{text:"Uplift Requested Approved",value:"customerUpliftApproved",context:"success"},{text:"In Dispute",value:"inDispute",context:"info"},{text:"Resumed",value:"resumed",context:"Danger"},{text:"Quote Sent",value:"quoteSent",context:"info"},{text:"Quote Offered",value:"quoteOffered",context:"info"},{text:"Report Sent Supplier",value:"reportSentSupplier",context:"info"},{text:"Dispute Resolved",value:"disputeResolved",context:"info"},{text:"Validated",value:"validated",context:"success"},{text:"Un Validated",value:"unvalidated",context:"success"},{text:"Paused",value:"paused",context:"info"},{text:"TimingChanged",value:"timingChanged",context:"info"},{text:"Customer Paid",value:"customerPaid",context:"info"},{text:"In Progress",value:"inProgress",context:"info"},{text:"PPM Invoice Created",value:"ppmInvoiceCreated",context:"success"},{text:"Late Arrival",value:"lateArrival",context:"info"},{text:"Pricing Changed",value:"pricingChanged",context:"info"},{text:"Report Sent",value:"reportSent",context:"info"},{text:"Invoice Sent Supplier",value:"invoiceSentSupplier",context:"info"},{text:"Invoice Sent",value:"invoiceSent",context:"info"},{text:"Invoice Sent Customer",value:"invoiceSentCustomer",context:"info"},{text:"Quote Accepted",value:"quoteAccepted",context:"info"},{text:"On Hold",value:"onHold",context:"info"},{text:"Continued",value:"continued",context:"info"},{text:"Quote Received",value:"quoteReceived",context:"info"},{text:"Quote New",value:"quoteNew",context:"info"},{text:"Closed",value:"closed",context:"danger"},{text:"Re posted",value:"reposted",context:"info"},{text:"Supplier Paid",value:"supplierPaid",context:"info"},{text:"Rejected",value:"rejected",context:"info"},{text:"Completed",value:"completed",context:"info"},{text:"Canceled",value:"canceled",context:"danger"}],c=[{value:"complete",text:"Complete"},{value:"returnVisitByAnother",text:"Return Visit By Another"},{value:"returnVisit",text:"Return Visit"},{value:"completeCertificate",text:"Complete Certificate"},{value:"couldNotDo",text:"Could Not Do"}],d=[{text:"Not yet offered",value:"pending",colour:r.Q.COLOUR.muiGray},{text:"Not yet offered",value:"raised",colour:r.Q.COLOUR.muiGray},{text:"Offered",value:"offered",colour:r.Q.COLOUR.warning},{text:"Not yet started",value:"accepted",colour:r.Q.COLOUR.white},{text:"In Progress",value:"inProgress",colour:r.Q.COLOUR.primary},{text:"Completed",value:"completed",colour:r.Q.COLOUR.secondary},{text:"Requires approval",value:"waitingThresholdApproval",colour:r.Q.COLOUR.info},{text:"Completed",value:"reportSent",colour:r.Q.COLOUR.secondary},{text:"Completed",value:"invoiceSent",colour:r.Q.COLOUR.secondary},{text:"Completed",value:"customerPaid",colour:r.Q.COLOUR.secondary},{text:"Completed",value:"supplierPaid",colour:r.Q.COLOUR.secondary},{text:"Quote",value:"quote",colour:r.Q.COLOUR.white},{text:"Not yet started",value:"siteVisit",colour:r.Q.COLOUR.white},{text:"Closed",value:"canceled",colour:r.Q.COLOUR.black},{text:"Closed",value:"closed",colour:r.Q.COLOUR.black},{text:"On Hold",value:"onHold",colour:r.Q.COLOUR.help},{text:"In Progress",value:"continued",colour:r.Q.COLOUR.primary},{text:"Closed",value:"paused",colour:r.Q.COLOUR.black},{text:"Not yet offered",value:"quoteNew",colour:r.Q.COLOUR.muiGray},{text:"Offered",value:"quoteOffered",colour:r.Q.COLOUR.warning},{text:"Completed",value:"quoteReceived",colour:r.Q.COLOUR.secondary},{text:"Requires approval",value:"quoteSent",colour:r.Q.COLOUR.info},{text:"Not yet started",value:"quoteAccepted",colour:r.Q.COLOUR.white},{text:"Closed",value:"quoteRejected",colour:r.Q.COLOUR.black},{text:"Closed",value:"quoteCancelled",colour:r.Q.COLOUR.black},{text:"Closed",value:"quoteClosed",colour:r.Q.COLOUR.black},{text:"Not yet started",value:"ppmNew",colour:r.Q.COLOUR.white}]},89077:function(e,t,n){"use strict";n.d(t,{FX:function(){return f},cj:function(){return d},jb:function(){return v}});var r=n(60092),o=n(72428),a=n(39010),i=n(78878),l=n(51984),s=n(4625),u=n(13761),c=n(85893),d={DONE:"done",NEW:"new",IN_PROGRESS:"inprogress",TO_DO:"todo",BLOCKED:"blocked"},p={URGENT:"urgent",HIGH:"high",NORMAL:"normal",LOW:"low"},v=[{value:d.NEW,label:"New",icon:(0,c.jsx)(o.Z,{color:"white"}),color:r.Q.COLOUR.white,bgcolor:"#83BBDC"},{value:d.TO_DO,label:"To do",icon:(0,c.jsx)(a.Z,{color:"white"}),color:r.Q.COLOUR.white,bgcolor:r.Q.COLOUR.secondary},{value:d.IN_PROGRESS,label:"In progress",icon:(0,c.jsx)(i.Z,{color:"white"}),color:r.Q.COLOUR.white,bgcolor:r.Q.COLOUR.info},{value:d.DONE,label:"Done",icon:(0,c.jsx)(l.Z,{color:"white"}),color:r.Q.COLOUR.white,bgcolor:r.Q.COLOUR.success},{value:d.BLOCKED,label:"Blocked",icon:(0,c.jsx)(s.Z,{color:"white"}),color:r.Q.COLOUR.white,bgcolor:r.Q.COLOUR.danger}],f=[{value:p.URGENT,label:"Urgent",icon:(0,c.jsx)(u.Z,{color:"danger"})},{value:p.HIGH,label:"High",icon:(0,c.jsx)(u.Z,{color:"info"})},{value:p.NORMAL,label:"Normal",icon:(0,c.jsx)(u.Z,{color:"secondary"})},{value:p.LOW,label:"Low",icon:(0,c.jsx)(u.Z,{color:"muiGray"})}]},21634:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return tO}});var r,o,a,i,l,s,u,c,d,p,v=n(59499),f=n(16835),m=n(42846),g=n(67294),x=n(32836),h=n(26447),b=n(11057),y=n(90629),j=n(15861),w=n(26143),O=n(6812),T=n(50319),C=n(35137),k=n(32715),q=n(81261),P=n(24770),Z=n(50029),S=n(64687),I=n.n(S),_=n(84808),D=n(98456),$=n(5616),R=n(86886),L=n(50135),E=n(69661),A=n(90948),Q=n(67720),U=n(93946),W=n(67432),F=n(42283),N=n(40075),G=n(6103),M=n(30381),V=n.n(M),B=n(89077),H=n(69368),z=n(77010),J=n(33754),Y=n(72936),X=n(1950),K=n(49908),ee=n(33366),et=[{label:"Active",value:"active"},{label:"Inactive",value:"inactive"}],en=[{label:"Job status changes",value:"jobStatusChanges"},{label:"Quote status changes",value:"quoteStatusChanges"},{label:"Date is",value:"dateIs"}],er={jobStatusChanges:ee.yW,quoteStatusChanges:ee.iz},eo=[{label:"Reactive",value:"reactive"},{label:"PPM",value:"ppm"}],ea=[{label:"Account manager is",value:"accountManager"},{label:"Priority is",value:"priority"},{label:"Customer is",value:"customer"},{label:"Supplier is",value:"supplier"},{label:"Location is",value:"location"},{label:"Short job description is",value:"shortJobDescription"},{label:"Service is",value:"service"},{label:"Job date is",value:"jobDateIs"},{label:"Job type is",value:"jobTypeIs"},{label:"Job status is",value:"jobStatusIs"}],ei=[{label:"Every",value:"every"},{label:"First",value:"first"},{label:"Second",value:"second"},{label:"Third",value:"third"},{label:"Fourth",value:"fourth"},{label:"Last",value:"last"}],el=[{label:"Day",value:"day"},{label:"Monday",value:"monday"},{label:"Tuesday",value:"tuesday"},{label:"Wednesday",value:"wednesday"},{label:"Thursday",value:"thursday"},{label:"Friday",value:"friday"},{label:"Saturday",value:"saturday"},{label:"Sunday",value:"sunday"},{label:"Weekday",value:"weekday"},{label:"Weekend day",value:"weekend"}],es=[{label:"Week",value:"week"},{label:"Month",value:"month"},{label:"Year",value:"year"}],eu=[{label:"today",value:"today"},{label:"tomorrow",value:"tomorrow"},{label:"yesterday",value:"yesterday"},{label:"last 7 days",value:"lastSevenDays"},{label:"last month",value:"lastMonth"},{label:"last 30 days",value:"lastThirtyDays"},{label:"last 90 days",value:"lastNinetyDays"},{label:"last year",value:"lastYear"},{label:"in next 7 days",value:"inNextSevenDays"},{label:"in this month",value:"inThisMonth"},{label:"in next month",value:"inNextMonth"},{label:"in next 30 days",value:"inNextThirtyDays"},{label:"in next 90 days",value:"inNextNinetyDays"},{label:"in next year",value:"inNextYear"}],ec=[{label:"Create a task",value:"createTask"},{label:"Send an email",value:"sendEmail"}],ed=[{label:"Admin",value:"admin"},{label:"Customer",value:"customer"},{label:"Supplier",value:"supplier"},{label:"Tenant",value:"tenant"},{label:"Specific email address",value:"customEmail"}],ep=[{value:"jobNumber",label:"Job ID"},{value:"jobType",label:"Job type"},{value:"invoiceNumber",label:"Invoice number"},{value:"invoiceType",label:"Invoice type"},{value:"invoiceStatus",label:"Invoice status"},{value:"invoiceAmount",label:"Invoice amount"},{value:"outstandingDays",label:"Outstanding days"},{value:"customerName",label:"Customer"},{value:"customerManagerName",label:"Account Manager"},{value:"supplierName",label:"Supplier"},{value:"locationName",label:"Location"},{value:"addressMainName",label:"Address"},{value:"addressMainPostCode",label:"Post code"},{value:"addressInvoiceName",label:"Invoice address"},{value:"sublocationName",label:"Sublocation"},{value:"jobPriority",label:"Priority"},{value:"jobStatus",label:"Status"},{value:"jobTotal",label:"Job total"},{value:"dueFromCustomer",label:"Due from customer"},{value:"outstandingAmount",label:"Outstanding amount"},{value:"jobNetRevenue",label:"Net revenue"},{value:"supplierAmount",label:"Supplier total"},{value:"jobExpensesCustomer",label:"Expenses (Customer)"},{value:"jobExpensesSupplier",label:"Expenses (Supplier)"},{value:"jobServiceName",label:"Service line"},{value:"jobDate",label:"Job date"},{value:"jobReference",label:"Customer reference"},{value:"jobDescription",label:"Job description"},{value:"jobShortDescription",label:"Issue reported"},{value:"jobSource",label:"Source"},{value:"jobCostCategory",label:"Cost category"},{value:"adminUser",label:"Assigned to (Admin)"},{value:"customerUser",label:"Assigned to (Customer)"},{value:"supplierUser",label:"Assigned to (Supplier)"},{value:"jobCreatedAtDate",label:"Job created"},{value:"jobCreatedBy",label:"Created by"},{value:"jobPaidDate",label:"Paid date"},{value:"jobCompletedDate",label:"Completed date"},{value:"jobInvoicedDate",label:"Invoice date"},{value:"jobClosedDate",label:"Closed date"}],ev=[{value:"daysAfterTriggerDay",label:"Days after trigger day"},{value:"onTriggerDate",label:"On trigger date"},{value:"chooseDate",label:"Choose a date"}],ef=[{value:"customer",label:"Customer"},{value:"supplier",label:"Supplier"},{value:"location",label:"Location"},{value:"job",label:"Quote or work order id"},{value:"externalURL",label:"External URL"}],em=n(6911),eg=n(76301),ex=n(85893);function eh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function eb(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eh(Object(n),!0).forEach(function(t){(0,v.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eh(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var ey=function(e){var t,n,r,o=e.workflowId,a=e.register,i=e.watch,l=e.setValue,s=e.control,u=e.errors,c=(0,g.useState)(""),d=c[0],p=c[1],v=(0,Y.x)().user,f=i("taskTemplate.workflowTags"),m=i("taskTemplate.relatedLinks"),x=i("taskTemplate.dueDateType"),b=i("taskTemplate.relatedLinksType"),y=(0,O.a)(eg.yR,{variables:{accountId:v.adminId,q:""!==d?"%".concat(d,"%"):null,limit:50,offset:0}}),w=y.loading,T=y.data,C=(T=void 0===T?{items:[]}:T).items;return(0,ex.jsx)(ex.Fragment,{children:(0,ex.jsxs)(h.Z,{direction:"column",spacing:3,pb:3,children:[(0,ex.jsx)(F.Qr,{control:s,name:"taskTemplate.title",render:function(e){var t,n,r,o=e.value,a=e.onChange;return(0,ex.jsx)(L.Z,{variant:"standard",color:"secondary",label:"Title",value:o,onChange:a,error:null===(t=u.taskTemplate)||void 0===t?void 0:t.title,helperText:null===(n=u.taskTemplate)||void 0===n?void 0:null===(r=n.title)||void 0===r?void 0:r.message,sx:{mt:"0 !important"}})}}),(0,ex.jsx)(F.Qr,{control:s,name:"taskTemplate.content",render:function(e){var t,n,r,o=e.value,a=e.onChange;return(0,ex.jsx)(L.Z,{multiline:!0,minRows:8,variant:"filled",color:"secondary",label:"Content",value:o,onChange:a,error:null===(t=u.taskTemplate)||void 0===t?void 0:t.content,helperText:null===(n=u.taskTemplate)||void 0===n?void 0:null===(r=n.content)||void 0===r?void 0:r.message})}}),(0,ex.jsx)(F.Qr,{control:s,name:"taskTemplate.priority",render:function(e){var t,n,r,o=e.value,a=e.onChange;return(0,ex.jsx)(z.E,{label:"Priority:",labelLeft:!0,stackProps:{direction:"row",flexWrap:"wrap"},options:B.FX,value:o,onChange:a,error:null===(t=u.taskTemplate)||void 0===t?void 0:t.priority,helperText:null===(n=u.taskTemplate)||void 0===n?void 0:null===(r=n.priority)||void 0===r?void 0:r.message})}}),(0,ex.jsx)(F.Qr,{control:s,name:"taskTemplate.dueDateType",defaultValue:null,render:function(e){var t,n,r,o=e.value,a=e.onChange;return(0,ex.jsx)(W.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=u.taskTemplate)||void 0===t?void 0:t.dueDateType,helperText:null===(n=u.taskTemplate)||void 0===n?void 0:null===(r=n.dueDateType)||void 0===r?void 0:r.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Due date",value:o,onChange:a,options:ev||[]})}}),"daysAfterTriggerDay"===x&&(0,ex.jsx)(F.Qr,{control:s,name:"taskTemplate.dueDateDaysAfterTriggerDay",render:function(e){var t,n,r,o=e.value,a=e.onChange;return(0,ex.jsx)(L.Z,{type:"number",placeholder:"Enter number of days",color:"secondary",variant:"standard",value:o,onChange:a,error:null===(t=u.taskTemplate)||void 0===t?void 0:t.dueDateDaysAfterTriggerDay,helperText:null===(n=u.taskTemplate)||void 0===n?void 0:null===(r=n.dueDateDaysAfterTriggerDay)||void 0===r?void 0:r.message})}}),"chooseDate"===x&&(0,ex.jsx)(F.Qr,{control:s,name:"taskTemplate.dueDateChooseDate",defaultValue:null,render:function(e){var t=e.value,n=e.onChange;return(0,ex.jsx)(J.M,{label:"Due date",inputFormat:"Do MMM YYYY",minDate:V()(),value:t,onChange:n,renderInput:function(e){var t,n,r;return(0,ex.jsx)(L.Z,eb(eb({},e),{},{color:"secondary",variant:"standard",error:null===(t=u.taskTemplate)||void 0===t?void 0:t.dueDateChooseDate,helperText:null===(n=u.taskTemplate)||void 0===n?void 0:null===(r=n.dueDateChooseDate)||void 0===r?void 0:r.message}))}})}}),(0,ex.jsx)(F.Qr,{name:"taskTemplate.assignedUser",control:s,render:function(e){var t,n,r,o=e.value,a=e.onChange;return(0,ex.jsx)(em.q,{value:o,onChange:function(e,t){return a(t)},loading:w,options:C,setSearch:p,isOptionEqualToValue:function(e,t){return e.value===t.value},textFieldProps:{color:"secondary",variant:"standard",label:"Assigned to",error:null===(t=u.taskTemplate)||void 0===t?void 0:t.assignedUser,helperText:null===(n=u.taskTemplate)||void 0===n?void 0:null===(r=n.assignedUser)||void 0===r?void 0:r.message}})}}),(0,ex.jsx)(h.Z,{direction:"row",width:"100%",alignItems:"center",children:(0,ex.jsx)(K.n,{entityId:o,entity:"Workflow",name:"taskTemplate.workflowTags",values:f,setValue:l})}),(0,ex.jsx)("input",eb(eb({},a("taskTemplate.workflowTags")),{},{type:"hidden"})),(0,ex.jsx)(F.Qr,{name:"taskTemplate.relatedLinksType",control:s,render:function(e){var t=e.value,n=e.onChange;return(0,ex.jsx)(em.q,{multiple:!0,value:t||[],onChange:function(e,t){return n(t)},options:ef,color:"secondary",textFieldProps:{color:"secondary",variant:"standard",label:"Select link type"},sx:{width:"100%"},isOptionEqualToValue:function(e,t){return e.value===t.value},renderOption:function(e,t,n){var r=n.selected;return(0,g.createElement)("li",eb(eb({},e),{},{key:t.value}),(0,ex.jsx)(H.Z,{color:"secondary",style:{height:10,marginRight:8},checked:r}),t.label)}})}}),(null==b?void 0:b.some(function(e){return"externalURL"===e.value}))&&(0,ex.jsxs)($.Z,{children:[(0,ex.jsx)(X.V,{values:m,setValue:l,name:"taskTemplate.relatedLinks"}),(0,ex.jsx)("input",eb(eb({},a("taskTemplate.relatedLinks")),{},{type:"hidden"})),(null===(t=u.taskTemplate)||void 0===t?void 0:t.relatedLinks)&&(null==m?void 0:m.length)===0&&(0,ex.jsx)(j.Z,{variant:"subtitle2",color:"warning.main",children:null===(n=u.taskTemplate)||void 0===n?void 0:null===(r=n.relatedLinks)||void 0===r?void 0:r.message})]})]})})};ey.defaultProps={register:function(){return{}},watch:function(){},setValue:function(){},control:{},errors:{}};var ej=n(79665),ew=n(74231),eO=ew.Ry({title:ew.Z_().required("Title is required field"),status:ew.Z_().oneOf(et.map(function(e){return e.value})).required("Status is required field"),action:ew.Z_().when("trigger.type",{is:"dateIs",then:ew.Z_().oneOf(["sendEmail"],"Invalid action").required("Action is required"),otherwise:ew.Z_().oneOf(ec.map(function(e){return e.value}),"Invalid action").required("Action is required")}),trigger:ew.Ry({type:ew.Z_().oneOf(en.map(function(e){return e.value})).required("Trigger is required field"),from:ew.Z_().when(["type"],function(e,t){var n;return"jobStatusChanges"===e||"quoteStatusChanges"===e?t.oneOf(null===(n=er[e])||void 0===n?void 0:n.map(function(e){return e.value})).required("From status is required field"):t}),to:ew.Z_().when(["type"],function(e,t){var n;return"jobStatusChanges"===e||"quoteStatusChanges"===e?t.oneOf(null===(n=er[e])||void 0===n?void 0:n.map(function(e){return e.value})).notOneOf([ew.iH("from")],'To status must be different from "From" status').required("To status is required field"):t}),frequency:ew.Z_().when(["type"],function(e,t){return"dateIs"===e?t.oneOf(ei.map(function(e){return e.value})).required("Frequency is required field"):t}),daysIn:ew.Z_().when(["type"],function(e,t){return"dateIs"===e?t.oneOf(el.map(function(e){return e.value})).required("Day is required field"):t}),inThePeriod:ew.Z_().when(["type"],function(e,t){return"dateIs"===e?t.oneOf(es.map(function(e){return e.value})).required("Period is required field"):t}),jobType:ew.IX().when(["type"],function(e,t){return"jobStatusChanges"===e?t.of(ew.Z_().oneOf(eo.map(function(e){return e.value})).required("Job type is required field")).required("Job type is required field"):t})}),condition:ew.IX().of(ew.Ry({type:ew.Ry({value:ew.Z_().required("Condition type is required field"),label:ew.Z_().required("Condition type is required field")}).required("Condition type is required field").typeError("Condition type is required field"),value:ew.Ry({value:ew.Z_().required("Condition value is required field"),label:ew.Z_().required("Condition value is required field")}).required("Condition value is required field").typeError("Condition value is required field")})),taskTemplate:ew.nK().when("action",{is:"createTask",then:ew.Ry({title:ew.Z_().required("Title is required"),content:ew.Z_().required("Content is required"),priority:ew.Z_().oneOf(B.FX.map(function(e){return e.value})).required("Priority is required"),dueDateType:ew.Z_().oneOf(ev.map(function(e){return e.value})).required("Due date type is required").typeError("Due date type is required"),dueDateDaysAfterTriggerDay:ew.nK().when("dueDateType",{is:"daysAfterTriggerDay",then:ew.Rx().integer("Days after trigger day must be an integer").min(0,"Days after trigger day must be greater than or equal to 0").required("Days after trigger day is required")}),dueDateChooseDate:ew.hT().when("dueDateType",{is:"chooseDate",then:ew.hT().required("Due date is required")}),assignedUser:ew.Ry().shape({value:ew.Z_().required(),label:ew.Z_().required()}).required("Assigned user is required").typeError("Assigned user is required"),workflowTags:ew.IX().of(ew.Ry().shape({id:ew.Rx().integer().nullable(),tag:ew.Ry().shape({id:ew.Rx().integer().required(),name:ew.Z_().required()}).required()})),relatedLinksType:ew.IX().of(ew.Ry().shape({value:ew.Z_().oneOf(ef.map(function(e){return e.value})).required(),label:ew.Z_().required()})),relatedLinks:ew.nK().when("relatedLinksType",{is:function(e){return(null==e?void 0:e.length)>0&&e.some(function(e){return"externalURL"===e.value})},then:ew.IX().of(ew.Ry().shape({name:ew.Z_().required("Title is required"),url:ew.Z_().url("Invalid URL").required("URL is required")})).min(1,"Related links is required").required("Related links is required")})})}),emailTemplate:ew.nK().when("action",{is:"sendEmail",then:ew.Ry({sendToCategory:ew.Z_().oneOf(ed.map(function(e){return e.value})).required("Send to category is required"),sendTo:ew.nK().when("sendToCategory",{is:"customEmail",then:ew.Z_().email("Invalid email address").required("Email is required"),otherwise:ew.IX().of(ew.Ry({value:ew.Rx().integer().required("Value is required field"),label:ew.Z_().required("Label is required field")})).required("Send to is required")}),subject:ew.Z_().required("Subject is required"),content:ew.Z_().required("Content is required"),buttonTitle:ew.Z_().required("Button title is required"),buttonLink:ew.Z_().url("Invalid URL").required("Button link is required"),columns:ew.IX().of(ew.Ry({value:ew.Z_().required("Value is required field"),label:ew.Z_().required("Label is required field")})),sendToTestEmail:ew.Z_().when("$sendTestEmailIsRequired",{is:!0,then:ew.Z_().email("Invalid email address").required("Email is required")})})})}),eT=n(20320);function eC(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function ek(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eC(Object(n),!0).forEach(function(t){(0,v.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eC(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var eq=function(e){var t=e.control,n=e.errors,r=e.watch,o=e.setValue,a=e.reset,i=["jobStatusChanges","quoteStatusChanges"],l=r("action"),s=r("trigger.type"),u=r("trigger.from"),c=r("trigger.to"),d=(0,g.useMemo)(function(){return en.filter(function(e){var t=e.value;return"sendEmail"===l?"dateIs"===t:void 0===l||"dateIs"!==t})},[l]),p=(0,g.useMemo)(function(){var e,t;return null===(e=er[s])||void 0===e?void 0:null===(t=e.filter(function(e){return e.value!==c}))||void 0===t?void 0:t.map(function(e){var t;return{label:e.text,value:e.value}})},[s,c]),v=(0,g.useMemo)(function(){var e,t;return null===(e=er[s])||void 0===e?void 0:null===(t=e.filter(function(e){return e.value!==u}))||void 0===t?void 0:t.map(function(e){var t;return{label:e.text,value:e.value}})},[s,u]);return(0,ex.jsx)(eP,{sx:{pt:1,pb:2,pr:2,pl:2},children:(0,ex.jsxs)(h.Z,{direction:"row",alignItems:"center",width:"100%",children:[(0,ex.jsxs)(h.Z,{spacing:1,width:"100%",children:[(0,ex.jsx)(F.Qr,{name:"trigger.type",control:t,render:function(e){var t,r,a,i=e.value,l=e.onChange;return(0,ex.jsx)(W.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.trigger)||void 0===t?void 0:t.type,helperText:null===(r=n.trigger)||void 0===r?void 0:null===(a=r.type)||void 0===a?void 0:a.message},selectProps:{fullWidth:!0},label:"Select trigger",value:i,onChange:function(e){o("trigger.from",""),o("trigger.to",""),l(e)},options:d||[]})}}),!!i.includes(s)&&(0,ex.jsxs)(h.Z,{direction:"row",alignItems:"flex-end",width:"100%",children:[(0,ex.jsx)(j.Z,{sx:{fontWeight:700,mb:"5px",mr:"24px"},children:"From"}),(0,ex.jsx)(F.Qr,{name:"trigger.from",control:t,render:function(e){var t,r,o,a=e.value,i=e.onChange;return(0,ex.jsx)(W.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.trigger)||void 0===t?void 0:t.from,helperText:null===(r=n.trigger)||void 0===r?void 0:null===(o=r.from)||void 0===o?void 0:o.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Select status",value:a,onChange:i,options:p||[]})}})]}),!!i.includes(s)&&(0,ex.jsxs)(h.Z,{direction:"row",alignItems:"flex-end",width:"100%",children:[(0,ex.jsx)(j.Z,{sx:{fontWeight:700,mb:"5px",mr:"40px"},children:"To"}),(0,ex.jsx)(F.Qr,{name:"trigger.to",control:t,render:function(e){var t,r,o,a=e.value,i=e.onChange;return(0,ex.jsx)(W.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.trigger)||void 0===t?void 0:t.to,helperText:null===(r=n.trigger)||void 0===r?void 0:null===(o=r.to)||void 0===o?void 0:o.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Select status",value:a,onChange:i,options:v||[]})}})]}),"dateIs"===s&&(0,ex.jsxs)(h.Z,{direction:"row",alignItems:"baseline",width:"100%",spacing:2,children:[(0,ex.jsx)(F.Qr,{name:"trigger.frequency",control:t,render:function(e){var t,r,o,a=e.value,i=e.onChange;return(0,ex.jsx)(W.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.trigger)||void 0===t?void 0:t.frequency,helperText:null===(r=n.trigger)||void 0===r?void 0:null===(o=r.frequency)||void 0===o?void 0:o.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Repeat",value:a,onChange:i,options:ei||[]})}}),(0,ex.jsx)(F.Qr,{name:"trigger.daysIn",control:t,render:function(e){var t,r,o,a=e.value,i=e.onChange;return(0,ex.jsx)(W.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.trigger)||void 0===t?void 0:t.daysIn,helperText:null===(r=n.trigger)||void 0===r?void 0:null===(o=r.daysIn)||void 0===o?void 0:o.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Day",value:a,onChange:i,options:el||[]})}}),(0,ex.jsx)(j.Z,{sx:{textWrap:"nowrap"},children:"in the"}),(0,ex.jsx)(F.Qr,{name:"trigger.inThePeriod",control:t,render:function(e){var t,r,o,a=e.value,i=e.onChange;return(0,ex.jsx)(W.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.trigger)||void 0===t?void 0:t.inThePeriod,helperText:null===(r=n.trigger)||void 0===r?void 0:null===(o=r.inThePeriod)||void 0===o?void 0:o.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Period",value:a,onChange:i,options:es||[]})}})]}),"jobStatusChanges"===s&&(0,ex.jsx)(F.Qr,{name:"trigger.jobType",control:t,render:function(e){var t,r,o,a=e.value,i=e.onChange;return(0,ex.jsx)(W.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.trigger)||void 0===t?void 0:t.jobType,helperText:null===(r=n.trigger)||void 0===r?void 0:null===(o=r.jobType)||void 0===o?void 0:o.message,fullWidth:!0},selectComponent:"checkbox",selectProps:{fullWidth:!0,multiple:!0},label:"Select job type",value:a||[],onChange:function(e){var t=e.target.value;i("string"==typeof t?t.split(","):t)},options:eo||[]})}})]}),(0,ex.jsx)(h.Z,{children:(0,ex.jsx)(U.Z,{sx:{mb:"-8px"},onClick:function(){a(ek(ek({},r()),{},{trigger:{type:"",from:"",to:"",frequency:"",daysIn:"",inThePeriod:"",jobType:[]},condition:[]}))},children:(0,ex.jsx)(eT.Z,{sx:{color:"danger.main"}})})})]})})};eq.defaultProps={errors:{}};var eP=(0,A.ZP)(y.Z)(function(){return{borderRadius:"12px",boxShadow:"0px 3px 3px -2px rgba(0,0,0,0.2),\n  0px 0px 4px 0px rgba(0,0,0,0.14),\n  0px 1px 8px 0px rgba(0,0,0,0.12)"}}),eZ={"jobStatusChanges-reactive":"reactive",quoteStatusChanges:"quote"},eS={"jobStatusChanges-reactive":["jobTypeIs","jobStatusIs"],"jobStatusChanges-ppm":["priority","jobTypeIs","jobStatusIs"],quoteStatusChanges:["jobTypeIs","jobStatusIs"],dateIs:[]},eI=function(e){var t=e.index,n=e.field,r=e.control,o=e.errors,a=e.watch,i=e.remove,l=(0,Y.x)().user,s=(0,g.useState)(""),u=s[0],c=s[1],d=a("trigger.type"),p=a("trigger.jobType"),v=a("condition[".concat(t,"].type")),f=(0,g.useMemo)(function(){return ea.filter(function(e){var t=e.value,n=eS["".concat(d).concat(p?"-"+p:"")];return!(null!=n&&n.includes(t))})},[d,p]),m=(0,g.useMemo)(function(){return eZ["".concat(d).concat(p?"-"+p:"")]},[d,p]),x=(0,O.a)(eg.yR,{skip:(null==v?void 0:v.value)!=="accountManager",variables:{accountId:l.adminId,limit:50,offset:0}}),b=x.loading,y=x.data,j=(y=void 0===y?{items:[]}:y).items,w=(0,O.a)(eg.SW,{skip:(null==v?void 0:v.value)!=="customer",variables:{q:""!==u?"%".concat(u,"%"):null,limit:50,offset:0}}),T=w.loading,C=w.data,k=(C=void 0===C?{items:[]}:C).items,q=(0,O.a)(eg._d,{skip:(null==v?void 0:v.value)!=="location",variables:{where:{name:{_ilike:""!==u?"%".concat(u,"%"):null},status:{_eq:"active"}},limit:50,offset:0}}),P=q.loading,Z=q.data,S=(Z=void 0===Z?{items:[]}:Z).items,I=(0,O.a)(eg.by,{skip:(null==v?void 0:v.value)!=="supplier",variables:{where:{name:{_ilike:""!==u?"%".concat(u,"%"):null},type:{_eq:"supplier"}},limit:50,offset:0}}),_=I.loading,D=I.data,$=(D=void 0===D?{items:[]}:D).items,R=(0,O.a)(eg.T_,{skip:(null==v?void 0:v.value)!=="priority"&&!m,variables:{where:{name:{_ilike:""!==u?"%".concat(u,"%"):null},subtype:{_eq:m}},limit:50,offset:0}}),L=R.loading,E=R.data,A=(E=void 0===E?{items:[]}:E).items,Q=(0,O.a)(eg._f,{skip:(null==v?void 0:v.value)!=="shortJobDescription",variables:{where:{name:{_ilike:""!==u?"%".concat(u,"%"):null},status:{_eq:"active"},type:{_eq:"jobTags"}},orderBy:{name:"asc"},limit:50,offset:0}}),W=Q.loading,N=Q.data,G=(N=void 0===N?{items:[]}:N).items,M=(0,O.a)(eg.kx,{skip:(null==v?void 0:v.value)!=="service",variables:{q:""!==u?"%".concat(u,"%"):null,limit:50,offset:0}}),V=M.loading,B=M.data,H=(B=void 0===B?{items:[]}:B).items,z=(0,g.useCallback)(function(){if(!(null!=v&&v.value))return[];switch(v.value){case"priority":return A;case"accountManager":return j;case"customer":return k;case"supplier":return $;case"location":return S;case"shortJobDescription":return G;case"service":return H;case"jobDateIs":return eu;case"jobTypeIs":return eo;case"jobStatusIs":return er.jobStatusChanges.map(function(e){var t;return{label:e.text,value:e.value}})}},[null==v?void 0:v.value,A,j,k,$,S,G,H]);return(0,ex.jsx)(e_,{sx:{pt:1,pb:2,pr:2,pl:2},children:(0,ex.jsxs)(h.Z,{width:"100%",spacing:1,children:[(0,ex.jsxs)(h.Z,{width:"100%",direction:"row",alignItems:"center",children:[(0,ex.jsx)(F.Qr,{defaultValue:null==n?void 0:n.type,name:"condition[".concat(t,"].type"),control:r,render:function(e){var n,r,a,i,l,s,u,d,p,v=e.value,m=e.onChange;return(0,ex.jsx)(em.q,{fullWidth:!0,color:"secondary",value:v,onChange:function(e,t){c(""),m(t)},isOptionEqualToValue:function(e,t){return e.value===t.value},options:f,textFieldProps:{label:"Condition",variant:"standard",color:"secondary",error:null===(n=o.condition)||void 0===n?void 0:null===(r=n[t])||void 0===r?void 0:r.type,helperText:(null===(a=o.condition)||void 0===a?void 0:null===(i=a[t])||void 0===i?void 0:null===(l=i.type)||void 0===l?void 0:l.message)||(null===(s=o.condition)||void 0===s?void 0:null===(u=s[t])||void 0===u?void 0:null===(d=u.type)||void 0===d?void 0:null===(p=d.value)||void 0===p?void 0:p.message)}})}}),(0,ex.jsx)(U.Z,{sx:{mb:"-8px"},onClick:function(){return i(t)},children:(0,ex.jsx)(eT.Z,{sx:{color:"danger.main"}})})]}),!!v&&(0,ex.jsx)(F.Qr,{defaultValue:null==n?void 0:n.value,name:"condition[".concat(t,"].value"),control:r,render:function(e){var n,r,a,i,l,s,u,d,p,f=e.value,m=e.onChange;return(0,ex.jsx)(em.q,{color:"secondary",filterSelectedOptions:!0,loading:b||T||P||_||L||W||V,value:f,onChange:function(e,t){m(t)},isOptionEqualToValue:function(e,t){return e.value===t.value},options:z(),setSearch:c,textFieldProps:{label:"Select ".concat(null==v?void 0:v.label),variant:"standard",color:"secondary",error:null===(n=o.condition)||void 0===n?void 0:null===(r=n[t])||void 0===r?void 0:r.value,helperText:(null===(a=o.condition)||void 0===a?void 0:null===(i=a[t])||void 0===i?void 0:null===(l=i.value)||void 0===l?void 0:l.message)||(null===(s=o.condition)||void 0===s?void 0:null===(u=s[t])||void 0===u?void 0:null===(d=u.value)||void 0===d?void 0:null===(p=d.value)||void 0===p?void 0:p.message)}})}})]})})},e_=(0,A.ZP)(y.Z)(function(){return{borderRadius:"12px",boxShadow:"0px 3px 3px -2px rgba(0,0,0,0.2),\n  0px 0px 4px 0px rgba(0,0,0,0.14),\n  0px 1px 8px 0px rgba(0,0,0,0.12)"}}),eD=n(71383),e$=n(75063),eR=(0,e$.Ps)(r||(r=(0,eD.Z)(["\n  mutation CreateTaskWorkflow($data: jsonb!) {\n    createTaskWorkflow(data: $data) {\n      success\n      data\n    }\n  }\n"]))),eL=(0,e$.Ps)(o||(o=(0,eD.Z)(["\n  mutation CreateEmailWorkflow($data: jsonb!) {\n    createEmailWorkflow(data: $data) {\n      success\n      data\n    }\n  }\n"]))),eE=(0,e$.Ps)(a||(a=(0,eD.Z)(["\n  mutation UpdateTaskWorkflow($data: jsonb!) {\n    updateTaskWorkflow(data: $data) {\n      success\n      data\n    }\n  }\n"]))),eA=(0,e$.Ps)(i||(i=(0,eD.Z)(["\n  mutation UpdateEmailWorkflow($data: jsonb!) {\n    updateEmailWorkflow(data: $data) {\n      success\n      data\n    }\n  }\n"]))),eQ=(0,e$.Ps)(l||(l=(0,eD.Z)(["\n  mutation SnedTestEmailWorkflow($data: jsonb!) {\n    sendTestEmailWorkflow(data: $data) {\n      success\n      data\n    }\n  }\n"]))),eU=n(3084),eW=(0,e$.Ps)(s||(s=(0,eD.Z)(["\n  fragment WorkflowFields on Workflow {\n    id\n    status\n    title\n    action\n    fired\n    taskTemplate\n    emailTemplate\n    meta\n    createdAt\n    updatedAt\n    userId\n    adminId\n  }\n"]))),eF=(0,e$.Ps)(u||(u=(0,eD.Z)(["\n  fragment WorkflowConditionFields on WorkflowCondition {\n    id\n    isTrigger\n    trigger\n    condition\n    meta\n    createdAt\n    updatedAt\n    workflowId\n  }\n"]))),eN=(0,e$.Ps)(c||(c=(0,eD.Z)(['\n  query GetWorkflow($id: Int!) {\n    workflow: Workflow_by_pk(id: $id) {\n      ...WorkflowFields\n      conditions: WorkflowConditions {\n        ...WorkflowConditionFields\n      }\n      tags: Taxonomy(\n        where: {\n          entity: { _eq: "Workflow" }\n          Taxonomy: { status: { _eq: "active" }, type: { _eq: "taskTags" } }\n        }\n      ) {\n        id\n        tag: Taxonomy {\n          id\n          name\n          meta\n        }\n      }\n      user: User {\n        id\n        fullName\n      }\n    }\n  }\n  ',"\n  ","\n"])),eW,eF),eG=function(e){var t=e.tagsWhere;return(0,e$.Ps)(d||(d=(0,eD.Z)(["\n  query GetWorkflows(\n    $q: String\n    $status: workflow_status\n    $tags: [Int]\n    $limit: Int = 50\n    $offset: Int = 0\n    $orderBy: [Workflow_order_by!]\n  ) {\n    workflows: Workflow(\n      where: { title: { _ilike: $q }, status: { _eq: $status }, ",' }\n      limit: $limit\n      offset: $offset\n      order_by: $orderBy\n    ) {\n      ...WorkflowFields\n      conditions: WorkflowConditions {\n        ...WorkflowConditionFields\n      }\n      tags: Taxonomy(\n        where: {\n          entity: { _eq: "Workflow" }\n          Taxonomy: { status: { _eq: "active" }, type: { _eq: "tags" } }\n        }\n      ) {\n        id\n        tag: Taxonomy {\n          id\n          name\n          meta\n        }\n      }\n      user: User {\n        fullName\n      }\n    }\n    meta: Workflow_aggregate(\n      where: { title: { _ilike: $q }, status: { _eq: $status },  '," })\n      {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n\n  ","\n  ","\n"])),t,t,eW,eF)},eM=(0,e$.Ps)(p||(p=(0,eD.Z)(["\n  mutation DeleteWorkflow($workflowId: Int!) {\n    delete_Workflow_by_pk(id: $workflowId) {\n      id\n    }\n  }\n"]))),eV=function(e){var t=e.control,n=e.errors,r=(0,e.watch)("trigger.type"),o=(0,g.useMemo)(function(){return ec.filter(function(e){var t=e.value;return"dateIs"===r?"sendEmail"===t:"jobStatusChanges"!==r&&"quoteStatusChanges"!==r||"createTask"===t})},[r]);return(0,ex.jsx)(eB,{sx:{pt:1,pb:2,pr:2,pl:2},children:(0,ex.jsx)(h.Z,{width:"100%",spacing:1,children:(0,ex.jsx)(h.Z,{width:"100%",direction:"row",alignItems:"flex-end",children:(0,ex.jsx)(F.Qr,{name:"action",control:t,render:function(e){var t,r=e.value,a=e.onChange;return(0,ex.jsx)(W.P,{formControl:{variant:"standard",color:"secondary",error:n.action,helperText:null===(t=n.action)||void 0===t?void 0:t.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Select action",value:r,onChange:a,options:o})}})})})})},eB=(0,A.ZP)(y.Z)(function(){return{borderRadius:"12px",boxShadow:"0px 3px 3px -2px rgba(0,0,0,0.2),\n  0px 0px 4px 0px rgba(0,0,0,0.14),\n  0px 1px 8px 0px rgba(0,0,0,0.12)"}}),eH=n(21023),ez=(0,A.ZP)(Q.Z)(function(){return{width:"50%",height:"40px",borderRightWidth:"2px",borderStyle:"dashed"}}),eJ=n(74721);function eY(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function eX(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?eY(Object(n),!0).forEach(function(t){(0,v.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):eY(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var eK=function(e){e.register;var t=e.control,n=e.errors,r=e.watch,o=e.setValue,a=e.sendTestEmail,i=(0,Y.x)().user,l=(0,g.useState)(""),s=l[0],u=l[1],c=(0,g.useState)(""),d=c[0],p=c[1],v=r("emailTemplate.sendToCategory"),f=(0,O.a)(eg.qd,{skip:!v||"customEmail"===v||"admin"===v,variables:{q:""!==s?"%".concat(s,"%"):null,type:v,limit:50,offset:0}}),m=f.loading,x=f.data,y=(x=void 0===x?{items:[]}:x).items,w=(0,O.a)(eg.yR,{skip:"admin"!==v,variables:{q:""!==d?"%".concat(d,"%"):null,accountId:i.adminId,limit:50,offset:0}}),T=w.loading,C=w.data,k=(C=void 0===C?{items:[]}:C).items;return(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsx)(ez,{orientation:"vertical",variant:"middle"}),(0,ex.jsx)(e0,{sx:{pt:1,pb:2,pr:2,pl:2},children:(0,ex.jsxs)(h.Z,{spacing:1,children:[(0,ex.jsxs)(h.Z,{direction:"row",width:"100%",alignItems:"baseline",children:[(0,ex.jsx)(j.Z,{sx:{fontWeight:700,mb:"5px",mr:"24px",textWrap:"nowrap"},children:"Send to"}),(0,ex.jsx)(F.Qr,{name:"emailTemplate.sendToCategory",control:t,render:function(e){var t,r,a,i=e.value,l=e.onChange;return(0,ex.jsx)(W.P,{formControl:{variant:"standard",color:"secondary",error:null===(t=n.emailTemplate)||void 0===t?void 0:t.sendToCategory,helperText:null===(r=n.emailTemplate)||void 0===r?void 0:null===(a=r.sendToCategory)||void 0===a?void 0:a.message,fullWidth:!0},selectProps:{fullWidth:!0},label:"Select category",value:i,onChange:function(e){o("emailTemplate.sendTo",null),l(e.target.value)},options:ed||[]})}})]}),["customer","supplier","tenant"].includes(v)&&(0,ex.jsx)(F.Qr,{name:"emailTemplate.sendTo",control:t,render:function(e){var t,r,o,a=e.value,i=e.onChange;return(0,ex.jsx)(em.q,{multiple:!0,disableCloseOnSelect:!0,color:"secondary",filterSelectedOptions:!0,loading:m,value:Array.isArray(a)?a:[],onChange:function(e,t){i(t)},options:y,setSearch:u,textFieldProps:{label:"Select ".concat(v),variant:"standard",color:"secondary",error:null===(t=n.emailTemplate)||void 0===t?void 0:t.sendTo,helperText:null===(r=n.emailTemplate)||void 0===r?void 0:null===(o=r.sendTo)||void 0===o?void 0:o.message},isOptionEqualToValue:function(e,t){return e.value===t.value},renderOption:function(e,t,n){var r=n.selected;return(0,g.createElement)("li",eX(eX({},e),{},{key:t.value}),(0,ex.jsx)(H.Z,{color:"secondary",style:{height:10,marginRight:8},checked:r}),t.label)}})}}),"admin"===v&&(0,ex.jsx)(F.Qr,{name:"emailTemplate.sendTo",control:t,render:function(e){var t,r,o,a=e.value,i=e.onChange;return(0,ex.jsx)(em.q,{multiple:!0,disableCloseOnSelect:!0,color:"secondary",loading:T,value:Array.isArray(a)?a:[],onChange:function(e,t){i(t)},options:k,setSearch:p,textFieldProps:{label:"Select ".concat(v),variant:"standard",color:"secondary",error:null===(t=n.emailTemplate)||void 0===t?void 0:t.sendTo,helperText:null===(r=n.emailTemplate)||void 0===r?void 0:null===(o=r.sendTo)||void 0===o?void 0:o.message},isOptionEqualToValue:function(e,t){return e.value===t.value},renderOption:function(e,t,n){var r=n.selected;return(0,g.createElement)("li",eX(eX({},e),{},{key:t.value}),(0,ex.jsx)(H.Z,{color:"secondary",style:{height:10,marginRight:8},checked:r}),t.label)}})}}),"customEmail"===v&&(0,ex.jsx)(F.Qr,{name:"emailTemplate.sendTo",control:t,render:function(e){var t,r,o,a=e.value,i=e.onChange;return(0,ex.jsx)(L.Z,{color:"secondary",variant:"standard",label:"Specific email address",value:a,onChange:i,error:!!(null!==(t=n.emailTemplate)&&void 0!==t&&t.sendTo),helperText:null===(r=n.emailTemplate)||void 0===r?void 0:null===(o=r.sendTo)||void 0===o?void 0:o.message})}})]})}),(0,ex.jsx)(ez,{orientation:"vertical",variant:"middle"}),(0,ex.jsx)(e0,{sx:{pt:1,pb:2,pr:2,pl:2},children:(0,ex.jsxs)(h.Z,{spacing:4,children:[(0,ex.jsx)(F.Qr,{name:"emailTemplate.subject",control:t,render:function(e){var t,r,o,a=e.value,i=e.onChange;return(0,ex.jsx)(L.Z,{fullWidth:!0,color:"secondary",variant:"standard",label:"Subject",value:a,onChange:i,error:!!(null!==(t=n.emailTemplate)&&void 0!==t&&t.subject),helperText:null===(r=n.emailTemplate)||void 0===r?void 0:null===(o=r.subject)||void 0===o?void 0:o.message})}}),(0,ex.jsx)(F.Qr,{name:"emailTemplate.content",control:t,render:function(e){var t,r,o,a=e.value,i=e.onChange;return(0,ex.jsx)(L.Z,{fullWidth:!0,multiline:!0,minRows:6,color:"secondary",variant:"filled",label:"Content",value:a,onChange:i,error:!!(null!==(t=n.emailTemplate)&&void 0!==t&&t.content),helperText:null===(r=n.emailTemplate)||void 0===r?void 0:null===(o=r.content)||void 0===o?void 0:o.message})}}),(0,ex.jsxs)(h.Z,{spacing:1,children:[(0,ex.jsxs)(h.Z,{direction:"row",alignItems:"flex-end",spacing:1,children:[(0,ex.jsx)(F.Qr,{name:"emailTemplate.buttonTitle",control:t,render:function(e){var t,r,o,a=e.value,i=e.onChange;return(0,ex.jsx)(L.Z,{fullWidth:!0,color:"secondary",variant:"standard",label:"Button title",value:a,onChange:i,error:!!(null!==(t=n.emailTemplate)&&void 0!==t&&t.buttonTitle),helperText:null===(r=n.emailTemplate)||void 0===r?void 0:null===(o=r.buttonTitle)||void 0===o?void 0:o.message})}}),(0,ex.jsx)(eH.Z,eX(eX({title:"This is the text that will show on the button in the email.",placement:"left-end",leaveDelay:1500,arrow:!0},e1),{},{children:(0,ex.jsx)(U.Z,{size:"small",children:(0,ex.jsx)(eJ.Z,{color:"secondary"})})}))]}),(0,ex.jsxs)(h.Z,{direction:"row",alignItems:"flex-end",spacing:1,children:[(0,ex.jsx)(F.Qr,{name:"emailTemplate.buttonLink",control:t,render:function(e){var t,r,o,a=e.value,i=e.onChange;return(0,ex.jsx)(L.Z,{fullWidth:!0,color:"secondary",variant:"standard",label:"Button link",value:a,onChange:i,error:!!(null!==(t=n.emailTemplate)&&void 0!==t&&t.buttonLink),helperText:null===(r=n.emailTemplate)||void 0===r?void 0:null===(o=r.buttonLink)||void 0===o?void 0:o.message})}}),(0,ex.jsx)(eH.Z,eX(eX({title:"This is where the user will be directed upon clicking the button.",placement:"left-end",leaveDelay:1500,arrow:!0},e1),{},{children:(0,ex.jsx)(U.Z,{size:"small",children:(0,ex.jsx)(eJ.Z,{color:"secondary"})})}))]})]})]})}),(0,ex.jsx)(ez,{orientation:"vertical",variant:"middle"}),(0,ex.jsx)(e0,{sx:{pt:1,pb:2,pr:2,pl:2},children:(0,ex.jsxs)(h.Z,{spacing:1,children:[(0,ex.jsx)(j.Z,{variant:"h6",children:"Column selector"}),(0,ex.jsx)(j.Z,{children:"Select the columns you would like to see in the report"}),(0,ex.jsx)(Q.Z,{}),(0,ex.jsx)(F.Qr,{name:"emailTemplate.columns",control:t,render:function(e){var t=e.value,n=e.onChange;return(0,ex.jsx)(em.q,{multiple:!0,disableCloseOnSelect:!0,value:t||[],onChange:function(e,t){return n(t)},options:ep,color:"secondary",textFieldProps:{color:"secondary",variant:"standard",label:"Columns"},sx:{width:"100%"},isOptionEqualToValue:function(e,t){return e.value===t.value},renderOption:function(e,t,n){var r=n.selected;return(0,g.createElement)("li",eX(eX({},e),{},{key:t.value}),(0,ex.jsx)(H.Z,{color:"secondary",style:{height:10,marginRight:8},checked:r}),t.label)}})}})]})}),(0,ex.jsx)(ez,{orientation:"vertical",variant:"middle"}),(0,ex.jsx)(e0,{sx:{pt:1,pb:2,pr:2,pl:2},children:(0,ex.jsxs)(h.Z,{direction:"row",alignItems:"flex-end",spacing:2,children:[(0,ex.jsx)(F.Qr,{name:"emailTemplate.sendToTestEmail",control:t,render:function(e){var t,r,o,a=e.value,i=e.onChange;return(0,ex.jsx)(L.Z,{fullWidth:!0,color:"secondary",variant:"standard",label:"Send test email",error:!!(null!==(t=n.emailTemplate)&&void 0!==t&&t.sendToTestEmail),helperText:null===(r=n.emailTemplate)||void 0===r?void 0:null===(o=r.sendToTestEmail)||void 0===o?void 0:o.message,value:a,onChange:i})}}),(0,ex.jsx)(b.Z,{color:"secondary",variant:"contained",sx:{width:120},type:"submit",onClick:a,children:"Send test"})]})})]})};eK.defaultProps={sendTestEmail:function(){}};var e0=(0,A.ZP)(y.Z)(function(){return{borderRadius:"12px",boxShadow:"0px 3px 3px -2px rgba(0,0,0,0.2),\n  0px 0px 4px 0px rgba(0,0,0,0.14),\n  0px 1px 8px 0px rgba(0,0,0,0.12)"}}),e1={slotProps:{tooltip:{sx:{backgroundColor:"secondary.main"}},arrow:{sx:{color:"secondary.main"}}}},e2=function(e){var t,n;return{title:e.title,status:e.status,action:e.action,trigger:{type:e.trigger.type,from:e.trigger.from,to:e.trigger.to,jobType:e.trigger.jobType},conditions:null===(t=e.condition)||void 0===t?void 0:t.map(function(e){var t;return{type:e.type,value:e.value}}),taskTemplate:{status:"new",title:e.taskTemplate.title,content:e.taskTemplate.content,priority:e.taskTemplate.priority,dueDateType:e.taskTemplate.dueDateType,dueDateDaysAfterTriggerDay:e.taskTemplate.dueDateDaysAfterTriggerDay,dueDateChooseDate:e.taskTemplate.dueDateChooseDate,assignedUser:{value:e.taskTemplate.assignedUser.value,label:e.taskTemplate.assignedUser.label},relatedLinksType:e.taskTemplate.relatedLinksType,relatedLinks:e.taskTemplate.relatedLinks},tags:null===(n=e.taskTemplate.workflowTags)||void 0===n?void 0:n.map(function(e){return{entity:"Workflow",taxonomyId:e.tag.id}})}},e3=function(e){var t;return{title:e.title,status:e.status,action:e.action,trigger:{type:e.trigger.type,frequency:e.trigger.frequency,daysIn:e.trigger.daysIn,inThePeriod:e.trigger.inThePeriod},conditions:null===(t=e.condition)||void 0===t?void 0:t.map(function(e){var t;return{type:e.type,value:e.value}}),emailTemplate:{sendToCategory:e.emailTemplate.sendToCategory,sendTo:e.emailTemplate.sendTo,subject:e.emailTemplate.subject,content:e.emailTemplate.content,buttonTitle:e.emailTemplate.buttonTitle,buttonLink:e.emailTemplate.buttonLink,columns:e.emailTemplate.columns}}},e4=function(e){var t;return{title:e.title,status:e.status,action:e.action,trigger:{type:e.trigger.type,from:e.trigger.from,to:e.trigger.to,jobType:e.trigger.jobType},conditions:null===(t=e.condition)||void 0===t?void 0:t.map(function(e){var t;return{type:e.type,value:e.value}}),taskTemplate:{status:"new",title:e.taskTemplate.title,content:e.taskTemplate.content,priority:e.taskTemplate.priority,dueDateType:e.taskTemplate.dueDateType,dueDateDaysAfterTriggerDay:e.taskTemplate.dueDateDaysAfterTriggerDay,dueDateChooseDate:e.taskTemplate.dueDateChooseDate,assignedUser:{value:e.taskTemplate.assignedUser.value,label:e.taskTemplate.assignedUser.label},relatedLinksType:e.taskTemplate.relatedLinksType,relatedLinks:e.taskTemplate.relatedLinks}}},e6=function(e){var t;return{title:e.title,status:e.status,action:e.action,trigger:{type:e.trigger.type,frequency:e.trigger.frequency,daysIn:e.trigger.daysIn,inThePeriod:e.trigger.inThePeriod},conditions:null===(t=e.condition)||void 0===t?void 0:t.map(function(e){var t;return{type:e.type,value:e.value}}),emailTemplate:{sendToCategory:e.emailTemplate.sendToCategory,sendTo:e.emailTemplate.sendTo,subject:e.emailTemplate.subject,content:e.emailTemplate.content,buttonTitle:e.emailTemplate.buttonTitle,buttonLink:e.emailTemplate.buttonLink,columns:e.emailTemplate.columns}}},e5=function(e){var t;return{sendToTestEmail:e.emailTemplate.sendToTestEmail,title:e.title,status:e.status,action:e.action,trigger:{type:e.trigger.type,frequency:e.trigger.frequency,daysIn:e.trigger.daysIn,inThePeriod:e.trigger.inThePeriod},conditions:null===(t=e.condition)||void 0===t?void 0:t.map(function(e){var t;return{type:e.type,value:e.value}}),emailTemplate:{sendToCategory:e.emailTemplate.sendToCategory,sendTo:e.emailTemplate.sendTo,subject:e.emailTemplate.subject,content:e.emailTemplate.content,buttonTitle:e.emailTemplate.buttonTitle,buttonLink:e.emailTemplate.buttonLink,columns:e.emailTemplate.columns}}};function e9(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function e8(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?e9(Object(n),!0).forEach(function(t){(0,v.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):e9(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var e7=function(e){var t,n,r=e.workflowId,o=e.close,a=(0,eU.D)(),i=(0,g.useState)(!1),l=i[0],s=i[1],u=(0,F.cI)({defaultValues:{status:"active",taskTemplate:{status:"new",priority:"urgent",workflowTags:[],relatedLinks:[]}},context:{sendTestEmailIsRequired:l},resolver:(0,ej.S)(eO)}),c=u.handleSubmit,d=u.register,p=u.watch,v=u.setValue,m=u.reset,x=u.control,y=u.errors,w=(0,F.Dq)({control:x,name:"condition"}),C=w.fields,k=w.append,q=w.remove,P=(0,O.a)(eN,{skip:!r,variables:{id:r},onCompleted:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{workflow:{}},r=n.workflow,o=(null===(e=r.conditions)||void 0===e?void 0:e.find(function(e){return e.isTrigger}))||{},a=(null===(t=r.conditions)||void 0===t?void 0:t.filter(function(e){return!e.isTrigger}))||[];m({title:r.title,status:r.status,action:r.action,trigger:o.trigger,condition:a.map(function(e){return{type:e.condition.type,value:e.condition.value}}),taskTemplate:e8(e8({},r.taskTemplate||{}),{},{workflowTags:r.tags}),emailTemplate:e8({},r.emailTemplate||{})})}}).loading,S=(0,T.D)(eR,{refetchQueries:["GetWorkflow","GetWorkflows"],onError:function(e){a.show({content:"Error: ".concat(e.message),color:"error"})},onCompleted:function(){a.show({content:"Workflow was created"}),o()}}),A=(0,f.Z)(S,2),Q=A[0],U=A[1].loading,M=(0,T.D)(eL,{refetchQueries:["GetWorkflow","GetWorkflows"],onError:function(e){a.show({content:"Error: ".concat(e.message),color:"error"})},onCompleted:function(){a.show({content:"Workflow was created"}),o()}}),V=(0,f.Z)(M,2),B=V[0],H=V[1].loading,z=(0,T.D)(eE,{refetchQueries:["GetWorkflow","GetWorkflows"],onError:function(e){a.show({content:"Error: ".concat(e.message),color:"error"})},onCompleted:function(){a.show({content:"Workflow was updated"}),o()}}),J=(0,f.Z)(z,2),Y=J[0],X=J[1].loading,K=(0,T.D)(eA,{refetchQueries:["GetWorkflow","GetWorkflows"],onError:function(e){a.show({content:"Error: ".concat(e.message),color:"error"})},onCompleted:function(){a.show({content:"Workflow was updated"}),o()}}),ee=(0,f.Z)(K,2),en=ee[0],er=ee[1].loading,eo=(0,T.D)(eQ,{onError:function(e){a.show({content:"Error: ".concat(e.message),color:"error"})},onCompleted:function(){a.show({content:"Email was sent"})}}),ea=(0,f.Z)(eo,2),ei=ea[0],el=ea[1].loading,es=(t=(0,Z.Z)(I().mark(function e(t){var n,o,a,i;return I().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r){e.next=13;break}e.t0=t.action,e.next="createTask"===e.t0?4:"sendEmail"===e.t0?7:10;break;case 4:return n=e2(t),Q({variables:{data:n}}),e.abrupt("break",11);case 7:return o=e3(t),B({variables:{data:o}}),e.abrupt("break",11);case 10:return e.abrupt("break",11);case 11:e.next=23;break;case 13:e.t1=t.action,e.next="createTask"===e.t1?16:"sendEmail"===e.t1?19:22;break;case 16:return a=e4(t),Y({variables:{data:e8(e8({},a),{},{workflowId:r})}}),e.abrupt("break",23);case 19:return i=e6(t),en({variables:{data:e8(e8({},i),{},{workflowId:r})}}),e.abrupt("break",23);case 22:return e.abrupt("break",23);case 23:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),eu=(n=(0,Z.Z)(I().mark(function e(t){var n;return I().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=e5(t),ei({variables:{data:n}});case 2:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}),ec=p("trigger.type"),ed=p("action");return(0,ex.jsxs)(ex.Fragment,{children:[(P||U||H||X||er||el)&&(0,ex.jsx)(_.Z,{sx:{zIndex:1e5},open:!0,children:(0,ex.jsx)(D.Z,{color:"secondary"})}),(0,ex.jsx)("form",{onSubmit:c(l?eu:es),children:(0,ex.jsx)(te,{children:(0,ex.jsxs)(h.Z,{height:"100%",width:"100%",spacing:2,children:[(0,ex.jsx)($.Z,{sx:{pl:1,pr:1},children:(0,ex.jsxs)(R.ZP,{container:!0,columnSpacing:2,children:[(0,ex.jsx)(R.ZP,{item:!0,xs:9,children:(0,ex.jsx)(F.Qr,{name:"title",control:x,render:function(e){var t,n=e.value,r=e.onChange;return(0,ex.jsx)(L.Z,{fullWidth:!0,color:"secondary",variant:"standard",label:"Title",value:n,onChange:r,error:y.title,helperText:null===(t=y.title)||void 0===t?void 0:t.message,InputLabelProps:{shrink:""!==n&&void 0!==n}})}})}),(0,ex.jsx)(R.ZP,{item:!0,xs:3,children:(0,ex.jsx)(F.Qr,{name:"status",control:x,render:function(e){var t,n=e.value,r=e.onChange;return(0,ex.jsx)(W.P,{formControl:{variant:"standard",color:"secondary",error:y.status,helperText:null===(t=y.status)||void 0===t?void 0:t.message},selectProps:{fullWidth:!0},label:"Status",value:n,onChange:r,options:et})}})})]})}),(0,ex.jsxs)(R.ZP,{container:!0,sx:{height:"100%",overflow:"auto",p:1},children:[(0,ex.jsxs)(R.ZP,{item:!0,xs:5.5,children:[(0,ex.jsx)(to,{sx:{pt:1,pb:1,pr:2,pl:2},children:(0,ex.jsxs)(h.Z,{direction:"row",alignItems:"center",spacing:2,children:[(0,ex.jsx)(E.Z,{src:"/static/logo/icon-white.png"}),(0,ex.jsxs)(h.Z,{children:[(0,ex.jsx)(j.Z,{variant:"h6",sx:{lineHeight:1},children:"When"}),(0,ex.jsx)(j.Z,{sx:{color:"#757575"},children:"This happens"})]})]})}),(0,ex.jsx)(ez,{orientation:"vertical",variant:"middle"}),(0,ex.jsx)(eq,{control:x,errors:y,watch:p,setValue:v,reset:m,remove:q}),C.map(function(e,t){return(0,ex.jsxs)("div",{children:[(0,ex.jsx)(ez,{orientation:"vertical",variant:"middle"}),(0,ex.jsx)(eI,{index:t,field:e,control:x,errors:y,watch:p,remove:q})]},e.id)}),(0,ex.jsxs)(h.Z,{width:"100%",heigth:"100%",children:[(0,ex.jsx)(ez,{orientation:"vertical",variant:"middle"}),(0,ex.jsx)(tr,{disabled:!ec,onClick:function(){return k({type:null,value:null})},children:(0,ex.jsx)(G.Z,{sx:{alignSelf:"center"}})})]})]}),(0,ex.jsx)(R.ZP,{item:!0,xs:1,children:(0,ex.jsx)(tt,{orientation:"vertical",children:(0,ex.jsx)(tn,{children:(0,ex.jsx)(N.Z,{})})})}),(0,ex.jsxs)(R.ZP,{item:!0,xs:5.5,children:[(0,ex.jsx)(to,{sx:{pt:1,pb:1,pr:2,pl:2},children:(0,ex.jsxs)(h.Z,{direction:"row",alignItems:"center",spacing:2,children:[(0,ex.jsx)(E.Z,{src:"/static/logo/icon-white.png"}),(0,ex.jsxs)(h.Z,{children:[(0,ex.jsx)(j.Z,{variant:"h6",sx:{lineHeight:1},children:"Then"}),(0,ex.jsx)(j.Z,{sx:{color:"#757575"},children:"Do the following"})]})]})}),(0,ex.jsx)(ez,{orientation:"vertical",variant:"middle"}),(0,ex.jsx)(eV,{control:x,errors:y,watch:p}),"createTask"===ed&&(0,ex.jsxs)(ex.Fragment,{children:[(0,ex.jsx)(ez,{orientation:"vertical",variant:"middle"}),(0,ex.jsx)(to,{sx:{pt:1,pb:1,pr:2,pl:2},children:(0,ex.jsx)(ey,{workflowId:r,register:d,watch:p,setValue:v,control:x,errors:y})})]}),"sendEmail"===ed&&(0,ex.jsx)(eK,{workflowId:r,register:d,watch:p,setValue:v,control:x,errors:y,sendTestEmail:function(){s(!0)}})]})]}),(0,ex.jsxs)(h.Z,{width:"100%",direction:"row",justifyContent:"center",spacing:2,children:[(0,ex.jsx)(b.Z,{variant:"outlined",color:"black",size:"medium",onClick:o,children:"Cancel"}),(0,ex.jsx)(b.Z,{variant:"contained",color:"secondary",size:"medium",type:"submit",onClick:function(){s(!1)},children:r?"Update":"Create"})]})]})})})]})};e7.defaultProps={close:function(){}};var te=(0,A.ZP)(y.Z)(function(){return{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"90vw",height:"90vh",padding:"35px 27px 16px 27px",borderRadius:"8px"}}),tt=(0,A.ZP)(Q.Z)(function(){return{display:"flex",alignItems:"center"}}),tn=(0,A.ZP)("div")(function(){return{display:"flex",justifyContent:"center",alignItems:"center",width:"50px",height:"50px",borderRadius:"50%",border:"1px solid #949494","& .MuiSvgIcon-root":{width:"70%",height:"70%",fill:"#949494"}}}),tr=(0,A.ZP)(U.Z)(function(){return{alignSelf:"center",display:"flex",alignItems:"center",justifyContent:"center",width:"25px",height:"25px",borderRadius:"4px",padding:0,boxShadow:"0px 3px 3px -2px rgba(0,0,0,0.2),\n  0px 0px 4px 0px rgba(0,0,0,0.14),\n  0px 1px 8px 0px rgba(0,0,0,0.12)","&.Mui-disabled":{cursor:"not-allowed",pointerEvents:"unset"},"& .MuiSvgIcon-root":{width:"100%",height:"100%",fill:"#949494"}}}),to=(0,A.ZP)(y.Z)(function(){return{borderRadius:"12px",boxShadow:"0px 3px 3px -2px rgba(0,0,0,0.2),\n  0px 0px 4px 0px rgba(0,0,0,0.14),\n  0px 1px 8px 0px rgba(0,0,0,0.12)"}}),ta=n(11994),ti=n(3896),tl=n(15050);function ts(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function tu(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ts(Object(n),!0).forEach(function(t){(0,v.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ts(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var tc=function(e){var t=e.open,n=e.close,r=e.initialFilters,o=e.setFilters,a=(0,ti.X)("form_data_".concat(r.filterType),r),i=(0,f.Z)(a,2),l=i[0],s=i[1],u=(0,F.cI)({defaultValues:l}),c=u.control,d=u.handleSubmit,p=u.reset,v=u.getValues,m=function(e){try{var t,r,a={q:e.search?"%".concat(e.search,"%"):null,status:e.status,tags:(null===(t=e.tags)||void 0===t?void 0:t.length)>0?null===(r=e.tags)||void 0===r?void 0:r.map(function(e){return e.value}):null},i=v();o(function(e){return tu(tu({},e),a)}),s(function(e){return tu(tu({},e),i)})}finally{n()}},g=function(){o(r),p(r),s(r),n()};return(0,ex.jsx)(ta.Z,{open:t,onClose:n,keepMounted:!0,children:(0,ex.jsx)("form",{onSubmit:d(m),children:(0,ex.jsx)(tp,{children:(0,ex.jsxs)(R.ZP,{container:!0,rowGap:4,columnSpacing:4,children:[(0,ex.jsx)(R.ZP,{item:!0,xs:12,children:(0,ex.jsx)(F.Qr,{control:c,name:"search",render:function(e){var t=e.value,n=e.onChange;return(0,ex.jsx)(L.Z,{fullWidth:!0,label:"Title",variant:"standard",color:"secondary",value:t,onChange:n})}})}),(0,ex.jsx)(R.ZP,{item:!0,xs:12,xs2:6,children:(0,ex.jsx)(F.Qr,{control:c,name:"status",render:function(e){var t=e.value,n=e.onChange;return(0,ex.jsx)(W.P,{label:"Status",value:t,onChange:n,options:td,formControl:{fullWidth:!0,variant:"standard",color:"secondary"},selectProps:{fullWidth:!0}})}})}),(0,ex.jsx)(R.ZP,{item:!0,xs:12,xs2:6,children:(0,ex.jsx)(tl.r,{control:c})}),(0,ex.jsx)(R.ZP,{container:!0,item:!0,xs:12,children:(0,ex.jsxs)(h.Z,{width:"100%",direction:"row",justifyContent:"flex-end",spacing:2,children:[(0,ex.jsx)(b.Z,{variant:"contained",color:"danger",onClick:g,children:"Cancel"}),(0,ex.jsx)(b.Z,{variant:"contained",color:"secondary",type:"submit",children:"Search"})]})})]})})})})},td=[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"}],tp=(0,A.ZP)(y.Z)(function(){return{position:"absolute",left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:"100vw",maxWidth:"600px",maxHeight:"100vh",padding:"16px",borderRadius:"8px",overflow:"auto"}}),tv=n(87918),tf=function(e){var t=e.conditions,n=(0,g.useMemo)(function(){return t.find(function(e){return e.isTrigger})},[t]),r=(0,g.useMemo)(function(){return t.filter(function(e){return!e.isTrigger})},[t]),o=(0,g.useCallback)(function(e){var t=e.trigger,n=(en.find(function(e){return e.value===t.type})||{label:""}).label;switch(t.type){case"jobStatusChanges":case"quoteStatusChanges":var r=er[t.type].find(function(e){return e.value===t.from}),o=er[t.type].find(function(e){return e.value===t.to});return"When ".concat(n.toLowerCase()," from ").concat(r.text," to ").concat(o.text);case"dateIs":var a=ei.find(function(e){return e.value===t.frequency}),i=el.find(function(e){return e.value===t.daysIn}),l=es.find(function(e){return e.value===t.inThePeriod});return"When ".concat(n.toLowerCase(),"\n        ").concat(a.label.toLowerCase(),"\n        ").concat(i.label.toLowerCase()," in\n        ").concat(l.label.toLowerCase())}},[]),a=(0,g.useCallback)(function(e){var t=e.type;return(ea.find(function(e){return e.value===t.value})||{label:""}).label},[]);return(0,ex.jsxs)(ex.Fragment,{children:[!!n&&(0,ex.jsx)(tv.Z,{label:"".concat(o(n)),sx:{mr:1}}),r.map(function(e){return(0,ex.jsx)(tv.Z,{label:"".concat(a(e.condition)," ").concat(e.condition.value.label),sx:{mr:1}})})]})};tf.defaultProps={conditions:[]};var tm=n(46353);function tg(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}var tx=function(e){var t=e.initialFilters,n=e.containerHeight,r=e.tableHeight,o=(0,k.d)(),a=(0,f.Z)(o,2),i=a[0],l=a[1],s=(0,eU.D)(),u=(0,g.useState)(!1),c=u[0],d=u[1],p=(0,g.useState)(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tg(Object(n),!0).forEach(function(t){(0,v.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tg(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},t)),Z=p[0],S=p[1],I=(0,m.x)({filters:Z}),_=I.initialData,D=I.ref,$=(0,tm.Y)(_.tags,"Workflow"),R=(0,O.a)(eG({tagsWhere:$}),{variables:_}),L=R.data,E=(L=void 0===L?{workflows:[],meta:{aggregate:{totalCount:0}}}:L).workflows,A=L.meta,Q=R.loading,U=R.refetch,W=(0,T.D)(eM,{refetchQueries:["GetWorkflow","GetWorkflows"],onError:function(e){s.show({content:"Error: ".concat(e.message),color:"error"})},onCompleted:function(){s.show({content:"Workflow was deleted"}),close()}}),F=(0,f.Z)(W,1)[0],N=(0,g.useCallback)(function(e){var t=e.workflowId;l({content:function(e){var n=e.onClose;return(0,ex.jsx)(e7,{workflowId:t,close:n})}})},[l]),G=(0,g.useCallback)(function(e){return[{icon:"edit",onClick:function(t){t.stopPropagation(),N({workflowId:e.id})},tooltip:"Edit"},{icon:"delete",onClick:function(t){t.stopPropagation(),F({variables:{workflowId:e.id}})},tooltip:"Delete"}]},[F,N]),M=(0,g.useMemo)(function(){return[{flex:1,field:"title",headerName:"Title"},{sortable:!1,flex:1,field:"conditions",headerName:"Trigger",renderCell:function(e){var t=e.row;return(0,ex.jsx)(tf,{conditions:t.conditions})}},{sortable:!1,flex:1,field:"tags",headerName:"Tags",renderCell:function(e){var t=e.row;return"sendEmail"!==t.action?(0,ex.jsx)(P.K,{row:t,entity:"Workflow",refetchQueries:["GetWorkflows"]}):null}},{flex:1,field:"fired",headerName:"Fired"},{flex:1,field:"createdBy",headerName:"Created by",sortName:'{"User": {"fullName": "ORDER"}}'},{flex:1,field:"createdAt",headerName:"Created at"},{flex:1,field:"status",headerName:"Status"},{width:50,field:"actions",headerName:"Actions",sortable:!1,renderCell:function(e){var t=e.row;return(0,ex.jsx)(w.C,{row:t,actionsData:G})}}]},[G]),B=(0,g.useMemo)(function(){return E.map(function(e){return{id:e.id,title:e.title,conditions:e.conditions,tags:e.tags,fired:e.fired,createdBy:e.user.fullName,createdAt:V()(e.createdAt).format("YYYY-MM-DD"),status:e.status,action:e.action}})},[E]),H=function(e){e.stopPropagation(),l({content:function(e){var t=e.onClose;return(0,ex.jsx)(e7,{close:t})}})};return(0,ex.jsxs)(ex.Fragment,{children:[i,(0,ex.jsx)(tc,{open:c,close:function(){return d(!1)},initialFilters:t,filters:Z,setFilters:S}),(0,ex.jsxs)(h.Z,{width:"100%",spacing:2,children:[(0,ex.jsxs)(h.Z,{direction:"row",justifyContent:"space-between",children:[(0,ex.jsx)(b.Z,{variant:"contained",startIcon:(0,ex.jsx)(q.Z,{}),onClick:function(){return d(!0)},children:"Filters"}),(0,ex.jsx)(b.Z,{variant:"contained",color:"secondary",onClick:H,children:"Add Automation"})]}),(0,ex.jsxs)(y.Z,{sx:{paddingTop:"16px",paddingBottom:"16px",height:n},children:[!!(null!=B&&B.length)&&(0,ex.jsx)(h.Z,{direction:"row",justifyContent:"space-between",children:(0,ex.jsx)(j.Z,{ml:2,variant:"h5",sx:{fontWeight:600},children:"Automation"})}),null!=B&&B.length?(0,ex.jsx)(x.i,{autoHeight:!1,loading:Q,ref:D,columns:M,rows:B,meta:A,refetch:U,onRowClick:function(e){return N({workflowId:e.row.id})},containerHeight:r}):!Q&&(0,ex.jsx)(C.C,{imageSrc:"/static/icons/no_automations_found.svg",title:"Create your first automation",subtitleFirstLine:"Task automations help you stay on top of work;\n              streamline your workflow",subtitleSecondLine:"processes and integrate with other apps\n              for increased productivity.",buttonText:"Add Automation",onAction:H})]})]})]})};tx.defaultProps={initialFilters:{},containerHeight:"calc(100vh - 86px)",tableHeight:"calc(100% - 32px)"};var th=n(38033),tb=n(55863),ty=n(11163),tj=n.n(ty),tw=function(){var e,t,n=(0,tb.q)();return(null==n?void 0:null===(e=n.admin)||void 0===e?void 0:null===(t=e.modules)||void 0===t?void 0:t.workflows)?(0,ex.jsx)(tx,{initialFilters:{filterType:"workflow_table"}}):(tj().push("/404"),null)};tw.getLayout=function(e){return(0,ex.jsx)(th.Z,{children:e})};var tO=tw},29325:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/workflows",function(){return n(21634)}])}},function(e){e.O(0,[3662,2283,212,8890,619,1100,4135,5020,6043,4244,3911,3776,2329,778,1023,4253,3148,8062,7328,6344,8476,3328,8033,26,9774,2888,179],function(){return e(e.s=29325)}),_N_E=e.O()}]);