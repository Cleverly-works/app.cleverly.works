(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1052],{58969:function(e,n,t){"use strict";t.d(n,{k:function(){return j}});var r=t(59499),o=t(42283),i=t(79665),a=t(76600),c=t(9270),s=t(62140),u=t(49501),d=t(55563),l=t(6710),p=t(95103),f=t(74231),m=(0,f.Ry)().shape({name:(0,f.Z_)(),invoicingEntity:(0,f.Z_)(),addressLine1:(0,f.Z_)().required(),addressLine2:(0,f.Z_)(),addressLine3:(0,f.Z_)(),city:(0,f.Z_)().required(),postCode:(0,f.Z_)().matches("^([Gg][Ii][Rr] 0[Aa]{2})|((([A-Za-z][0-9]{1,2})|(([A-Za-z][A-Ha-hJ-Yj-y][0-9]{1,2})|(([A-Za-z][0-9][A-Za-z])|([A-Za-z][A-Ha-hJ-Yj-y][0-9][A-Za-z]?))))\\s?[0-9][A-Za-z]{2})$|^([AC-FHKNPRTV-Y]\\d{2}|D6W)\\s[0-9AC-FHKNPRTV-Y]{4}$").required(),county:(0,f.Z_)(),countryId:(0,f.Z_)().required()}),v=t(92264),h=t(77329),g=t(85893);function b(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function y(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?b(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):b(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var j=function(e){var n=e.defaultValues,t=(e.onCancel,e.onSubmit),r=e.type,f=(0,o.cI)({defaultValues:y({},n),resolver:(0,i.S)(m)}),b=f.control,j=f.errors,x=f.handleSubmit,O={control:b,errors:j,register:f.register};return(0,g.jsxs)(a.Z,{id:"offCanvasForm",handleSubmit:x(t),children:[(0,g.jsxs)(c.Z,{children:[(0,g.jsx)(s.Z,{md:12,children:(0,g.jsx)(u.Z,{label:"Address name",children:(0,g.jsx)(d.Z,y(y({},O),{},{name:"name"}))})}),"invoice"===r&&(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(s.Z,{md:12,children:(0,g.jsx)(u.Z,{label:"invoicing email",children:(0,g.jsx)(d.Z,y(y({},O),{},{name:"invoicingEmail",type:"email"}))})}),(0,g.jsx)(s.Z,{md:12,children:(0,g.jsx)(u.Z,{label:"Invoicing entity",children:(0,g.jsx)(l.Z,y(y({},O),{},{name:"invoicingEntity",rows:4}))})})]}),(0,g.jsx)(s.Z,{md:6,children:(0,g.jsx)(u.Z,{label:"Address Line 1",children:(0,g.jsx)(d.Z,y(y({},O),{},{name:"addressLine1"}))})}),(0,g.jsx)(s.Z,{md:6,children:(0,g.jsx)(u.Z,{label:"Address Line 2",children:(0,g.jsx)(d.Z,y(y({},O),{},{name:"addressLine2"}))})}),(0,g.jsx)(s.Z,{md:6,children:(0,g.jsx)(u.Z,{label:"Address Line 3",children:(0,g.jsx)(d.Z,y(y({},O),{},{name:"addressLine3"}))})}),(0,g.jsx)(s.Z,{md:6,children:(0,g.jsx)(u.Z,{label:"City",children:(0,g.jsx)(d.Z,y(y({},O),{},{name:"city"}))})}),(0,g.jsx)(s.Z,{md:6,children:(0,g.jsx)(u.Z,{label:"Post Code",children:(0,g.jsx)(d.Z,y(y({},O),{},{name:"postCode"}))})}),(0,g.jsx)(s.Z,{md:6,children:(0,g.jsx)(u.Z,{label:"County",children:(0,g.jsx)(d.Z,y(y({},O),{},{name:"county"}))})}),(0,g.jsx)(s.Z,{md:6,children:(0,g.jsx)(u.Z,{label:"Country",children:(0,g.jsx)(p.Z,y(y({},O),{},{name:"countryId",options:h.O}))})})]}),(0,g.jsx)(c.Z,{justify:"end",children:(0,g.jsx)(s.Z,{md:12,children:(0,g.jsx)(v.H,{content:"Submit",type:"submit"})})}),(null==n?void 0:n.id)&&(0,g.jsx)(d.Z,y(y({},O),{},{name:"id",type:"hidden"})),(null==n?void 0:n.meta)&&(0,g.jsx)(d.Z,y(y({},O),{},{name:"meta",type:"hidden"}))]})}},6911:function(e,n,t){"use strict";t.d(n,{q:function(){return m}});var r=t(59499),o=t(4730),i=t(23776),a=t(87918),c=t(50135),s=t(98456),u=t(67294),d=t(85893),l=["loading","setSearch","textFieldProps"];function p(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function f(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?p(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):p(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var m=function(e){var n=e.loading,t=e.setSearch,r=e.textFieldProps,p=(0,o.Z)(e,l),m=(0,u.useState)(""),v=m[0],h=m[1];return(0,u.useEffect)(function(){var e=setTimeout(function(){t(v)},500);return function(){return clearTimeout(e)}},[v,t]),(0,d.jsx)(i.Z,f(f({},p),{},{loading:n,onInputChange:function(e,n){h(n)},getOptionLabel:function(e){return e.label},renderTags:function(e,n){return e.map(function(e,t){return(0,d.jsx)(a.Z,f({size:"small",label:e.label},n({index:t})))})},renderInput:function(e){return(0,d.jsx)(c.Z,f(f(f({},e),r),{},{InputProps:f(f(f({},e.InputProps),r.InputProps||{}),{},{endAdornment:(0,d.jsxs)(d.Fragment,{children:[n?(0,d.jsx)(s.Z,{color:"inherit",size:20}):null,e.InputProps.endAdornment]})})}))}}))};m.defaultProps={color:"secondary",onChange:function(){},options:[],onOpen:function(){},setSearch:function(){},textFieldProps:{}}},92264:function(e,n,t){"use strict";t.d(n,{H:function(){return u}});var r=t(59499),o=t(55377),i=t(16551),a=t(77439),c=t(85893);function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}var u=function(e){var n=e.children,t=e.content,u=e.context,d=e.data,l=e.disabled,p=e.handleClick,f=e.size,m=e.type;return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(o.Z,{size:"sm"}),(0,c.jsxs)(i.Z,{align:"flex-end",children:[n,(0,c.jsx)(a.Z,function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({content:t,context:u,disabled:l,onClick:p,size:f,type:m},d))]})]})};u.defaultProps={content:"Add",context:"secondary",disabled:!1,size:"sm",type:"button"}},34197:function(e,n,t){"use strict";t.d(n,{E:function(){return r}});var r=function(e,n){if(Array.isArray(n)){var t,r=null;return n.forEach(function(n){var t,o=null==e?void 0:null===(t=e.timings)||void 0===t?void 0:t.find(function(e){return e.status===n});r=(null==o?void 0:o.createdAt)||r}),r}var o=null==e?void 0:null===(t=e.timings)||void 0===t?void 0:t.find(function(e){return e.status===n});return(null==o?void 0:o.createdAt)||null}},9164:function(e,n,t){"use strict";t.d(n,{r:function(){return d}});var r=t(59499),o=t(41664),i=t.n(o),a=t(23795),c=t(85893);function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var d=function(e){var n=e.children,t=e.href,r=e.noWrap,o=e.target,s=e.sx,d=void 0===s?{}:s;return r?(0,c.jsx)(c.Fragment,{children:n}):t?(0,c.jsx)(i(),{href:t,target:o,passHref:!0,children:(0,c.jsx)(a.Z,u(u({sx:d},e),{},{children:n}))}):(0,c.jsx)(a.Z,u(u({sx:d},e),{},{children:n}))};d.defaultProps={onClick:function(e){e.stopPropagation()}}},86385:function(e,n,t){"use strict";t.d(n,{V:function(){return K}});var r,o=t(16835),i=t(59499),a=t(67294),c=t(30381),s=t.n(c),u=t(11163),d=t.n(u),l=t(57460),p=t.n(l),f=t(6812),m=t(73359),v=t(71383),h=(0,t(75063).Ps)(r||(r=(0,v.Z)(['\n  query GetLocations(\n    $accountId: Int\n    $limit: Int\n    $offset: Int\n    $q: String\n    $orderBy: Location_order_by!\n  ) {\n    properties: Location(\n      limit: $limit\n      offset: $offset\n      order_by: [$orderBy]\n      where: {\n        Account_Locations: {\n          accountId: { _eq: $accountId }\n          Account: { type: { _eq: "customer" } }\n        }\n        _or: [\n          { name: { _ilike: $q } }\n          { Addresses: { Address: { city: { _ilike: $q } }, entity: { _eq: "Location" } } }\n          { Addresses: { Address: { postCode: { _ilike: $q } }, entity: { _eq: "Location" } } }\n        ]\n      }\n    ) {\n      id\n      access\n      contactUserId\n      createdAt\n      name\n      status\n      addresses: Addresses(where: { entity: { _eq: "Location" }, registered: { _eq: true } }) {\n        id\n        status\n        address: Address {\n          id\n          name\n          addressLine1\n          postCode\n        }\n      }\n      customer: Account_Locations {\n        id\n        account: Account {\n          id\n          name\n        }\n      }\n      compliances: Compliances(\n        where: { entity: { _eq: "Location" } }\n        order_by: { expiryAt: asc }\n      ) {\n        id\n        expiryAt\n        compliance: Compliance {\n          id\n          name\n        }\n      }\n      bookings: Jobs(\n        where: { Invoices: { invoiceType: { _in: ["customerVat", "ProformaInvoiceCustomer"] } } }\n      ) {\n        id\n        Invoices {\n          AccountEntry {\n            balance\n          }\n        }\n      }\n      invoices: Invoice(where: { invoiceType: { _eq: "customerPPM" } }) {\n        AccountEntry {\n          balance\n        }\n      }\n      user: User {\n        id\n        fullName\n      }\n    }\n    meta: Location_aggregate(\n      where: {\n        Account_Locations: {\n          accountId: { _eq: $accountId }\n          Account: { type: { _eq: "customer" } }\n        }\n        _or: [\n          { name: { _ilike: $q } }\n          { Addresses: { Address: { city: { _ilike: $q } }, entity: { _eq: "Location" } } }\n          { Addresses: { Address: { postCode: { _ilike: $q } }, entity: { _eq: "Location" } } }\n        ]\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n']))),g=t(9164),b=t(61730),y=t(5616),j=t(93946),x=t(26447),O=t(11057),Z=t(98456),w=t(90629),P=t(15861),S=t(2548),C=t(81261),I=t(19958),_=t(32836),A=t(42283),k=t(50135),D=t(90948),L=t(11994),q=t(6911),M=t(3896),$=t(76301),E=t(85893);function N(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function F(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?N(Object(t),!0).forEach(function(n){(0,i.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):N(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var U=function(e){var n=e.initialFilters,t=e.filters,r=e.setFilters,i=e.open,c=e.onClose,s=(0,u.useRouter)().query,d=(0,b.Z)("(max-width: 400px)"),l=(0,a.useMemo)(function(){return(null==s?void 0:s.tab)==="locations"},[s]),p=(0,M.X)("form_data_".concat(n.filterType).concat(l?"_".concat(n.accountId):""),n),f=(0,o.Z)(p,2),v=f[0],h=f[1],g=(0,a.useState)(),y=g[0],j=g[1],Z=(0,A.cI)({defaultValues:v}),P=Z.control,S=Z.handleSubmit,C=Z.register,I=Z.reset,_=Z.errors,D=(0,m.t)($.SW,{variables:{where:{name:{_ilike:""!==y?"%".concat(y,"%"):null}}}}),L=(0,o.Z)(D,2),N=L[0],U=L[1],R=U.loading,z=U.data,G=(z=void 0===z?{items:[]}:z).items,H=function(){r(n),I(),c(),h(F(F({},n),{},{filterType:n.filterType}))},V=function(e){var o,i=F(F(F({},t),e),{},{accountId:l?n.accountId:null===(o=e.customer)||void 0===o?void 0:o.value,q:e.q});r(F(F({},i),{},{q:e.q?"%".concat(e.q,"%"):null})),h(F(F({},i),{},{customer:l?null:e.customer,filterType:n.filterType})),I(),c()};return(0,E.jsx)(T,{open:i,onClose:c,children:(0,E.jsx)(w.Z,{sx:{minWidth:d?"300px":"400px",padding:"20px 40px"},children:(0,E.jsxs)("form",{onSubmit:S(V),children:[(0,E.jsxs)(x.Z,{spacing:l?8:4,children:[(0,E.jsx)(k.Z,{fullWidth:!0,variant:"standard",color:"secondary",label:"Search...",name:"q",inputRef:C}),!l&&(0,E.jsx)(A.Qr,{name:"customer",control:P,render:function(e){var n,t=e.value,r=e.onChange;return(0,E.jsx)(q.q,{limitTags:6,color:"secondary",value:t,onChange:function(e,n){return r(n)},label:"Select customer",loading:R,onOpen:function(){return N()},options:G,setSearch:j,textFieldProps:{label:"Select customer",variant:"standard",color:"secondary",error:_.customer,helperText:null===(n=_.customer)||void 0===n?void 0:n.message}})}})]}),(0,E.jsxs)(x.Z,{width:"100%",direction:"row",justifyContent:"flex-end",spacing:2,sx:{margin:"20px 0"},children:[(0,E.jsx)(O.Z,{variant:"contained",color:"danger",onClick:function(){return H()},children:"Cancel"}),(0,E.jsx)(O.Z,{variant:"contained",color:"secondary",type:"submit",children:"Search"})]})]})})})},T=(0,D.ZP)(L.Z)(function(){return{display:"flex",justifyContent:"center",alignItems:"center",width:"100%",height:"100%"}}),R=t(45110),z=t(42846),G=t(48829),H=t(94568),V=t(35137),B=t(58095);function W(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function J(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?W(Object(t),!0).forEach(function(n){(0,i.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):W(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var Y=function(e){return s()(e).format("YYYY-MM-DD")},X=function(e,n){var t;return(null==e?void 0:e.reduce(function(e,n){var t;return e+(null==n?void 0:null===(t=n.Invoices)||void 0===t?void 0:t.reduce(function(e,n){var t;return e+(null==n?void 0:null===(t=n.AccountEntry)||void 0===t?void 0:t.balance)||0},0))||0},0))+(null==n?void 0:n.reduce(function(e,n){var t;return e+(null==n?void 0:null===(t=n.AccountEntry)||void 0===t?void 0:t.balance)||0},0))},K=function(e){var n,t=e.accountId,r=e.accountName,i=e.initialFilters,c=e.columnVisibilityModel,s=e.tableContainerHeight,u=(0,a.useState)(!1),l=u[0],v=u[1],A=(0,a.useState)(!1),k=A[0],D=A[1],L=(0,a.useState)(J({},i)),q=L[0],M=L[1],$=(0,z.x)({filters:q}),N=$.initialData,F=$.ref,T=(0,B.a)(),W=(0,b.Z)("(max-width: 400px)"),K=(0,H.s)(),Q=(0,f.a)(h,{variables:N}),ee=Q.data,en=(ee=void 0===ee?{properties:[],meta:{aggregate:{totalCount:0}}}:ee).properties,et=ee.meta,er=Q.loading,eo=Q.refetch,ei=(0,m.t)(h,{fetchPolicy:"no-cache",variables:{accountId:N.accountId,q:N.q,orderBy:N.orderBy},onCompleted:function(e){try{var n=p().unparse(ed(e.properties)),t="data:application/octet-stream,"+encodeURIComponent(n);(0,G.S)(t,"locations.csv")}finally{D(!1)}}}),ea=(0,o.Z)(ei,1)[0],ec=function(e){e.stopPropagation(),D(!0),ea()},es=function(e,n){e.stopPropagation(),T.show({content:(0,E.jsx)(I.V,{accountId:t,accountName:r,data:null==n?void 0:n.data,entity:"Location",refetch:eo}),title:null!=n&&n.data?"Edit location":"Create location"})},eu=function(e){var n=e.row;d().push("".concat("/dashboard/properties/","view?id=").concat(n.data.id,"&tab=details"))},ed=function(e){return e.map(function(e){var n,t,r=null==e?void 0:null===(n=e.addresses[0])||void 0===n?void 0:n.address;return{name:e.name||"Not Specified",customer:e.customer[0].account.name,address:r?"".concat(r.addressLine1," - ").concat(r.postCode):"",bookings:null===(t=e.bookings)||void 0===t?void 0:t.length,totalSpent:(0,R.T)(X(e.bookings,e.invoices)),createdAt:Y(e.createdAt)}})},el=function(){return en.map(function(e){var n,t,r,o;return{id:e.id,data:e,name:e.name||"Not Specified",address:null!==(n=e.addresses[0])&&void 0!==n&&n.address?"\n            ".concat(null===(t=e.addresses[0])||void 0===t?void 0:t.address.addressLine1," -\n            ").concat(null===(r=e.addresses[0])||void 0===r?void 0:r.address.postCode):"Please Add",customer:e.customer[0].account.name,customerId:e.customer[0].account.id,workOrders:null===(o=e.bookings)||void 0===o?void 0:o.length,totalSpent:(0,R.T)(X(e.bookings,e.invoices)),compliancesList:e.compliances,createdAt:Y(e.createdAt),status:e.status,actions:""}})},ep=(0,a.useMemo)(function(){var e={};return!el().length&&null!=N&&N.q?{title:"No results",subtitleFirstLine:"The filters you have applied have returned no results",subtitleSecondLine:"Please amend and try again if necessary."}:{title:"No locations",subtitleFirstLine:"You currently have no locations set up in the system",subtitleSecondLine:"Click\xa0create location\xa0to get started building.",buttonText:"Create location",onAction:es}},[JSON.stringify(el())]),ef=J({},c);return(0,E.jsxs)(E.Fragment,{children:[l&&(0,E.jsx)(U,{initialFilters:i,open:l,filters:q,setFilters:M,onClose:function(){return v(!1)}}),(0,E.jsxs)(x.Z,{width:"100%",spacing:2,sx:{height:"100%"},children:[(0,E.jsxs)(x.Z,{width:"100%",direction:"row",justifyContent:"space-between",children:[(0,E.jsx)(O.Z,{variant:"contained",startIcon:(0,E.jsx)(C.Z,{}),onClick:function(){return v(!0)},children:"Filters"}),(0,E.jsxs)(x.Z,{direction:"row",spacing:2,children:[(0,E.jsx)(O.Z,{variant:"contained",color:"secondary",onClick:es,children:"Create Location"}),!K&&(0,E.jsx)(O.Z,{startIcon:!k&&(0,E.jsx)("img",{src:"/static/icons/csv.svg"}),disabled:k,variant:"contained",color:"success",onClick:ec,children:k?(0,E.jsx)(Z.Z,{size:20,color:"secondary"}):"Export"})]})]}),(0,E.jsxs)(w.Z,{sx:{padding:"16px 0px",height:s},children:[(0,E.jsx)(P.Z,{ml:2,variant:"h5",sx:{fontWeight:600,marginBottom:"15px"},children:"Locations"}),null!==(n=el())&&void 0!==n&&n.length?(0,E.jsx)(_.i,{ref:F,loading:er,columns:[{headerName:"Name",field:"name",minWidth:370,flex:1},{headerName:"Address",field:"address",minWidth:300,flex:1,sortable:!1},{headerName:"Customer",field:"customer",sortable:!1,flex:1,minWidth:W?100:"auto",renderCell:function(e){var n=e.row,t=n.customer,r=n.customerId;return(0,E.jsx)(g.r,{color:"secondary",href:"/dashboard/customers/view?id=".concat(r),children:t})}},{headerName:"Work Orders",field:"workOrders",sortable:!1,minWidth:W?100:"auto",renderCell:function(e){var n=e.row.workOrders;return(0,E.jsx)(y.Z,{sx:{marginLeft:"3em"},children:n})},flex:1},{headerName:"Total Spent",field:"totalSpent",sortable:!1,minWidth:W?140:"auto",renderCell:function(e){var n=e.row.totalSpent;return(0,E.jsx)(y.Z,{sx:{marginLeft:"1.5em"},children:n})},flex:1},{field:"createdAt",headerName:"Created At",minWidth:W?200:"auto",flex:1,sortable:!0},{field:"actions",headerName:"Actions",sortable:!1,minWidth:W?80:"auto",renderCell:function(e){var n=e.row;return(0,E.jsx)(j.Z,{sx:{marginLeft:"1em"},onClick:function(){return eu({row:n})},children:(0,E.jsx)(S.Z,{})})},flex:1}],rows:el(),columnVisibilityModel:ef,meta:et,refetch:eo,autoHeight:!1,containerHeight:"calc(100% - 52px)",onRowClick:eu}):!er&&(0,E.jsx)(V.C,J({imageSrc:"/static/icons/no_locations_found.svg"},ep))]})]})]})};K.defaultProps={columnVisibilityModel:{},tableContainerHeight:"calc(100% - 52px)"}},19958:function(e,n,t){"use strict";t.d(n,{V:function(){return V}});var r=t(16835),o=t(50029),i=t(59499),a=t(64687),c=t.n(a),s=t(67294),u=t(45697),d=t(6812),l=t(50319),p=t(95102),f=t(11163),m=t.n(f),v=t(42283),h=t(79665),g=t(76600),b=t(15214),y=t(9270),j=t(62140),x=t(49501),O=t(55563),Z=t(6710),w=t(95103),P=t(84043),S=t(50480),C=t(69368),I=t(11057),_=t(6054),A=t(71772),k=t(85893);function D(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function L(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?D(Object(t),!0).forEach(function(n){(0,i.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):D(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var q=function(e){var n=e.accountId,t=e.accountName,r=e.canSelectAccount,o=e.control,i=e.errors,a=e.setValue,c=e.watch,u=n?{value:n,label:t}:c("propertyOwner"),d=(0,_.Z)(u),l=function(e){a("contactUser",null)};(0,s.useEffect)(function(){u!==d&&d&&l(u)},[u]);var p={control:o,errors:i};return(0,k.jsxs)(y.Z,{children:[(0,k.jsx)(j.Z,{md:6,children:(0,k.jsx)(A.P,L(L({},p),{},{defaultValue:n&&{value:n,label:t},errors:L({},i),isDisabled:!r,label:"Client",name:"propertyOwner",placeholder:"Select",type:"customer"}))}),(0,k.jsx)(j.Z,{md:6,children:(0,k.jsx)(A.P,L(L({},p),{},{accountId:(null==u?void 0:u.value)||null,errors:L({},i),isDisabled:!u,label:"Contact Name",name:"contactUser",placeholder:u?"Select":"Select the location owner",type:"user"}))})]})},M=t(34197),$=function(e,n){var t=e.propertyOwner,r=e.contactUser;return e.Account_Locations={data:{accountId:t.value}},delete e.propertyOwner,e.contactUserId=(null==r?void 0:r.value)||null,delete e.contactUser,n&&delete e.Account_Locations,e},E=function(e,n,t,r){var o={location:$(e,!0),locationId:n.locationId,accountId:n.accountId,newAccountId:n.newAccountId,hasChanged:n.hasChanged};r({variables:o})},N=t(74231),F=t(58969),U=t(26380),T=t(72936),R=t(58095);function z(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function G(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?z(Object(t),!0).forEach(function(n){(0,i.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):z(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var H="/dashboard/properties/",V=function(e){var n,t,i,a,u=e.accountId,f=e.accountName,_=e.entity,A=e.data,D=e.refetch,L=e.onAddressCreated,z=e.isPropsComponent,V=e.initialValues,B=e.xeroContactId,W=e.displayXeroContacts,J=e.xeroContacts,Y=e.displaySignin,X=e.handleXeroAuthorize,K=e.onClose,Q=(0,R.a)(),ee=(0,T.x)().hasRole,en=(0,s.useState)(!1),et=en[0],er=en[1],eo=null==J?void 0:J.find(function(e){return e.value===B}),ei=G(G(G({},A?(location.propertyOwner={label:A.customer[0].account.name,value:A.customer[0].account.id},location.contactUser=(null==A?void 0:A.user)&&A.customer[0].account.id&&{label:A.user.fullName,value:A.user.id},location.access=A.access,location.name=A.name,location.status=A.status,location.permitsRequired=A.permitsRequired,location):{}),V),{},{xeroContact:eo})||{},ea=(0,v.cI)({defaultValues:ei,resolver:(0,h.S)((0,N.Ry)().shape({access:(0,N.Z_)().required(),contactUser:(0,N.Ry)().required(),name:(0,N.Z_)().required(),propertyOwner:(0,N.Ry)().required(),status:ee("admin")&&(0,N.Z_)().required(),permitsRequired:(0,N.O7)()}))}),ec=ea.control,es=ea.errors,eu=ea.handleSubmit,ed=ea.register,el=ea.setValue,ep=ea.getValues,ef=ea.watch,em=(0,d.a)(p.yf,{variables:{id:null==A?void 0:A.id},skip:!(null!=A&&A.id)}).data,ev=(em=void 0===em?{property:{}}:em).property,eh=(i=(0,o.Z)(c().mark(function e(n){var t,r,o,i,a,s,u,d,l;return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:var a,c;return t=n.addressFormData,r=n.outerFormData,o={Addresses:{data:{Address:{data:G({},t)},entity:_}}},i=G(G(G({},ep()),o),r),ee("customer")&&(i.status="active"),e.next=6,ej({variables:{objects:[$(a=i)]}});case 6:l=void 0===(d=(u=void 0===(u=(s=void 0===(s=e.sent.data)?{}:s).insert_Location)?{}:u).returning)?{}:d,L&&L(l),Q.close();case 14:case"end":return e.stop()}},e)})),function(e){return i.apply(this,arguments)}),eg=(a=(0,o.Z)(c().mark(function e(n){return c().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:Q.show({title:"Add new address",content:(0,k.jsx)(F.k,{onCancel:function(){},onSubmit:function(e){eh({addressFormData:e,outerFormData:n})},type:"text"}),submit:!1});case 1:case"end":return e.stop()}},e)})),function(e){return a.apply(this,arguments)}),eb=(0,l.D)(p.A1,{onCompleted:function(e){if(!z){var n=e.insert_Location.returning[0].id;Q.close(),D?D():m().push("".concat(H,"view?id=").concat(n))}}}),ey=(0,r.Z)(eb,2),ej=ey[0],ex=ey[1].loading,eO=(0,l.D)(p.$A,{onCompleted:function(e){var n=e.update_Location_by_pk.id;Q.close(),D?D():m().push("".concat(H,"view?id=").concat(n))}}),eZ=(0,r.Z)(eO,2),ew=eZ[0],eP=eZ[1].loading,eS=(0,l.D)(p.$E),eC=(0,r.Z)(eS,1)[0],eI=function(e){if(er(!1),A){if("inactive"===e.status&&!(n=ev.jobs).every(function(e){return!!(0,M.E)(e,["completed","closed"])})){er(!0);return}e.xeroContact&&eC({variables:{id:null==A?void 0:null===(i=A.customer[0])||void 0===i?void 0:i.account.id,changes:{meta:G(G({},null==A?void 0:null===(a=A.customer[0])||void 0===a?void 0:a.account.meta),{},{xeroContactId:e.xeroContact.value})}}});var n,t,r,o,i,a,c={locationId:null==A?void 0:A.id,accountId:null==A?void 0:null===(t=A.customer[0])||void 0===t?void 0:t.account.id,newAccountId:null==e?void 0:null===(r=e.propertyOwner)||void 0===r?void 0:r.value,hasChanged:(null==A?void 0:null===(o=A.customer[0])||void 0===o?void 0:o.account.id)!==(null==e?void 0:e.propertyOwner.value)};E(G(G({},e),{},{xeroContact:void 0}),c,A.id,ew),K()}else eg(e),K()},e_={control:ec,errors:es,register:ed};return(0,k.jsxs)(g.Z,{disabled:ex||eP,id:"offCanvasForm",handleSubmit:eu(eI),children:[et&&(0,k.jsx)(b.Z,{context:"info",content:" This location cannot be made inactive, it has active jobs."}),(0,k.jsx)(y.Z,{children:(0,k.jsx)(j.Z,{md:12,children:(0,k.jsx)(q,G(G({},e_),{},{accountId:u,accountName:f,canSelectAccount:!u,setValue:el,watch:ef}))})}),(0,k.jsx)(x.Z,{label:"Name",children:(0,k.jsx)(O.Z,G(G({},e_),{},{name:"name"}))}),(0,k.jsx)(x.Z,{label:"Access information",children:(0,k.jsx)(Z.Z,G(G({},e_),{},{name:"access",rows:4}))}),ee("admin")&&(0,k.jsx)(x.Z,{label:"Status",children:(0,k.jsx)(w.Z,G(G({},e_),{},{name:"status",options:U.bg}))}),(0,k.jsx)(v.Qr,{name:"permitsRequired",control:ec,render:function(e){var n=e.value,t=e.onChange;return(0,k.jsx)(S.Z,{control:(0,k.jsx)(C.Z,{color:"secondary",checked:n||!1,onChange:function(e){return t(e.target.checked)}}),label:"Permits required"})}}),ee("admin")&&void 0!==W&&W&&(0,k.jsx)(x.Z,{label:"Xero Contact",children:Y?(0,k.jsx)(I.Z,{variant:"contained",onClick:function(){X()},children:"Connect to Xero to select Contact"}):(0,k.jsx)(P.Z,G(G({options:J},e_),{},{name:"xeroContact"}))})]})};q.propTypes={accountId:u.number,accountName:u.string,data:u.object,refetch:u.func,offCanvas:u.func}},95102:function(e,n,t){"use strict";t.d(n,{$A:function(){return v},$E:function(){return h},A1:function(){return m},Un:function(){return f},yf:function(){return b},zg:function(){return g}});var r,o,i,a,c,s,u,d,l=t(71383),p=t(75063);(0,p.Ps)(r||(r=(0,l.Z)(["\n  query GetProperty($id: Int!) {\n    location: Location_by_pk(id: $id) {\n      id\n      contactUserId\n      name\n      access\n      contactUser: User {\n        id\n        nameFirst\n        nameLast\n      }\n      propertyOwner: Account_Locations {\n        account: Account {\n          id\n          name\n          type\n        }\n      }\n    }\n  }\n"])));var f=(0,p.Ps)(o||(o=(0,l.Z)(['\n  query GetMapProperties {\n    properties: Location {\n      id\n      access\n      createdAt\n      name\n      contactUserId\n      addresses: Addresses(where: { entity: { _eq: "Location" } }) {\n        id\n        registered\n        operating\n        trading\n        invoice\n        status\n        createdAt\n        address: Address {\n          id\n          name\n          addressLine1\n          addressLine2\n          addressLine3\n          city\n          county\n          geo\n          postCode\n          country: Country {\n            id\n            name\n          }\n        }\n      }\n      bookings: Jobs {\n        id\n        title\n        createdAt\n        customerId\n        amount\n        locationId\n        managerId\n        quoteNumber\n        reference\n        status\n        serviceId\n        meta\n        customer: Customer {\n          id\n          name\n        }\n        location: Location {\n          id\n          name\n          addresses: Addresses(where: { entity: { _eq: "Location" } }) {\n            id\n            registered\n            operating\n            trading\n            invoice\n            status\n            createdAt\n            address: Address {\n              id\n              name\n              addressLine1\n              addressLine2\n              addressLine3\n              city\n              county\n              geo\n              postCode\n              country: Country {\n                id\n                name\n              }\n            }\n          }\n        }\n        manager: Manager {\n          id\n          nameFirst\n          nameLast\n        }\n        sla: SLA {\n          id\n          name\n          notes\n        }\n        supplier: Supplier {\n          id\n          companyNumber\n          createdAt\n          name\n          status\n          type\n          updatedAt\n          website\n          clientType\n          managerId\n          vatId\n          meta\n          media: Media {\n            id\n            medium: Medium {\n              id\n              category\n              filename\n              meta\n              type\n            }\n          }\n          manager: Manager {\n            id\n            fullName\n          }\n        }\n        supplierOffers: SupplierOffers {\n          status\n          rate\n          supplier: Supplier {\n            id\n            companyNumber\n            createdAt\n            name\n            status\n            type\n            updatedAt\n            website\n            clientType\n            managerId\n            vatId\n            meta\n            media: Media {\n              id\n              medium: Medium {\n                id\n                category\n                filename\n                meta\n                type\n              }\n            }\n            manager: Manager {\n              id\n              fullName\n            }\n          }\n        }\n        timings: JobTimings {\n          id\n          status\n          createdAt\n        }\n      }\n    }\n  }\n']))),m=(0,p.Ps)(i||(i=(0,l.Z)(["\n  mutation AddLocation($objects: [Location_insert_input!]!) {\n    insert_Location(objects: $objects) {\n      returning {\n        id\n        name\n      }\n    }\n  }\n"]))),v=(0,p.Ps)(a||(a=(0,l.Z)(["\n  mutation UpdateAccountLocation(\n    $location: Location_set_input\n    $locationId: Int!\n    $accountId: Int!\n    $newAccountId: Int!\n    $hasChanged: Boolean!\n  ) {\n    update_Account_Location(\n      where: { Account: { id: { _eq: $accountId } }, id: { _eq: $locationId } }\n      _set: { accountId: $newAccountId }\n    ) @include(if: $hasChanged) {\n      returning {\n        id\n      }\n    }\n    update_Location_by_pk(pk_columns: { id: $locationId }, _set: $location) {\n      id\n    }\n  }\n"]))),h=(0,p.Ps)(c||(c=(0,l.Z)(["\n  mutation UpdateAccount($id: Int!, $changes: Account_set_input) {\n    update_Account_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"]))),g=(0,p.Ps)(s||(s=(0,l.Z)(["\n  mutation UpdateLocation($id: Int!, $changes: Location_set_input) {\n    update_Location_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"])));(0,p.Ps)(u||(u=(0,l.Z)(["\n  query GetAccountName($id: Int!) {\n    account: Account_by_pk(id: $id) {\n      id\n      name\n      type\n    }\n  }\n"])));var b=(0,p.Ps)(d||(d=(0,l.Z)(["\n  query GetPropertiesJob($id: Int!) {\n    property: Location_by_pk(id: $id) {\n      id\n      jobs: Jobs {\n        id\n        timings: JobTimings {\n          id\n          status\n          createdAt\n        }\n      }\n    }\n  }\n"])))},35137:function(e,n,t){"use strict";t.d(n,{C:function(){return f}});var r=t(59499);t(67294);var o=t(90948),i=t(61730),a=t(26447),c=t(15861),s=t(11057),u=t(85893);function d(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?d(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var p=(0,o.ZP)("img")({width:"300px",height:"250px"}),f=function(e){var n=e.imageSrc,t=e.sx,r=e.imageSx,o=e.title,d=e.titleSx,f=e.subtitleFirstLine,m=e.subtitleFirstLineSx,v=e.subtitleSecondLine,h=e.subtitleSecondLineSx,g=e.buttonText,b=e.onAction,y=(0,i.Z)("(max-width: 400px)");return(0,u.jsxs)(a.Z,{sx:l(l({},t),{},{width:"100%",height:"100%"}),justifyContent:"center",alignItems:"center",spacing:2,color:"#757575",children:[(0,u.jsx)(p,{src:n,sx:l(l({},r),{},{width:y?"250px":"300px"})}),(0,u.jsx)(c.Z,{typography:"h5",sx:l({},d),children:o}),(0,u.jsxs)(a.Z,{alignItems:"center",sx:{padding:"0px 10px",textAlign:"center"},children:[(0,u.jsx)(c.Z,{sx:l({},m),children:f}),(0,u.jsx)(c.Z,{sx:l({},h),children:v})]}),g&&b&&(0,u.jsx)(s.Z,{variant:"contained",color:"secondary",onClick:b,children:g})]})};f.defaultProps={title:"",subtitleFirstLine:"",subtitleSecondLine:"",sx:{},imageSx:{},titleSx:{},subtitleFirstLineSx:{},subtitleSecondLineSx:{},onAction:null}},32836:function(e,n,t){"use strict";t.d(n,{i:function(){return P}});var r=t(59499),o=t(67294),i=t(11163),a=t(83148),c=t(26447),s=t(15861),u=t(90948),d=t(5616),l=t(41796),p=t(87361),f=t(42096),m=t(87043),v=t(61730),h=t(58886),g=t(70872),b=t(85893);function y(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function j(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?y(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):y(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var x=function(e){var n=e.currentPage,t=e.totalCount,r=e.pageSize,o=e.onPageChange,i=(0,v.Z)("(max-width:400px)"),a=(0,v.Z)("(max-width:500px)");return(0,b.jsx)(O,{mb:2,page:n,count:Math.ceil(t/r),onChange:function(e,n){return o(n)},variant:"outlined",shape:"rounded",size:i?"small":"medium",hidePrevButton:1===n,hideNextButton:n===Math.ceil(t/r),siblingCount:a?0:1,renderItem:function(e){return(0,b.jsx)(h.Z,j({slots:{previous:function(){return"Previous"},next:function(){return"Next"}}},e))}})};x.defaultProps={currentPage:1,totalCount:0,pageSize:50,onPageChange:function(){}};var O=(0,u.ZP)(g.Z)(function(e){var n,t=e.hidePrevButton,o=e.hideNextButton,i=e.theme;return n={},(0,r.Z)(n,"&.MuiPagination-root",{alignSelf:"center",marginTop:"16px"}),(0,r.Z)(n,"& .MuiPaginationItem-root",{fontWeight:600,margin:0,borderRadius:0}),(0,r.Z)(n,"& .MuiPagination-ul > li:last-child .MuiPaginationItem-previousNext:last-child",{margin:0,borderRadius:"0 5px 5px 0"}),(0,r.Z)(n,"& .MuiPagination-ul > li:first-child .MuiPaginationItem-previousNext:last-child",{margin:0,borderRadius:"5px 0 0 5px"}),(0,r.Z)(n,"& button.Mui-selected",j(j({color:i.palette.white.main,backgroundColor:i.palette.secondary.main},o?{borderRadius:"0 5px 5px 0"}:{}),t?{borderRadius:"5px 0 0 5px"}:{})),n});function Z(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function w(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?Z(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Z(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var P=(0,o.forwardRef)(function(e,n){var t=e.columns,r=e.history,a=e.initialSort,u=e.meta,d=e.refetch,l=e.paginationSize,v=e.containerHeight,h=e.noResultsMessage,g=e.autoHeight,y=(0,i.useRouter)(),j=y.query,O=void 0===j?{}:j,Z=(0,o.useState)(parseInt(null==O?void 0:O.page,10)||1),P=Z[0],I=Z[1],_=(0,o.useState)(l||m.C1.paginationSize),A=_[0],k=_[1];a||(a={item:"createdAt",order:"desc"});var D=(0,o.useState)({item:a.item,order:a.order}),L=D[0],q=D[1],M=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=y.query,t=void 0===n?{}:n;if(e>1?t.page=e:delete t.page,!(Object.keys(t).length>0))return{};var r=Object.keys(t).map(function(n){return"page"===n?"".concat(n,"=").concat(e):"".concat(n,"=").concat(t[n])}).join("&");return"?".concat(r)},$=function(){q({item:a.item,order:a.order}),I(1);var e=M();y.push(e),k(l||m.C1.paginationSize)};(0,o.useImperativeHandle)(n,function(){return{currentPage:P,pageSize:A,sort:L,resetPagination:function(){$()}}});var E=function(e){var n=M(e);r&&y.push(n),I(e),!r&&d&&d()},N=function(e){e&&e.field&&e.sort?(q({item:t.find(function(n){return n.field===e.field}).sortName||e.field||e.item||a.item,order:e.sort||e.order||a.order}),d&&d()):(q({item:a.item,order:a.order}),d&&d())};return(0,b.jsxs)(S,{containerHeight:v,children:[(0,b.jsx)(C,w({hideFooter:!0,disableColumnMenu:!0,disableSelectionOnClick:!0,autoHeight:g,sortingMode:"server",onSortModelChange:function(e){return N(e[0])},columns:t,pageSize:A,slots:{columnSortedAscendingIcon:function(){return(0,b.jsx)(p.Z,{})},columnSortedDescendingIcon:function(){return(0,b.jsx)(f.Z,{})},columnUnsortedIcon:function(){return(0,b.jsxs)(c.Z,{alignItems:"center",sx:{width:"33px"},children:[(0,b.jsx)(p.Z,{sx:{marginBottom:"-15px"}}),(0,b.jsx)(f.Z,{})]})},noResultsOverlay:function(){return(0,b.jsx)(c.Z,{height:"100%",alignItems:"center",justifyContent:"center",spacing:1,p:1,children:(0,b.jsx)(s.Z,{children:h})})},noRowsOverlay:function(){return(0,b.jsx)(c.Z,{height:"100%",alignItems:"center",justifyContent:"center",spacing:1,p:1,children:(0,b.jsx)(s.Z,{children:h})})}}},e)),u&&Math.ceil(u.aggregate.totalCount/A)>1&&(0,b.jsx)(x,{currentPage:P,totalCount:u.aggregate.totalCount,pageSize:A,onPageChange:E})]})});P.defaultProps={columns:[],history:!1,loading:!1,rows:[],noResultsMessage:"There are no results.",autoHeight:!0};var S=(0,u.ZP)(d.Z)(function(e){return{height:e.containerHeight,display:"flex",flexDirection:"column"}}),C=(0,u.ZP)(a.s)(function(e){var n,t=e.theme,o=e.hideHeader,i=(e.rows,e.loading,e.rowHeight),a=e.isPdf;return n={"--DataGrid-overlayHeight":"40px"},(0,r.Z)(n,"&.MuiDataGrid-root",w({color:t.palette.black.main,border:"none"},a&&{"@media print":{display:"block"}})),(0,r.Z)(n,"& .MuiDataGrid-main",w({},a&&{"@media print":{overflow:"visible !important"}})),(0,r.Z)(n,"& .MuiDataGrid-columnHeaders",w(w({},o&&{display:"none"}),{},{"& .MuiDataGrid-iconButtonContainer":{visibility:"visible","& .MuiButtonBase-root.MuiIconButton-root":{backgroundColor:"inherit",color:t.palette.black.main,"&:hover":{backgroundColor:"rgba(0, 0, 0, 0.1)"}}}})),(0,r.Z)(n,"& .MuiDataGrid-virtualScroller",w(w({},o&&{marginTop:"0 !important"}),a&&{"@media print":{overflow:"visible !important"}})),(0,r.Z)(n,"& .MuiDataGrid-iconSeparator",{opacity:0}),(0,r.Z)(n,"& .MuiDataGrid-columnHeaderTitle",{fontWeight:700}),(0,r.Z)(n,"& .MuiButtonBase-root.MuiDataGrid-columnHeaderTitle",{fontWeight:700}),(0,r.Z)(n,"& .MuiDataGrid-virtualScrollerContent",w({},a&&{height:"initial !important",minHeight:"initial !important"})),(0,r.Z)(n,"& .MuiDataGrid-virtualScrollerRenderZone",w({},a&&{position:"relative"})),(0,r.Z)(n,"& .MuiDataGrid-overlayWrapper",(0,r.Z)({},"& .MuiCircularProgress-root",{color:t.palette.secondary.main})),(0,r.Z)(n,"& .MuiDataGrid-row",w({},a&&{minHeight:"".concat(i,"cm !important"),maxHeight:"".concat(i,"cm !important")})),(0,r.Z)(n,"& .MuiDataGrid-row > .MuiDataGrid-cell",w({},a&&{minHeight:"".concat(i,"cm !important"),maxHeight:"".concat(i,"cm !important")})),(0,r.Z)(n,"& .MuiDataGrid-row.even",{backgroundColor:t.palette.muiLightGray.main,"&:hover, &.Mui-hovered":{backgroundColor:(0,l.Fq)(t.palette.muiLightGray.main,.3),"@media (hover: none)":{backgroundColor:"transparent"}},"&.Mui-selected":{backgroundColor:(0,l.Fq)(t.palette.muiLightGray.main,.3+t.palette.action.selectedOpacity),"&:hover, &.Mui-hovered":{backgroundColor:(0,l.Fq)(t.palette.muiLightGray.main,.3+t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:(0,l.Fq)(t.palette.muiLightGray.main,.3+t.palette.action.selectedOpacity)}}}}),n})},42846:function(e,n,t){"use strict";t.d(n,{x:function(){return d}});var r=t(59499),o=t(67294),i=t(96486),a=t(87043),c=function(e){try{return JSON.parse(e)}catch(n){return!1}};function s(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function u(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?s(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):s(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var d=function(e){var n,t,s,d,l,p,f,m,v,h,g,b=e.filters,y=e.newFilters,j=e.initialSort,x=(0,o.useRef)(),O=(0,o.useState)({}),Z=O[0],w=O[1],P=(0,o.useState)({}),S=P[0],C=P[1],I=j||{item:"createdAt",order:"desc"},_=(0,r.Z)({},(null===(n=x.current)||void 0===n?void 0:n.sort.item)||I.item,I.inneritem?(0,r.Z)({},I.inneritem,(null===(t=x.current)||void 0===t?void 0:t.sort.order)||I.order):(null===(s=x.current)||void 0===s?void 0:s.sort.order)||I.order);return(0,o.useEffect)(function(){var e=!(0,i.isEqual)(Z,b),n=!(0,i.isEqual)(S,y);if(e&&(w(b),null==x||null===(r=x.current)||void 0===r||r.resetPagination()),n&&(C(y),null==x||null===(o=x.current)||void 0===o||o.resetPagination()),null!=x&&null!==(t=x.current)&&void 0!==t&&t.setSort&&!(e||n)){var t,r,o,a,c,s,u,d,l,p,f,m=null!==(a=x.current)&&void 0!==a&&null!==(c=a.sort)&&void 0!==c&&c.item&&null!==(s=x.current)&&void 0!==s&&null!==(u=s.sort)&&void 0!==u&&u.order?{item:null===(d=x.current)||void 0===d?void 0:null===(l=d.sort)||void 0===l?void 0:l.item,order:null===(p=x.current)||void 0===p?void 0:null===(f=p.sort)||void 0===f?void 0:f.order}:_;x.current.setSort(m)}},[b,y]),{initialData:u(u({},b),{},{newFilters:(null==y?void 0:y.length)>0?y:void 0,limit:(null===(d=x.current)||void 0===d?void 0:d.pageSize)==="Infinity"?null:parseInt(null===(l=x.current)||void 0===l?void 0:l.pageSize,10)||a.C1.paginationSize,offset:((null===(p=x.current)||void 0===p?void 0:p.currentPage)-1||0)*((null===(f=x.current)||void 0===f?void 0:f.pageSize)||a.C1.paginationSize),orderBy:c(null===(m=x.current)||void 0===m?void 0:null===(v=m.sort)||void 0===v?void 0:null===(h=v.item)||void 0===h?void 0:h.replace(/ORDER/i,null===(g=x.current)||void 0===g?void 0:g.sort.order))||_}),initialSort:j,ref:x}}},48829:function(e,n,t){"use strict";t.d(n,{S:function(){return r}});var r=function(e,n){var t=document.createElement("a");"string"==typeof t.download?(document.body.appendChild(t),t.download=n,t.href=e,t.click(),document.body.removeChild(t)):location.replace(e)}},45110:function(e,n,t){"use strict";function r(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"GBP";return new Intl.NumberFormat(["en-GB"],{currency:n,currencyDisplay:"symbol",style:"currency"}).format(e)}t.d(n,{T:function(){return r}})},3896:function(e,n,t){"use strict";t.d(n,{X:function(){return f}});var r,o,i=t(71383),a=t(16835),c=t(59499),s=t(67294),u=t(6812),d=t(50319),l=t(75063),p=t(55863);function f(e,n){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"sessionStorage",r=(0,p.q)().user,o=(0,s.useState)(function(){try{switch(t){case"network":return n;case"sessionStorage":return JSON.parse(window.sessionStorage.getItem(e))||n}}catch(r){return n}}),i=o[0],l=o[1],f=function(n){try{var o=n instanceof Function?n(i):n;switch(l(o),t){case"network":g({variables:{accountUserId:null==r?void 0:r.accountUserId,filters:(0,c.Z)({},e,o)}});break;case"sessionStorage":window.sessionStorage.setItem(e,JSON.stringify(o))}}catch(a){}};(0,u.a)(m,{variables:{accountUserId:null==r?void 0:r.accountUserId},skip:"network"!==t,onCompleted:function(t){var r=t.accountUser;r&&l(r.filters[e]||n)}});var h=(0,d.D)(v),g=(0,a.Z)(h,1)[0];return[i,f]}var m=(0,l.Ps)(r||(r=(0,i.Z)(["\n  query GetAccountUserFilters($accountUserId: Int!) {\n    accountUser: Account_User_by_pk(id: $accountUserId) {\n      filters\n    }\n  }\n"]))),v=(0,l.Ps)(o||(o=(0,i.Z)(["\n  mutation SetAccountUserFilters($accountUserId: Int!, $filters: jsonb) {\n    update_Account_User_by_pk(pk_columns: { id: $accountUserId }, _append: { filters: $filters }) {\n      id\n    }\n  }\n"])))},77329:function(e,n,t){"use strict";t.d(n,{O:function(){return r},v:function(){return o}});var r=[{text:"Country",value:""},{text:"United Kingdom",value:1},{text:"Ireland",value:4}],o=[{label:"United Kingdom",value:1},{label:"Ireland",value:4}]},26380:function(e,n,t){"use strict";t.d(n,{bg:function(){return r}});var r=[{text:"Status",value:""},{text:"Active",value:"active"},{text:"Inactive",value:"inactive"}]},32770:function(e,n,t){"use strict";t.r(n);var r=t(86385),o=t(55863),i=t(72936),a=t(38033),c=t(85893),s={accountId:null,q:null,filterType:"locations_table"},u=function(){var e=(0,o.q)().hasUserModule,n=(0,(0,i.x)().hasRole)("customer_user"),t=e("finances");return(0,c.jsx)(a.Z,{children:(0,c.jsx)(r.V,{initialFilters:s,columnVisibilityModel:{totalSpent:!n||t}})})};u.getLayout=function(e){return e},n.default=u},1215:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard/properties",function(){return t(32770)}])}},function(e){e.O(0,[3662,2283,212,8890,619,1100,4135,5020,6043,4244,5370,3776,2329,778,1023,4253,3148,9241,6344,191,8033,1772,9774,2888,179],function(){return e(e.s=1215)}),_N_E=e.O()}]);