"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6247],{42890:function(e,n,t){t.d(n,{Au:function(){return g},FD:function(){return l},YW:function(){return m},dG:function(){return f},kU:function(){return p},tC:function(){return v}});var i,o,r,a,c,s,u=t(71383),d=t(75063),l=(0,d.Ps)(i||(i=(0,u.Z)(["\n  mutation AddComplianceEntity($objects: [Compliance_Entity_insert_input!]!) {\n    insert_Compliance_Entity(objects: $objects) {\n      returning {\n        id\n      }\n    }\n  }\n"]))),m=(0,d.Ps)(o||(o=(0,u.Z)(["\n  mutation UpdateComplianceEntity($id: Int!, $changes: Compliance_Entity_set_input) {\n    update_Compliance_Entity_by_pk(pk_columns: { id: $id }, _set: $changes) {\n      id\n    }\n  }\n"]))),p=(0,d.Ps)(r||(r=(0,u.Z)(['\n  query GetCompliancesForSelect($adminId: Int!, $type: String) {\n    compliances: Compliance(where: { adminId: { _eq: $adminId }, type: { _eq: $type } }) {\n      value: id\n      label: name\n      url\n      governingBody\n      regNumExample\n      expectCertificate\n      hasInsuranceAmount\n      type\n      questions: Taxonomies(where: { entity: { _eq: "Compliance" } }) {\n        id\n        name\n        meta\n      }\n      category: Category {\n        id\n        name\n      }\n    }\n  }\n']))),v=(0,d.Ps)(a||(a=(0,u.Z)(["\n  mutation DeleteComplianceEntity($id: Int!) {\n    delete_Compliance_Entity_by_pk(id: $id) {\n      id\n    }\n  }\n"]))),f=(0,d.Ps)(c||(c=(0,u.Z)(['\n  query getComplianceTiles(\n    $customerId: Int\n    $locationId: Int\n    $nowNew: timestamptz\n    $now: date\n    $nextMonth: date\n    $nextWeek: timestamptz\n  ) {\n    overdue: Compliance_Entity_aggregate(\n      where: {\n        expiryAt: { _lt: $now }\n        entity: { _eq: "Location" }\n        entityId: { _eq: $locationId }\n        Location: { Account_Locations: { accountId: { _eq: $customerId } } }\n      }\n    ) {\n      aggregate {\n        count\n      }\n    }\n    upComing: Compliance_Entity_aggregate(\n      where: {\n        _and: [{ expiryAt: { _gt: $now } }, { expiryAt: { _lt: $nextMonth } }]\n        entity: { _eq: "Location" }\n        entityId: { _eq: $locationId }\n        Location: { Account_Locations: { accountId: { _eq: $customerId } } }\n      }\n    ) {\n      aggregate {\n        count\n      }\n    }\n\n    jobs: Compliance_Entity(\n      where: {\n        entity: { _eq: "Job" }\n        Job: { locationId: { _eq: $locationId }, customerId: { _eq: $customerId } }\n      }\n      order_by: { Job: { timingStart: asc } }\n    ) {\n      entityId\n      job: Job {\n        amount\n        supplierId\n        scheduledAt\n        timingStart\n      }\n    }\n    openCPPM: Compliance_Entity_aggregate(\n      where: {\n        entity: { _eq: "Job" }\n        Job: {\n          locationId: { _eq: $locationId }\n          customerId: { _eq: $customerId }\n          status: { _neq: "closed" }\n        }\n      }\n    ) {\n      aggregate {\n        count\n      }\n    }\n    openCPPMToday: Compliance_Entity_aggregate(\n      where: {\n        entity: { _eq: "Job" }\n        Job: {\n          locationId: { _eq: $locationId }\n          customerId: { _eq: $customerId }\n          status: { _neq: "closed" }\n          _and: { timingStart: { _gte: $nowNew, _lte: $nowNew } }\n        }\n      }\n    ) {\n      aggregate {\n        count\n      }\n    }\n    openCPPMNextWeek: Compliance_Entity_aggregate(\n      where: {\n        entity: { _eq: "Job" }\n        Job: {\n          locationId: { _eq: $locationId }\n          customerId: { _eq: $customerId }\n          status: { _neq: "closed" }\n          _and: { timingStart: { _gte: $nowNew, _lte: $nextWeek } }\n        }\n      }\n    ) {\n      aggregate {\n        count\n      }\n    }\n    CPPMDocOutstanding: Compliance_Entity_aggregate(\n      where: {\n        entity: { _eq: "Job" }\n        Job: {\n          locationId: { _eq: $locationId }\n          customerId: { _eq: $customerId }\n          JobTimings: { status: { _in: ["complianceRequestedDocumentation"] } }\n        }\n      }\n    ) {\n      aggregate {\n        count\n      }\n    }\n    unsatisfactoryCPPM: Compliance_Entity_aggregate(\n      where: {\n        entity: { _eq: "Job" }\n        Job: {\n          locationId: { _eq: $locationId }\n          customerId: { _eq: $customerId }\n          JobTimings: { status: { _in: ["complianceRejected"] } }\n        }\n      }\n    ) {\n      aggregate {\n        count\n      }\n    }\n\n    waitingCustomerSingOff: Compliance_Entity_aggregate(\n      where: {\n        entity: { _eq: "Job" }\n        Media: { entity: { _eq: "Compliance_Entity" } }\n        Job: {\n          locationId: { _eq: $locationId }\n          customerId: { _eq: $customerId }\n          JobTimings: {\n            _and: [\n              { status: { _in: ["complianceRequestedDocumentation"] } }\n              { status: { _nin: ["complianceApproved", "complianceRejected"] } }\n            ]\n          }\n        }\n      }\n    ) {\n      aggregate {\n        count\n      }\n    }\n    CPPMSpendAmount: Job_aggregate(\n      where: {\n        Compliances: { entity: { _eq: "Job" } }\n        locationId: { _eq: $locationId }\n        customerId: { _eq: $customerId }\n      }\n    ) {\n      aggregate {\n        sum {\n          amount\n        }\n      }\n    }\n  }\n']))),g=(0,d.Ps)(s||(s=(0,u.Z)(['\n  query getCompliance_Entity($entity: String, $entityId: Int) {\n    compliances: Compliance_Entity(\n      where: { entity: { _eq: $entity }, entityId: { _eq: $entityId } }\n      order_by: { expiryAt: asc }\n    ) {\n      id\n      createdAt\n      entity\n      entityId\n      expiryAt\n      insuranceAmount\n      regNum\n      meta\n      compliance: Compliance {\n        id\n        type\n        name\n        status\n        hasInsuranceAmount\n        questions: Taxonomies(where: { entity: { _eq: "Compliance" } }) {\n          id\n          name\n          meta\n        }\n      }\n    }\n  }\n'])))},65524:function(e,n,t){t.d(n,{p:function(){return b}});var i=t(6812),o=t(42890),r=t(11640),a=t(63500),c=t(73303),s=t.n(c),u=t(11587),d=t(26186),l=t(11082),m=t(85893),p=new Date,v=(0,r.Z)(p,1),f=(0,a.Z)(p,1),g=(0,r.Z)(p,-12),b=function(e){var n,t=e.customerId,r=e.locationId,a=e.hideFinance,c=(0,i.a)(o.dG,{variables:{customerId:t,locationId:r,now:p,nowNew:p,nextMonth:v,nextWeek:f}}),b=c.loading,h=c.data,x=(h=void 0===h?{JobSchedule:[]}:h).CPPMDocOutstanding,y=h.CPPMSpendAmount,j=h.jobs,I=h.openCPPM,_=h.openCPPMNextWeek,w=h.openCPPMToday,Z=h.overdue,$=h.unsatisfactoryCPPM,P=h.upComing,C=s()(null==j?void 0:j.filter(function(e){return new Date(e.job.timingStart)>g&&new Date(e.job.timingStart)<p}),function(e){return Number(e.job.amount)}),O=null==j?void 0:null===(n=j.find(function(e){return new Date(null==e?void 0:e.job.timingStart)>p}))||void 0===n?void 0:n.job;return!b&&(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)(u.Z,{content:(0,m.jsxs)(m.Fragment,{children:["Overdue: ",(0,m.jsx)("b",{children:null==Z?void 0:Z.aggregate.count})]}),context:"secondary",shape:"round",size:"sm"}),(0,m.jsx)(u.Z,{content:(0,m.jsxs)(m.Fragment,{children:["Upcoming: ",(0,m.jsx)("b",{children:null==P?void 0:P.aggregate.count})]}),context:"secondary",shape:"round",size:"sm"}),(0,m.jsx)(u.Z,{content:(0,m.jsxs)(m.Fragment,{children:["Unconfirmed: ",(0,m.jsx)("b",{children:j.filter(function(e){return!e.job.scheduledAt}).length})]}),context:"secondary",shape:"round",size:"sm"}),(0,m.jsx)(u.Z,{content:(0,m.jsxs)(m.Fragment,{children:["Next Visit: ",(0,m.jsx)("b",{children:O?(0,d.Z)(null==O?void 0:O.timingStart):"-"})]}),context:"secondary",shape:"round",size:"sm"}),(0,m.jsx)(u.Z,{content:(0,m.jsxs)(m.Fragment,{children:["Work Orders: ",(0,m.jsx)("b",{children:j.length})]}),context:"secondary",shape:"round",size:"sm"}),!a&&(0,m.jsx)(u.Z,{content:(0,m.jsxs)(m.Fragment,{children:["Compliance Spent (12M): ",(0,m.jsx)("b",{children:(0,l.Z)(C)})]}),context:"secondary",shape:"round",size:"sm"}),(0,m.jsx)(u.Z,{content:(0,m.jsxs)(m.Fragment,{children:["Open CPPMs: ",(0,m.jsx)("b",{children:null==I?void 0:I.aggregate.count})]}),context:"secondary",shape:"round",size:"sm"}),(0,m.jsx)(u.Z,{content:(0,m.jsxs)(m.Fragment,{children:["CPPMs due today: ",(0,m.jsx)("b",{children:null==w?void 0:w.aggregate.count})]}),context:"secondary",shape:"round",size:"sm"}),(0,m.jsx)(u.Z,{content:(0,m.jsxs)(m.Fragment,{children:["CPPMs due this week: ",(0,m.jsx)("b",{children:null==_?void 0:_.aggregate.count})]}),context:"secondary",shape:"round",size:"sm"}),(0,m.jsx)(u.Z,{content:(0,m.jsxs)(m.Fragment,{children:["CPPM Docs Outstanding: ",(0,m.jsx)("b",{children:null==x?void 0:x.aggregate.count})]}),context:"secondary",shape:"round",size:"sm"}),(0,m.jsx)(u.Z,{content:(0,m.jsxs)(m.Fragment,{children:["Unsatisfactory CPPM: ",(0,m.jsx)("b",{children:null==$?void 0:$.aggregate.count})]}),context:"secondary",shape:"round",size:"sm"}),!a&&(0,m.jsx)(u.Z,{content:(0,m.jsxs)(m.Fragment,{children:["CPPM Spend YDT: ",(0,m.jsx)("b",{children:(0,l.Z)(null==y?void 0:y.aggregate.sum.amount)})]}),context:"secondary",shape:"round",size:"sm"})]})}},23466:function(e,n,t){t.d(n,{c:function(){return r}});var i=t(26186),o=t(11082),r=function(e,n,t){var r=t.numberPrefix,a=void 0===r?"":r,c=t.numberSuffix,s=void 0===c?"":c,u="customer"===n,d="supplier"===n;return e.map(function(e){var n,t,r,c,l,m,p,v,f,g,b,h,x,y,j,I,_,w,Z,$=e.manager?"".concat(e.manager.nameFirst," ").concat(e.manager.nameLast):"Unassigned",P=e.scheduledAt?(0,i.Z)(e.scheduledAt,!0):e.timingStart?(0,i.Z)(e.timingStart,!0):"-",C=e.customerRebateAmount>0?e.customerVatTotal-e.customerRebateAmount-e.supplierTotal:e.customerTotal-e.supplierTotal;return d?{id:"".concat(a," ").concat(e.number," ").concat(s),type:e.type,invoiceNumber:(null===(n=e.invoices)||void 0===n?void 0:null===(t=n[0])||void 0===t?void 0:t.invoiceNumber)||"-",priority:(null===(r=e.sla)||void 0===r?void 0:r.name)||"-",service:(null===(c=e.service)||void 0===c?void 0:c.name)||"-",description:e.description||"-",location:(null===(l=e.location)||void 0===l?void 0:l.name)||"-",sublocation:(null===(m=e.sublocation)||void 0===m?void 0:m.name)||"-",scheduleDate:P,created:(0,i.Z)(e.createdAt),status:e.status}:u?{id:"".concat(a," ").concat(e.number," ").concat(s),type:e.type,invoiceNumber:(null===(p=e.invoices)||void 0===p?void 0:null===(v=p[0])||void 0===v?void 0:v.invoiceNumber)||"-",ref:e.reference,jobTotal:(0,o.Z)(e.customerVatTotal)||0,expensesAmountCustomer:(0,o.Z)(e.customerExpensesTotal)||0,priority:(null===(f=e.sla)||void 0===f?void 0:f.name)||"-",service:(null===(g=e.service)||void 0===g?void 0:g.name)||"-",description:e.description||"-",manager:$,location:(null===(b=e.location)||void 0===b?void 0:b.name)||"-",sublocation:(null===(h=e.sublocation)||void 0===h?void 0:h.name)||"-",scheduleDate:P,created:(0,i.Z)(e.createdAt),status:e.status}:{id:"".concat(a," ").concat(e.number," ").concat(s),type:e.type,invoiceNumber:(null===(x=e.invoices)||void 0===x?void 0:null===(y=x[0])||void 0===y?void 0:y.invoiceNumber)||"-",ref:e.reference,jobTotal:(0,o.Z)(e.customerVatTotal)||0,expensesAmountCustomer:(0,o.Z)(e.customerExpensesTotal)||0,supplierAmount:(0,o.Z)(e.supplierVatTotal)||0,expensesAmountSupplier:(0,o.Z)(e.supplierExpensesTotal)||0,revenue:(0,o.Z)(C)||0,priority:(null===(j=e.sla)||void 0===j?void 0:j.name)||"-",service:(null===(I=e.service)||void 0===I?void 0:I.name)||"-",description:e.description||"-",manager:$,location:(null===(_=e.location)||void 0===_?void 0:_.name)||"-",sublocation:(null===(w=e.sublocation)||void 0===w?void 0:w.name)||"-",supplier:(null===(Z=e.supplier)||void 0===Z?void 0:Z.name)||"-",scheduleDate:P,created:(0,i.Z)(e.createdAt),status:e.status}})}},76727:function(e,n,t){t.d(n,{r:function(){return o}});var i=t(29383),o=function(e){return(0,i.Z)(new Date(e),new Date)}},88424:function(e,n,t){t.d(n,{O:function(){return i}});var i=function(e){return e?new Date(e):new Date}},78295:function(e,n,t){t.d(n,{A:function(){return z}});var i,o=t(16835),r=t(59499),a=t(67294),c=t(30381),s=t.n(c),u=t(11163),d=t.n(u),l=t(57460),m=t.n(l),p=t(96486),v=t(26447),f=t(11057),g=t(98456),b=t(90629),h=t(15861),x=t(8602),y=t(75360),j=t(35137),I=t(32836),_=t(41749),w=t(26143),Z=t(825),$=t(6812),P=t(73359),C=t(71383),O=t(75063),S=function(e){var n=e.tagsWhere,t=void 0===n?"":n;return(0,O.Ps)(i||(i=(0,C.Z)(['\n  query GetFinancialJob(\n    $adminId: Int\n    $customerId: Int\n    $endDate: timestamptz\n    $startDate: timestamptz\n    $limit: Int\n    $status: [String]\n    $managerId: Int\n    $locationId: Int\n    $offset: Int\n    $supplierId: Int\n    $q: String\n    $orderBy: Job_order_by!\n    $sublocationId: Int\n    $userId: Int\n  ) {\n    jobs: Job(\n      limit: $limit\n      offset: $offset\n      where: {\n        type: { _in: ["reactive", "ppm"] }\n        _and: [\n          {\n            _or: [\n              { reference: { _ilike: $q } }\n              { title: { _ilike: $q } }\n              { number: { _ilike: $q } }\n              { number: { _ilike: $q } }\n              { Invoices: { invoiceNumber: { _ilike: $q } } }\n            ]\n          }\n          {\n            _or: [\n              { _and: [{ timingStart: { _gte: $startDate } }, { timingStart: { _lte: $endDate } }] }\n              { _and: [{ scheduledAt: { _gte: $startDate } }, { scheduledAt: { _lte: $endDate } }] }\n            ]\n          }\n        ]\n        status: { _in: $status }\n        customerId: { _eq: $customerId }\n        supplierId: { _eq: $supplierId }\n        managerId: { _eq: $managerId }\n        adminId: { _eq: $adminId }\n        locationId: { _eq: $locationId }\n        sublocationId: { _eq: $sublocationId }\n        _or: [{ customerUserId: { _eq: $userId } }, { supplierUserId: { _eq: $userId } }]\n        ','\n      }\n      order_by: [$orderBy]\n    ) {\n      id\n      type\n      number\n      status\n      description\n      reference\n      timingStart\n      scheduledAt\n      createdAt\n      customerTotal: customerFinances(path: "amountInfo.total")\n      supplierTotal: supplierFinances(path: "amountInfo.total")\n      customerVatTotal: customerFinances(path: "amountInfo.vatTotal")\n      supplierVatTotal: supplierFinances(path: "amountInfo.vatTotal")\n      customerExpensesTotal: customerFinances(path: "expensesInfo.expensesTotal")\n      supplierExpensesTotal: supplierFinances(path: "expensesInfo.expensesTotal")\n      customerRebateAmount: customerFinances(path: "rebate.amount")\n      slaId\n      tags: Taxonomy(\n        where: {\n          entity: { _eq: "Job" }\n          Taxonomy: { status: { _eq: "active" }, type: { _eq: "tags" } }\n        }\n      ) {\n        id\n        tag: Taxonomy {\n          id\n          name\n          meta\n          type\n        }\n      }\n      invoices: Invoices(order_by: { createdAt: desc }) {\n        invoiceNumber\n        outstandingAmounts: AccountEntry {\n          amount: outstandingAmount\n        }\n      }\n      customer: Customer {\n        id\n        name\n      }\n      supplier: Supplier {\n        id\n        name\n      }\n      location: Location {\n        id\n        name\n      }\n      sublocation: Sublocation {\n        id\n        name\n      }\n      sla: SLA {\n        name\n      }\n      manager: Manager {\n        fullName\n        nameLast\n        nameFirst\n        id\n      }\n      service: Service {\n        id\n        name\n      }\n    }\n    meta: Job_aggregate(\n      where: {\n        type: { _in: ["reactive", "ppm"] }\n        _and: [\n          {\n            _or: [\n              { reference: { _ilike: $q } }\n              { title: { _ilike: $q } }\n              { number: { _ilike: $q } }\n              { number: { _ilike: $q } }\n              { Invoices: { invoiceNumber: { _ilike: $q } } }\n            ]\n          }\n          {\n            _or: [\n              { _and: [{ timingStart: { _gte: $startDate } }, { timingStart: { _lte: $endDate } }] }\n              { _and: [{ scheduledAt: { _gte: $startDate } }, { scheduledAt: { _lte: $endDate } }] }\n            ]\n          }\n        ]\n        status: { _in: $status }\n        customerId: { _eq: $customerId }\n        supplierId: { _eq: $supplierId }\n        managerId: { _eq: $managerId }\n        adminId: { _eq: $adminId }\n        locationId: { _eq: $locationId }\n        sublocationId: { _eq: $sublocationId }\n        _or: [{ customerUserId: { _eq: $userId } }, { supplierUserId: { _eq: $userId } }]\n        ',"\n\n      }\n    ) {\n      aggregate {\n        totalCount: count\n      }\n    }\n  }\n"])),t,t)},N=t(48829),q=t(71847),D=t(23466),A=t(72936),T=t(55863),k=t(94568),E=t(42846),F=t(9164),J=t(24770),M=t(46353),W=t(85893);function R(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,i)}return t}function L(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?R(Object(t),!0).forEach(function(n){(0,r.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):R(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var z=function(e){var n,t,i=e.initialFilters,r=e.entityRelationToFetch,c=e.filtersVisibilityModel,l=e.columnVisibilityModel,C=(0,A.x)(),O=C.user,R=C.hasRole,z=(0,T.q)(),U=null===(n=z.admin.jobSetting)||void 0===n?void 0:n.jobNumberPrefix,B=null===(t=z.admin.jobSetting)||void 0===t?void 0:t.jobNumberSuffix,Y=(0,u.useRouter)().pathname,G=(0,a.useState)(!1),H=G[0],K=G[1],Q=(0,a.useState)(L({},i)),X=Q[0],ee=Q[1],en=(0,k.s)(),et=(0,E.x)({filters:X}),ei=et.initialData,eo=et.ref,er=(0,$.a)(S({tagsWhere:(0,M.Y)(ei.tags)}),{variables:L(L(L({},ei),r),{},{number:ei.id?String(ei.id):null,startDate:ei.startDate,endDate:ei.endDate,adminId:O.adminId})}),ea=er.data,ec=(ea=void 0===ea?{jobs:[],meta:{aggregate:{totalCount:0}}}:ea).jobs,es=ea.meta,eu=er.loading,ed=er.refetch,el=ei.customerId,em=ei.endDate,ep=ei.locationId,ev=ei.orderBy,ef=ei.startDate,eg=ei.status,eb=ei.supplierId,eh=(0,P.t)(S({tagsWhere:(0,M.Y)(ei.tags)}),{variables:{adminId:O.adminId,customerId:el,endDate:em,locationId:ep,orderBy:ev,startDate:ef,status:eg,supplierId:eb},onCompleted:function(e){var n,t=(0,D.c)(e.jobs,O.accountType,{numberPrefix:U,numberSuffix:B}),i=(null===(n=e.jobs[0])||void 0===n?void 0:n.id)||"New-report",o=m().unparse(t),r="data:application/octet-stream,"+encodeURIComponent(o);(0,N.S)(r,"".concat(i,"-work-orders.csv"))}}),ex=(0,o.Z)(eh,2),ey=ex[0],ej=ex[1].loading,eI=function(e){d().push("".concat("/dashboard/issues/","manage?id=").concat(e.number))},e_=function(e){d().push("/dashboard/issues/view?id=".concat(e.number))},ew=function(e){return s()(e).format("YYYY-MM-DD")},eZ=function(e){var n=[{context:"secondary",icon:"info",onClick:function(n){return e_(e)},tooltip:"Info"}];return R("admin")&&n.unshift({context:"secondary",icon:"edit",onClick:function(n){return eI(e)},tooltip:"Edit"}),n},e$=[{headerName:"Job ID",field:"jobId",sortable:!1,flex:1,minWidth:100,renderCell:function(e){var n=e.row;return(0,W.jsx)(Z.D,{id:n.id,number:n.number,openCanvas:!0,type:n.type,numberPrefix:U,numberSuffix:B})}},{headerName:"Invoice number",field:"invoiceNumber",sortable:!1,flex:1,minWidth:100},{headerName:"Reference",field:"ref",sortable:!1,flex:1,minWidth:100},{minWidth:300,field:"tags",headerName:"Tags",sortable:!1,renderCell:function(e){var n=e.row;return(0,W.jsx)(J.K,{row:n,refetchQueries:["GetFinancialJob"],entity:"Job"})}},{headerName:"Service",field:"service",sortName:'{"Service": {"name": "ORDER"}}',flex:1,minWidth:100},{headerName:"Priority",field:"priority",sortName:'{"SLA": {"name": "ORDER"}}',flex:1,minWidth:100},{headerName:"Customer",field:"customer",minWidth:200,flex:1,renderCell:function(e){var n,t,i=e.row;return(0,W.jsx)(F.r,{color:"secondary",href:"/dashboard/customers/view?id=".concat(null===(n=i.customer)||void 0===n?void 0:n.id),noWrap:!i.customer,children:(null===(t=i.customer)||void 0===t?void 0:t.name)||"-"})}},{headerName:"Location",field:"location",minWidth:300,flex:1,renderCell:function(e){var n,t,i=e.row;return(0,W.jsx)(F.r,{color:"secondary",href:"/dashboard/properties/view?id=".concat(null===(n=i.location)||void 0===n?void 0:n.id),noWrap:!i.location||R(["supplier","tenant"]),children:(null===(t=i.location)||void 0===t?void 0:t.name)||"-"})}},{headerName:"Customer (NET)",field:"customerNet",minWidth:150,sortable:!1,flex:1,valueFormatter:function(e){var n,t=e.value;return"\xa3".concat((n=+t).toFixed(2))}},{headerName:"Amount Outstanding",field:"amountOutstanding",sortable:!1,minWidth:150,flex:1,valueFormatter:function(e){var n,t=e.value;return"\xa3".concat((n=+t).toFixed(2))}},{headerName:"Supplier (NET)",field:"supplierNet",minWidth:150,sortable:!1,flex:1,valueFormatter:function(e){var n,t=e.value;return"\xa3".concat((n=+t).toFixed(2))}},{headerName:R("admin")?"Net Revenue":"Revenue",field:"revenue",minWidth:150,sortable:!1,flex:1,valueFormatter:function(e){var n,t=e.value;return"\xa3".concat((n=+t).toFixed(2))}},{headerName:"Scheduled",field:"scheduleDate",minWidth:130,flex:1},{headerName:"Created",field:"date",flex:1,minWidth:100},{headerName:"Supplier",field:"supplier",sortName:'{"Supplier": {"name": "ORDER"}}',flex:1,minWidth:140,renderCell:function(e){var n,t,i=e.row;return(0,W.jsx)(F.r,{color:"secondary",noWrap:!R("admin")||!i.supplier,href:"/dashboard/suppliers/view?id=".concat(null===(n=i.supplier)||void 0===n?void 0:n.id),children:(null===(t=i.supplier)||void 0===t?void 0:t.name)||""})}},{headerName:"Status",field:"status",flex:1,minWidth:100,renderCell:function(e){var n=e.row;return(0,W.jsx)(_.B,{value:n.status})}},{headerName:"Actions",field:"actions",sortable:!1,minWidth:130,flex:1,renderCell:function(e){var n=e.row;return(0,W.jsx)(w.C,{actionsData:eZ,row:n})}}],eP=(0,a.useMemo)(function(){return null==ec?void 0:ec.map(function(e){var n,t,i,o,r,a=e.scheduledAt?ew(e.scheduledAt,!0):e.timingStart?ew(e.timingStart,!0):"-",c=e.customerRebateAmount>0?e.customerVatTotal-e.customerRebateAmount-e.supplierTotal:e.customerTotal-e.supplierTotal;return{id:e.id,jobId:"J ".concat(e.number," "),type:e.type,number:e.number,invoiceNumber:(null===(n=e.invoices)||void 0===n?void 0:null===(t=n[0])||void 0===t?void 0:t.invoiceNumber)||"-",amountOutstanding:null==e?void 0:null===(i=e.invoices)||void 0===i?void 0:i.reduce(function(e,n){var t;return e+((null==n?void 0:null===(t=n.outstandingAmounts)||void 0===t?void 0:t.amount)||0)},0),ref:e.reference||"-",description:e.description||"-",service:(null===(o=e.service)||void 0===o?void 0:o.name)||"-",priority:(null===(r=e.sla)||void 0===r?void 0:r.name)||"-",location:e.location,customerNet:null==e?void 0:e.customerTotal,supplierNet:null==e?void 0:e.supplierTotal,supplier:null==e?void 0:e.supplier,tags:e.tags,revenue:c||0,scheduleDate:a,customer:null==e?void 0:e.customer,date:ew(e.createdAt),status:e.status}})},[ec]),eC=(0,a.useCallback)(function(e){e.stopPropagation();var n=(0,q.Uu)(X);d().push("/dashboard/issues/manage".concat(n))},[X]),eO=(0,a.useMemo)(function(){var e={};return eP.length||p.isEqual(X,i)?{title:"No work orders",subtitleFirstLine:"You currently have no work orders set up in the system",subtitleSecondLine:"Click create work orders to get started building.",buttonText:"Create work orders",onAction:eC}:{title:"No results",subtitleFirstLine:"The filters you have applied have returned no results",subtitleSecondLine:"Please amend and try again if necessary."}},[X,eC,i,eP]),eS=L({ref:R(["admin","customer"]),service:R(["admin","customer"]),customerNet:R(["admin","customer"]),amountOutstanding:R(["admin","customer"]),supplierNet:R(["admin","supplier"]),revenue:R("admin"),supplier:R("admin"),tags:R("admin"),customer:Y.includes("suppliers")&&R("admin")},l);return(0,W.jsxs)(W.Fragment,{children:[H&&(0,W.jsx)(y.h,{initialFilters:i,open:H,setFilters:ee,setOpen:K,filtersVisibilityModel:c}),(0,W.jsxs)(v.Z,{spacing:2,sx:V.header,children:[(0,W.jsxs)(v.Z,{width:"100%",direction:"row",justifyContent:"space-between",children:[(0,W.jsx)(f.Z,{variant:"contained",startIcon:(0,W.jsx)(x.Z,{}),onClick:function(){return K(!0)},children:"Filters"}),(0,W.jsxs)(v.Z,{direction:"row",spacing:2,children:[!R(["supplier","tenant"])&&(0,W.jsx)(f.Z,{variant:"contained",color:"secondary",onClick:eC,children:"Create Work Order"}),!en&&(0,W.jsx)(f.Z,{startIcon:!ej&&(0,W.jsx)("img",{src:"/static/icons/csv.svg"}),disabled:ej,variant:"contained",color:"success",onClick:function(e){e.stopPropagation(),ey()},children:ej?(0,W.jsx)(g.Z,{size:20,color:"secondary"}):"Export"})]})]}),(0,W.jsxs)(b.Z,{sx:V.tableContainer,children:[(0,W.jsx)(h.Z,{ml:2,variant:"h5",sx:V.title,children:"Work Orders"}),null!=eP&&eP.length?(0,W.jsx)(I.i,{ref:eo,loading:eu,columns:e$,rows:eP,columnVisibilityModel:eS,meta:es,refetch:ed,autoHeight:!1,onRowClick:e_,containerHeight:"calc(100% - 52px)"}):!eu&&(0,W.jsx)(j.C,L({imageSrc:"/static/icons/no_locations_found.svg"},eO))]})]})]})},V={header:{width:"100%",height:"100%"},tableContainer:{padding:"16px 0px",height:"calc(80vh - 22px)"},title:{fontWeight:600,marginBottom:"15px"}};z.defaultProps={filters:{assetId:null,managerId:null},columnVisibilityModel:{}}},6788:function(e,n,t){t.d(n,{Bo:function(){return p},CV:function(){return d},FT:function(){return g},JB:function(){return m},iU:function(){return l},kW:function(){return v}});var i=t(10367),o=t(11587),r=t(51466),a=t(26186),c=t(76727),s=t(88424),u=t(85893),d=function(e){var n=(0,s.O)();return parseInt(e.filter(function(e){return(0,s.O)(e.expiryAt)>=n}).length/e.length*100)},l=function(e){if(!e||0===e.length)return null;var n=(0,s.O)();return parseInt(e.filter(function(e){return(0,s.O)(e.expiryAt)>=n}).length/e.length*100)||null};(0,i.ZP)(o.Z).withConfig({displayName:"helper__StyledBadge",componentId:"sc-1rrgcna-0"})(["margin:0;"]),i.ZP.div.withConfig({displayName:"helper__Wrapper",componentId:"sc-1rrgcna-1"})(["align-items:center;display:flex;"]),i.ZP.div.withConfig({displayName:"helper__Next",componentId:"sc-1rrgcna-2"})(["flex-direction:column;margin-left:1rem;"]);var m=function(e){return e.filter(function(e){return 0>(0,c.r)(e.expiryAt)}).length},p=function(e){if(!e||0===e.length||!e.nodes||e.nodes&&(null===(n=e.nodes)||void 0===n?void 0:n.length)===0)return{content:"No locations",context:"secondary"};var n,t=[];(e.nodes||e).forEach(function(e){var n,i;(null!==(n=e.location)&&void 0!==n&&n.compliance||e.compliances)&&t.push(d((null===(i=e.location)||void 0===i?void 0:i.compliance)||e.compliances))});var i=Math.round(t.reduce(function(e,n){return isNaN(n)&&(n=0),e+n},0)/t.length);return{content:"Score: ".concat(i||0," %"),context:v(i)}},v=function(e){return e>79?"success":e>49?"info":"danger"},f=function(e){var n=(0,c.r)(e);return n>14?"success":n>=0?"info":"danger"},g=function(e){var n=e.row;if(n.expiryAt)return(0,u.jsx)(r.Z,{content:(0,a.Z)(n.expiryAt),context:f(n.expiryAt),size:"sm"})}},32158:function(e,n,t){t.d(n,{u:function(){return O}});var i=t(59499),o=t(27812),r=t(50029),a=t(16835),c=t(64687),s=t.n(c),u=t(50319),d=t(6812),l=t(72628),m=t(26186),p=t(11082),v=t(15214),f=t(58965),g=t(86036),b=t(55843),h=t(16540),x=t(825),y=t(92264),j=t(72936),I=t(69532),_=t(58681),w=t(92034),Z=t(38512),$=t(85893);function P(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,i)}return t}function C(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?P(Object(t),!0).forEach(function(n){(0,i.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):P(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var O=function(e){var n,t=e.type,i=e.accountEntryType,c=e.data,P=(e.refetch,e.toggleShow),O=e.numberPrefix,S=e.numberSuffix,N=(0,j.x)().hasRole,q=(0,u.D)(l.zn,{refetchQueries:function(){return["GetAccountEntries"]}}),D=(0,a.Z)(q,1)[0],A=(0,u.D)(Z.qD),T=(0,a.Z)(A,1)[0],k=(0,d.a)(l.to,{variables:{accountEntryId:c.id,skip:"paymentReceipt"!==i&&"creditNote"!==i}}).data,E=(k=void 0===k?{reconciliations:[]}:k).reconciliations,F=(0,d.a)(l.yz,{variables:{accountEntryId:c.id,skip:"ppmInvoice"!==i}}).data,J=(F=void 0===F?{invoices:[]}:F).invoices,M=(n=(0,r.Z)(s().mark(function e(){var n;return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=E.reduce(function(e,n){var i,r;return[].concat((0,o.Z)(e),(0,o.Z)(null==n?void 0:null===(i=n.accountEntryInvoice)||void 0===i?void 0:null===(r=i.invoices)||void 0===r?void 0:r.map(function(e){var n;return C(C({},e.job),{},{status:null===(n=(0,w.e)(e.job,["".concat(t,"Paid")]))||void 0===n?void 0:n.status})})))},[]),e.next=3,Promise.all(n.map(function(){var e=(0,r.Z)(s().mark(function e(n){return s().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T({variables:{id:n.id,changes:{status:n.status}}});case 2:case"end":return e.stop()}},e)}));return function(n){return e.apply(this,arguments)}}()));case 3:return e.next=5,D({variables:{jobIds:n.map(function(e){return e.id}),timingStatuses:"".concat(t,"Paid"),paymentId:c.id}});case 5:P();case 6:case"end":return e.stop()}},e)})),function(){return n.apply(this,arguments)});return(0,$.jsxs)($.Fragment,{children:[(0,$.jsxs)(f.Z,{open:!0,title:"Details",children:[(0,$.jsx)(g.Z,{content:"Date",text:c.date}),(0,$.jsx)(g.Z,{content:"Type",text:c.itemType}),c.reference&&(0,$.jsx)(g.Z,{content:"Reference",text:c.reference}),c.comment&&(0,$.jsx)(g.Z,{content:"Comment",text:c.comment}),(0,$.jsx)(g.Z,{content:"Debit",text:(0,p.Z)(c.debit)}),(0,$.jsx)(g.Z,{content:"Credit",text:(0,p.Z)(c.credit)})]}),["paymentReceipt","creditNote"].includes(i)&&(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(b.Z,{}),(0,$.jsx)(f.Z,{open:!0,title:"Related Invoices",children:(0,$.jsx)(h.Z,{columns:[{hidden:!0},{text:"Number",formatter:function(e){var n=e.row;return _.YK.includes(n.invoiceType)?"PM ".concat(n.invoiceNumber):(0,$.jsx)(x.D,{id:n.id,number:n.number,invoiceNumber:n.invoiceNumber,numberPrefix:O,numberSuffix:S,openCanvas:!0,type:n.jobType})}},{hidden:!0},{hidden:!0},{text:"Date"},{text:"Reconciled Amount"},{hidden:!0}],rows:E.map(function(e){var n,t,i,o,r,a=null===(n=e.accountEntryInvoice)||void 0===n?void 0:null===(t=n.invoices)||void 0===t?void 0:t[0];return _.YK.includes(null==a?void 0:a.invoiceType)?{id:null,number:null,invoiceNumber:null==a?void 0:a.invoiceNumber,invoiceType:null==a?void 0:a.invoiceType,date:(0,m.Z)(e.createdAt),reconciledAmount:(0,p.Z)(e.amount),jobType:"ppm"}:{id:null==a?void 0:null===(i=a.job)||void 0===i?void 0:i.id,number:null==a?void 0:null===(o=a.job)||void 0===o?void 0:o.number,invoiceNumber:null==a?void 0:a.invoiceNumber,invoiceType:null==a?void 0:a.invoiceType,date:(0,m.Z)(e.createdAt),reconciledAmount:(0,p.Z)(e.amount),jobType:null==a?void 0:null===(r=a.job)||void 0===r?void 0:r.type}})})}),N(["admin","superadmin"])?(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(y.H,{content:"Delete",context:"danger",handleClick:M}),E.length>0&&(0,$.jsx)(v.Z,{content:"Deleting this receipt will potentially remove other reconciled entries.",context:"info"})]}):null]}),["ppmInvoice"].includes(i)&&(0,$.jsxs)($.Fragment,{children:[(0,$.jsx)(b.Z,{}),(0,$.jsx)(f.Z,{open:!0,title:"Related Jobs",children:(0,$.jsx)(h.Z,{columns:[{hidden:!0},{text:"Number",formatter:function(e){var n=e.row;return(0,$.jsx)(x.D,{id:n.id,number:n.number,invoiceNumber:n.invoiceNumber,numberPrefix:O,numberSuffix:S,openCanvas:!0,type:n.jobType,toggleShow:function(){P&&P()}})}},{text:"Status",formatter:function(e){var n=e.row;return n.status?(0,$.jsx)(I.B,{value:n.status}):""}},{hidden:!0},{hidden:!0}],rows:J.map(function(e){var n,t,i,o;return{id:null==e?void 0:null===(n=e.Job)||void 0===n?void 0:n.id,number:null==e?void 0:null===(t=e.Job)||void 0===t?void 0:t.number,status:null==e?void 0:null===(i=e.Job)||void 0===i?void 0:i.status,invoiceNumber:null==e?void 0:e.invoiceNumber,jobType:null==e?void 0:null===(o=e.Job)||void 0===o?void 0:o.type}})})})]})]})};O.defaultProps={numberPrefix:"",numberSuffix:""}},35137:function(e,n,t){t.d(n,{C:function(){return p}});var i=t(59499);t(67294);var o=t(90948),r=t(61730),a=t(26447),c=t(15861),s=t(11057),u=t(85893);function d(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,i)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?d(Object(t),!0).forEach(function(n){(0,i.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):d(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var m=(0,o.ZP)("img")({width:"300px",height:"250px"}),p=function(e){var n=e.imageSrc,t=e.sx,i=e.imageSx,o=e.title,d=e.titleSx,p=e.subtitleFirstLine,v=e.subtitleFirstLineSx,f=e.subtitleSecondLine,g=e.subtitleSecondLineSx,b=e.buttonText,h=e.onAction,x=(0,r.Z)("(max-width: 400px)");return(0,u.jsxs)(a.Z,{sx:l(l({},t),{},{width:"100%",height:"100%"}),justifyContent:"center",alignItems:"center",spacing:2,color:"#757575",children:[(0,u.jsx)(m,{src:n,sx:l(l({},i),{},{width:x?"250px":"300px"})}),(0,u.jsx)(c.Z,{typography:"h5",sx:l({},d),children:o}),(0,u.jsxs)(a.Z,{alignItems:"center",sx:{padding:"0px 10px",textAlign:"center"},children:[(0,u.jsx)(c.Z,{sx:l({},v),children:p}),(0,u.jsx)(c.Z,{sx:l({},g),children:f})]}),b&&h&&(0,u.jsx)(s.Z,{variant:"contained",color:"secondary",onClick:h,children:b})]})};p.defaultProps={title:"",subtitleFirstLine:"",subtitleSecondLine:"",sx:{},imageSx:{},titleSx:{},subtitleFirstLineSx:{},subtitleSecondLineSx:{},onAction:null}},55206:function(e,n,t){t.d(n,{E:function(){return V}});var i,o,r,a=t(59499),c=t(50029),s=t(16835),u=t(64687),d=t.n(u),l=t(67294),m=t(6812),p=t(50319),v=t(71383),f=t(75063),g=(0,f.Ps)(i||(i=(0,v.Z)(["\n  query GetNote($entityId: Int!) {\n    note: Note(where: { entityId: { _eq: $entityId } }, order_by: { createdAt: desc }) {\n      accountId\n      comments\n      createdAt\n      id\n      userId\n      user: User {\n        nameFirst\n        nameLast\n      }\n    }\n  }\n"]))),b=(0,f.Ps)(o||(o=(0,v.Z)(["\n  mutation AddNote(\n    $accountId: Int\n    $comments: String\n    $entity: String\n    $entityId: Int\n    $userId: Int\n  ) {\n    insert_Note(\n      objects: {\n        accountId: $accountId\n        comments: $comments\n        entity: $entity\n        entityId: $entityId\n        userId: $userId\n      }\n    ) {\n      returning {\n        id\n        comments\n      }\n    }\n  }\n"]))),h=(0,f.Ps)(r||(r=(0,v.Z)(["\n  mutation UpdateNote($id: Int!, $change: Note_set_input) {\n    update_Note_by_pk(pk_columns: { id: $id }, _set: $change) {\n      id\n      comments\n    }\n  }\n"]))),x=t(78289),y=t(16551),j=t(77439),I=t(58965),_=t(86036),w=t(42283),Z=t(79665),$=t(76600),P=t(9270),C=t(62140),O=t(49501),S=t(6710),N=t(55563),q=t(74231),D=(0,q.Ry)().shape({comments:(0,q.Z_)().required()}),A=t(85893);function T(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,i)}return t}function k(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?T(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):T(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var E=function(e){var n=e.defaultValues,t=e.onSubmit,i=(0,w.cI)({defaultValues:k({},n),resolver:(0,Z.S)(D)}),o=i.control,r=i.errors,a=i.handleSubmit,c={control:o,errors:r,register:i.register};return(0,A.jsxs)($.Z,{id:"offCanvasForm",handleSubmit:a(t),children:[(0,A.jsx)(P.Z,{children:(0,A.jsx)(C.Z,{md:12,children:(0,A.jsx)(O.Z,{label:"Title",children:(0,A.jsx)(S.Z,k(k({},c),{},{name:"comments",rows:4}))})})}),n.id&&(0,A.jsx)(N.Z,k(k({},c),{},{name:"id",type:"hidden"}))]})},F=t(68956),J=t(26186),M=t(55843),W=t(16540),R=function(e){var n=e.note,t=e.loading,i=e.handleClick,o=e.userId,r=[{hidden:!0},{hidden:!0},{text:"Title"},{text:"By"},{text:"Created"},{formatter:F.Z,formatterData:function(e){return[{context:"secondary",disabled:o!==e.userId,icon:["fas","edit"],onClick:function(e,n){return i(e,n)},tooltip:"Edit"}]},text:"Actions"}];return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(M.Z,{marginBottom:"xs"}),(0,A.jsx)(W.Z,{columns:r,loading:t,rows:n.map(function(e){var n,t;return{id:e.id,userId:e.userId,comments:e.comments,user:"".concat(null===(n=e.user)||void 0===n?void 0:n.nameFirst," ").concat(null===(t=e.user)||void 0===t?void 0:t.nameLast),date:(0,J.Z)(e.createdAt),actions:""}})})]})};R.defaultProps={note:[]};var L=t(72936);function z(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,i)}return t}var V=function(e){var n,t=e.entity,i=e.entityId,o=(e.open,e.title),r=e.single,u=(0,l.useContext)(x.Z),v=(0,L.x)().user,f=(0,m.a)(g,{variables:{entity:t,entityId:i}}),w=f.loading,Z=f.data,$=(Z=void 0===Z?{note:[]}:Z).note,P=f.refetch,C=(0,p.D)(b,{onCompleted:function(){u.close(),P()}}),O=(0,s.Z)(C,1)[0],S=(0,p.D)(h,{onCompleted:function(){u.close(),P()}}),N=(0,s.Z)(S,1)[0],q=(n=(0,c.Z)(d().mark(function e(n){return d().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.id){e.next=5;break}return e.next=3,N({variables:{id:n.id,change:n}});case 3:e.next=11;break;case 5:return n.accountId=v.accountId,n.entity=t,n.entityId=i,n.userId=v.id,e.next=11,O({variables:n});case 11:case"end":return e.stop()}},e)})),function(e){return n.apply(this,arguments)}),D=function(e,n){e.preventDefault(),e.stopPropagation();var t=function(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?z(Object(t),!0).forEach(function(n){(0,a.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):z(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}({},n);u.show({content:(0,A.jsx)(E,{defaultValues:t,onCancel:T,onSubmit:q}),title:n?"Edit note":"Add note"})},T=function(){u.close()},k=function(){return(0,A.jsx)(y.Z,{children:r&&$.length?(0,A.jsx)(j.Z,{context:"secondary",content:"Edit",onClick:function(e){return D(e,$[0])},size:"sm"}):(0,A.jsx)(j.Z,{context:"secondary",content:"Add new",onClick:D,size:"sm"})})};return(0,A.jsxs)(I.Z,{fitParentHeight:!0,title:o,toolbar:(0,A.jsx)(k,{}),children:[r&&$.length>0&&(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(_.Z,{text:$[0].comments}),(0,A.jsx)(_.Z,{content:"By",text:"".concat($[0].user.nameFirst," ").concat($[0].user.nameLast)})]}),!r&&(0,A.jsx)(R,{entity:t,entityId:i,note:$,loading:w,refetch:P,handleClick:D,userId:v.id})]})};V.defaultProps={open:!0,single:!1,title:"Note"}},26380:function(e,n,t){t.d(n,{bg:function(){return i}});var i=[{text:"Status",value:""},{text:"Active",value:"active"},{text:"Inactive",value:"inactive"}]}}]);